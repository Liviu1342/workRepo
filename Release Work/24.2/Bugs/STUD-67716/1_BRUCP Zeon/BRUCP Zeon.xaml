<Activity mc:Ignorable="sap sap2010" x:Class="BRUCP_Zeon" this:BRUCP_Zeon.BTest="True" this:BRUCP_Zeon.DaOpDate="[Now]" this:BRUCP_Zeon.StrTestAddress="ldpti@dg.mitsui.com" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:l="clr-namespace:LDPTI_General;assembly=LDPTI_General" xmlns:l1="clr-namespace:LDPTI_O365;assembly=LDPTI_O365" xmlns:l2="clr-namespace:LDPTI_Excel;assembly=LDPTI_Excel" xmlns:lf="clr-namespace:LDPTI_General.Files_Folders;assembly=LDPTI_General" xmlns:lm="clr-namespace:LDPTI_General.Mail;assembly=LDPTI_General" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:sc="clr-namespace:System.ComponentModel;assembly=System" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:str="clr-namespace:System.Text.RegularExpressions;assembly=System" xmlns:this="clr-namespace:" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="BTest" Type="InArgument(x:Boolean)" />
    <x:Property Name="DaOpDate" Type="InArgument(s:DateTime)" />
    <x:Property Name="StrTestAddress" Type="InArgument(x:String)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1526.8,25298.4</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>Top_Level_Template_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="110">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>LDPTI_General</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Microsoft.Office.Interop.Outlook</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>UiPath.UIAutomationCore.Contracts</x:String>
      <x:String>UiPath.DataTableUtilities</x:String>
      <x:String>UiPath.Core.Activities.Orchestrator</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>System.Dynamic</x:String>
      <x:String>System.Collections.Specialized</x:String>
      <x:String>UiPath.Web.Activities</x:String>
      <x:String>LDPTI_O365</x:String>
      <x:String>Microsoft.Graph</x:String>
      <x:String>UiPath.PDF.Activities</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Security</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>LDPTI_Excel</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Files</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities</x:String>
      <x:String>UiPath.MicrosoftOffice365.Models</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Mail</x:String>
      <x:String>System.Globalization</x:String>
      <x:String>UiPath.MicrosoftOffice365.Enums</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
      <x:String>LDPTI_General.Files_Folders</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Files.Contracts</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Files.Enums</x:String>
      <x:String>UiPath.Shared.Activities.ConnectionService.Contracts</x:String>
      <x:String>UiPath.Shared.Activities.Business</x:String>
      <x:String>LDPTI_General.Mail</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>UiPath.Mail.Activities.Utils</x:String>
      <x:String>UiPath.Mail.Activities.Business.HtmlEditor</x:String>
      <x:String>UiPath.Mail.Activities.Business</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="102">
      <AssemblyReference>LDPTI_Excel</AssemblyReference>
      <AssemblyReference>LDPTI_General</AssemblyReference>
      <AssemblyReference>LDPTI_O365</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>Microsoft.Graph</AssemblyReference>
      <AssemblyReference>Microsoft.Office.Interop.Outlook</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>NPOI</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Configuration.Install</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Diagnostics.DiagnosticSource</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Linq</AssemblyReference>
      <AssemblyReference>System.Linq.Async</AssemblyReference>
      <AssemblyReference>System.Linq.Async.Queryable</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Memory.Data</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365.Activities</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Contracts</AssemblyReference>
      <AssemblyReference>UiPath.PDF.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.Vision.Core</AssemblyReference>
      <AssemblyReference>UiPath.Web.Activities</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities.Design</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldExpandAll">False</x:Boolean>
      <x:Boolean x:Key="ShouldCollapseAll">False</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <TryCatch DisplayName="Try catch - Top Level" sap:VirtualizedContainerService.HintSize="1536.8,25233.2" sap2010:WorkflowViewState.IdRef="TryCatch_1">
    <TryCatch.Variables>
      <Variable x:TypeArguments="x:String" Name="strFailureReason" />
      <Variable x:TypeArguments="x:String" Name="strComponentRunning" />
      <Variable x:TypeArguments="s:String[]" Name="processesToKill" />
      <Variable x:TypeArguments="x:String" Name="strProcessName" />
      <Variable x:TypeArguments="x:String" Name="strDesktopFolder" />
      <Variable x:TypeArguments="x:String" Name="strProcessedFileName" />
      <Variable x:TypeArguments="x:String" Name="strErrorFolder" />
      <Variable x:TypeArguments="x:String" Name="strNewFolder" />
      <Variable x:TypeArguments="x:String" Name="strOrchFolder" />
    </TryCatch.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsPinned">False</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <TryCatch.Try>
      <Sequence DisplayName="BRUCP Zeon - Top Level" sap:VirtualizedContainerService.HintSize="1499.2,24976.4" sap2010:WorkflowViewState.IdRef="Sequence_30">
        <Sequence.Variables>
          <Variable x:TypeArguments="scg:ICollection(x:String)" Default="[New List(Of String)]" Name="colBRUCPErrors" />
          <Variable x:TypeArguments="scg:ICollection(sd:DataTable)" Default="[New List(Of DataTable)]" Name="colTables" />
          <Variable x:TypeArguments="x:String" Name="strMasterDataFile" />
          <Variable x:TypeArguments="s:String[]" Name="arrWorkingFiles" />
          <Variable x:TypeArguments="x:Int32" Name="intCount" />
          <Variable x:TypeArguments="x:Boolean" Name="bRunning" />
          <Variable x:TypeArguments="x:Boolean" Name="bComplete" />
          <Variable x:TypeArguments="x:String" Name="strSPOSiteURL" />
          <Variable x:TypeArguments="x:String" Name="strDocLib" />
          <Variable x:TypeArguments="x:String" Name="strSPOFolder" />
          <Variable x:TypeArguments="x:String" Name="strSubFolder" />
          <Variable x:TypeArguments="scg:ICollection(x:String)" Default="[New List(Of String)]" Name="colQueueErrors" />
          <Variable x:TypeArguments="x:String" Name="strQueueDU" />
          <Variable x:TypeArguments="x:String" Name="strQueuePODetails" />
          <Variable x:TypeArguments="x:String" Name="strPendingFolder" />
          <Variable x:TypeArguments="x:String" Name="strCustomerList" />
          <Variable x:TypeArguments="sd:DataTable" Name="dtCustomers" />
          <Variable x:TypeArguments="scg:ICollection(x:String)" Default="[New List(Of String)]" Name="colNewCustomers" />
          <Variable x:TypeArguments="scg:ICollection(x:String)" Default="[New List(Of string)]" Name="colColumnErrors" />
          <Variable x:TypeArguments="x:String" Name="strClassificationFolder" />
          <Variable x:TypeArguments="x:String" Name="strInvestigationFolder" />
          <Variable x:TypeArguments="sd:DataTable" Name="dtShipping" />
          <Variable x:TypeArguments="sd:DataTable" Name="dtPurchaseWF" />
          <Variable x:TypeArguments="sd:DataTable" Name="dtPaymentWF" />
          <Variable x:TypeArguments="sd:DataTable" Name="dtInvoice" />
          <Variable x:TypeArguments="sd:DataTable" Name="dtIDI" />
          <Variable x:TypeArguments="s:String[]" Name="strTestAvbakjfsd" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Sequence DisplayName="Assign Variables &amp; Create Directories" sap:VirtualizedContainerService.HintSize="1437.2,83.6" sap2010:WorkflowViewState.IdRef="Sequence_29">
          <Sequence.Variables>
            <Variable x:TypeArguments="x:String" Name="strWFOne" />
            <Variable x:TypeArguments="x:String" Name="strWFTwo" />
            <Variable x:TypeArguments="x:String" Name="strWFThree" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Assign sap:VirtualizedContainerService.HintSize="1030.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_49">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">
                <mva:VisualBasicReference x:TypeArguments="x:String" ExpressionText="strComponentRunning" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_1" />
              </OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">Assign Variables &amp; Create Directories</InArgument>
            </Assign.Value>
          </Assign>
          <ui:LogMessage DisplayName="Log Message - Started" sap:VirtualizedContainerService.HintSize="1030.8,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_35" Message="[strComponentRunning + &quot; Started.&quot;]">
            <ui:LogMessage.Level>
              <InArgument x:TypeArguments="ui:LogLevel">
                <Literal x:TypeArguments="ui:LogLevel" sap2010:WorkflowViewState.IdRef="Literal`1_1" Value="Info" />
              </InArgument>
            </ui:LogMessage.Level>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:LogMessage>
          <ui:LogMessage DisplayName="Log Message - LOGONSERVER" sap:VirtualizedContainerService.HintSize="1030.8,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_221" Level="Info" Message="[&quot;LOGONSERVER: &quot; + Environ(&quot;LOGONSERVER&quot;)]" />
          <Assign DisplayName="Assign Process Name" sap:VirtualizedContainerService.HintSize="1030.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_50">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">
                <mva:VisualBasicReference x:TypeArguments="x:String" ExpressionText="strProcessName" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_2" />
              </OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">BRUCP Zeon</InArgument>
            </Assign.Value>
          </Assign>
          <Assign DisplayName="Assign Processes to Kill" sap:VirtualizedContainerService.HintSize="991,60" sap2010:WorkflowViewState.IdRef="Assign_51">
            <Assign.To>
              <OutArgument x:TypeArguments="s:String[]">
                <mva:VisualBasicReference x:TypeArguments="s:String[]" ExpressionText="processesToKill" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_3" />
              </OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="s:String[]">[{"EXCEL","werfault"}]</InArgument>
            </Assign.Value>
          </Assign>
          <l:Kill_Processes DisplayName="Kill Processes" sap:VirtualizedContainerService.HintSize="991,51" sap2010:WorkflowViewState.IdRef="Kill_Processes_5">
            <l:Kill_Processes.ProcessesToKill>
              <InArgument x:TypeArguments="s:String[]">
                <mva:VisualBasicValue x:TypeArguments="s:String[]" ExpressionText="processesToKill" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
              </InArgument>
            </l:Kill_Processes.ProcessesToKill>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </l:Kill_Processes>
          <Assign DisplayName="Assign Orch Folder" sap:VirtualizedContainerService.HintSize="991,60" sap2010:WorkflowViewState.IdRef="Assign_504">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[strOrchFolder]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">["Shared/Zeon"]</InArgument>
            </Assign.Value>
          </Assign>
          <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="RPA_Downloads_Folder" CacheStrategy="None" DisplayName="Get Asset - RPA Downloads" FolderPath="[strOrchFolder]" sap:VirtualizedContainerService.HintSize="991,51" sap2010:WorkflowViewState.IdRef="GetRobotAsset_4">
            <ui:GetRobotAsset.Value>
              <OutArgument x:TypeArguments="x:String">[strErrorFolder]</OutArgument>
            </ui:GetRobotAsset.Value>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:GetRobotAsset>
          <Assign DisplayName="Assign Desktop Folder" sap:VirtualizedContainerService.HintSize="991,60" sap2010:WorkflowViewState.IdRef="Assign_55">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">
                <mva:VisualBasicReference x:TypeArguments="x:String" ExpressionText="strDesktopFolder" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_4" />
              </OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">["C:\Users\" + Environment.UserName + "\Desktop\" + strProcessName.Replace(" ","_")]</InArgument>
            </Assign.Value>
          </Assign>
          <Assign DisplayName="Assign New_Files Folder" sap:VirtualizedContainerService.HintSize="991,60" sap2010:WorkflowViewState.IdRef="Assign_111">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[strNewFolder]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\New_Files"]</InArgument>
            </Assign.Value>
          </Assign>
          <If DisplayName="If Test" sap:VirtualizedContainerService.HintSize="1030.8,765.2" sap2010:WorkflowViewState.IdRef="If_97">
            <If.Condition>
              <InArgument x:TypeArguments="x:Boolean">
                <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="BTest" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
              </InArgument>
            </If.Condition>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <If.Then>
              <Sequence DisplayName="Assign Test Variables" sap:VirtualizedContainerService.HintSize="493.2,603.6" sap2010:WorkflowViewState.IdRef="Sequence_539">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="Multiple Assign - Test Locations" sap:VirtualizedContainerService.HintSize="431,224" sap2010:WorkflowViewState.IdRef="MultipleAssign_89">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_390">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strDocLib]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">RPA Testing</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_391">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strSPOSiteURL]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">https://mitsui365.sharepoint.com/sites/LDPTI</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AssignOperation_392">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strSPOFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">BRUCP Zeon Test</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_393">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strSubFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">
                            <Literal x:TypeArguments="x:String" Value="" />
                          </InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AssignOperation_394">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strErrorFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[strErrorFolder + "\Test\" + strProcessName.Replace(" ", "_")]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                </ui:MultipleAssign>
                <ui:MultipleAssign DisplayName="Multiple Assign - Test Queues" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_47">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_241">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strQueueDU]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">Test_BRUCP_Zeon_Filenames</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_242">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strQueuePODetails]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">Test_BRUCP_Zeon_PO_Details</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                </ui:MultipleAssign>
                <Assign DisplayName="Assign Pending Folder Test" sap:VirtualizedContainerService.HintSize="431,60" sap2010:WorkflowViewState.IdRef="Assign_492">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[strPendingFolder]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">["\\AWEPVA10\Projects$\CoE\BRUCP Zeon\Test"]</InArgument>
                  </Assign.Value>
                </Assign>
              </Sequence>
            </If.Then>
            <If.Else>
              <Sequence DisplayName="Assign Live Variables" sap:VirtualizedContainerService.HintSize="493.2,603.6" sap2010:WorkflowViewState.IdRef="Sequence_540">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="Multiple Assign - Live Locations" sap:VirtualizedContainerService.HintSize="431,224" sap2010:WorkflowViewState.IdRef="MultipleAssign_15">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_92">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strDocLib]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">PMBU VSBU</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_93">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strSPOSiteURL]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">https://mitsui365fra.sharepoint.com/sites/02138/EUCCZ</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AssignOperation_94">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strSPOFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">DX Go live</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_95">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strSubFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">06. KB &amp; Zeon/Quintone Quintac</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AssignOperation_225">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strErrorFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[strErrorFolder + "\" +strProcessName.Replace(" ","_")]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                </ui:MultipleAssign>
                <ui:MultipleAssign DisplayName="Multiple Assign - Queues" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_48">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_243">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strQueueDU]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">BRUCP_Zeon_Filenames</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_244">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strQueuePODetails]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">BRUCP_Zeon_PO_Details</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                </ui:MultipleAssign>
                <Assign DisplayName="Assign Pending Folder" sap:VirtualizedContainerService.HintSize="431,60" sap2010:WorkflowViewState.IdRef="Assign_493">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[strPendingFolder]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">["\\AWEPVA10\Projects$\CoE\BRUCP Zeon"]</InArgument>
                  </Assign.Value>
                </Assign>
              </Sequence>
            </If.Else>
          </If>
          <ui:Delete ResourceFile="{x:Null}" ContinueOnError="True" DisplayName="Delete Desktop Folder" sap:VirtualizedContainerService.HintSize="1030.8,53.2" sap2010:WorkflowViewState.IdRef="Delete_26" Path="[strDesktopFolder]">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:Delete>
          <ui:CreateDirectory ContinueOnError="{x:Null}" Output="{x:Null}" DisplayName="Create New_Files Folder" sap:VirtualizedContainerService.HintSize="1030.8,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_2" Path="[strNewFolder]" />
          <If Condition="[IO.Directory.Exists(strErrorFolder)]" DisplayName="If Error Folder Exists" sap:VirtualizedContainerService.HintSize="484,327.6" sap2010:WorkflowViewState.IdRef="If_250">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <If.Then>
              <lf:Move_Folder StrComponentRunning="{x:Null}" DisplayName="Move Folder (Move_Folder)" sap:VirtualizedContainerService.HintSize="284,135.6" sap2010:WorkflowViewState.IdRef="Move_Folder_1" StrFinalFolder="[strDesktopFolder]" StrStartFolder="[strErrorFolder]" />
            </If.Then>
          </If>
          <ui:MultipleAssign DisplayName="Multiple Assign - Master Files and Working Files" sap:VirtualizedContainerService.HintSize="1030.8,273.6" sap2010:WorkflowViewState.IdRef="MultipleAssign_13">
            <ui:MultipleAssign.AssignOperations>
              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_84">
                  <ui:AssignOperation.To>
                    <OutArgument x:TypeArguments="x:String">[strMasterDataFile]</OutArgument>
                  </ui:AssignOperation.To>
                  <ui:AssignOperation.Value>
                    <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Master Data File.xlsx"]</InArgument>
                  </ui:AssignOperation.Value>
                </ui:AssignOperation>
                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_83">
                  <ui:AssignOperation.To>
                    <OutArgument x:TypeArguments="x:String">[strWFOne]</OutArgument>
                  </ui:AssignOperation.To>
                  <ui:AssignOperation.Value>
                    <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Working File Carine.xlsx"]</InArgument>
                  </ui:AssignOperation.Value>
                </ui:AssignOperation>
                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_85">
                  <ui:AssignOperation.To>
                    <OutArgument x:TypeArguments="x:String">[strWFTwo]</OutArgument>
                  </ui:AssignOperation.To>
                  <ui:AssignOperation.Value>
                    <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Working File Sofie.xlsx"]</InArgument>
                  </ui:AssignOperation.Value>
                </ui:AssignOperation>
                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_86">
                  <ui:AssignOperation.To>
                    <OutArgument x:TypeArguments="x:String">[strWFThree]</OutArgument>
                  </ui:AssignOperation.To>
                  <ui:AssignOperation.Value>
                    <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Working File Michele.xlsx"]</InArgument>
                  </ui:AssignOperation.Value>
                </ui:AssignOperation>
                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_87">
                  <ui:AssignOperation.To>
                    <OutArgument x:TypeArguments="s:String[]">
                      <mva:VisualBasicReference x:TypeArguments="s:String[]" ExpressionText="arrWorkingFiles" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_4" />
                    </OutArgument>
                  </ui:AssignOperation.To>
                  <ui:AssignOperation.Value>
                    <InArgument x:TypeArguments="s:String[]">[{strWFOne, strWFTwo, strWFThree}]</InArgument>
                  </ui:AssignOperation.Value>
                </ui:AssignOperation>
                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_245">
                  <ui:AssignOperation.To>
                    <OutArgument x:TypeArguments="x:String">[strCustomerList]</OutArgument>
                  </ui:AssignOperation.To>
                  <ui:AssignOperation.Value>
                    <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Master Customer List.xlsx"]</InArgument>
                  </ui:AssignOperation.Value>
                </ui:AssignOperation>
              </scg:List>
            </ui:MultipleAssign.AssignOperations>
          </ui:MultipleAssign>
          <ui:LogMessage DisplayName="Log message - Complete" sap:VirtualizedContainerService.HintSize="991,91" sap2010:WorkflowViewState.IdRef="LogMessage_38" Message="[strComponentRunning + &quot; Complete.&quot;]">
            <ui:LogMessage.Level>
              <InArgument x:TypeArguments="ui:LogLevel">
                <Literal x:TypeArguments="ui:LogLevel" sap2010:WorkflowViewState.IdRef="Literal`1_2" Value="Info" />
              </InArgument>
            </ui:LogMessage.Level>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:LogMessage>
        </Sequence>
        <TryCatch DisplayName="Try Catch - Multiple Jobs" sap:VirtualizedContainerService.HintSize="1437.2,53.2" sap2010:WorkflowViewState.IdRef="TryCatch_8">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <TryCatch.Try>
            <Flowchart DisplayName="Check Only One Job is Running" sap:VirtualizedContainerService.HintSize="904,636" sap2010:WorkflowViewState.IdRef="Flowchart_1">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <av:Point x:Key="ShapeLocation">320,2.5</av:Point>
                  <av:Size x:Key="ShapeSize">60,75</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">350,77.5 350,120</av:PointCollection>
                  <x:Double x:Key="Width">870</x:Double>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart.StartNode>
                <x:Reference>__ReferenceID6</x:Reference>
              </Flowchart.StartNode>
              <FlowStep x:Name="__ReferenceID6">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">219,120</av:Point>
                    <av:Size x:Key="ShapeSize">262,60</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">219,150 140,150 140,190</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_133">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:Int32">[intCount]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:Int32">0</InArgument>
                  </Assign.Value>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </Assign>
                <FlowStep.Next>
                  <FlowStep x:Name="__ReferenceID0">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">9,190</av:Point>
                        <av:Size x:Key="ShapeSize">262,60</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">140,250 140,274.5</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_134">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">
                          <mva:VisualBasicReference x:TypeArguments="x:String" ExpressionText="strComponentRunning" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_6" />
                        </OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">Check for Multiple Jobs</InArgument>
                      </Assign.Value>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </Assign>
                    <FlowStep.Next>
                      <FlowStep x:Name="__ReferenceID1">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">40,274.5</av:Point>
                            <av:Size x:Key="ShapeSize">200,51</av:Size>
                            <av:PointCollection x:Key="ConnectorLocation">240,300 270,300 270,256.5 325.5,256.5 325.5,286.5</av:PointCollection>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Check for Multiple Jobs" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False">
                          <ui:InvokeWorkflowFile.Arguments>
                            <OutArgument x:TypeArguments="x:String" x:Key="StrFailureReason">[strFailureReason]</OutArgument>
                            <OutArgument x:TypeArguments="x:Boolean" x:Key="BComplete">[bComplete]</OutArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="StrComponentRunning">[strComponentRunning]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="StrProcessName">[strProcessName]</InArgument>
                            <OutArgument x:TypeArguments="x:Boolean" x:Key="BRunning">[bRunning]</OutArgument>
                            <InArgument x:TypeArguments="x:Boolean" x:Key="BErrorHandling">False</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="StrOrchFolder">[strOrchFolder]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:InvokeWorkflowFile.WorkflowFileName>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_1">Check for Multiple Jobs.xaml</Literal>
                            </InArgument>
                          </ui:InvokeWorkflowFile.WorkflowFileName>
                        </ui:InvokeWorkflowFile>
                        <FlowStep.Next>
                          <FlowDecision x:Name="__ReferenceID2" Condition="[bComplete]" DisplayName="bComplete" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_1">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <av:Point x:Key="ShapeLocation">290.5,286.5</av:Point>
                                <av:Size x:Key="ShapeSize">70,87</av:Size>
                                <av:PointCollection x:Key="FalseConnector">360.5,330 429,330</av:PointCollection>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <FlowDecision.False>
                              <FlowStep x:Name="__ReferenceID3">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">429,300</av:Point>
                                    <av:Size x:Key="ShapeSize">262,60</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">560,300 560,263.5</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_135">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:Int32">[intCount]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:Int32">[intCount + 1]</InArgument>
                                  </Assign.Value>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </Assign>
                                <FlowStep.Next>
                                  <FlowDecision x:Name="__ReferenceID4" Condition="[intCount &lt; 4]" DisplayName="intCount &lt;4" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_2" True="{x:Reference __ReferenceID0}">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <av:Point x:Key="ShapeLocation">525,176.5</av:Point>
                                        <av:Size x:Key="ShapeSize">70,87</av:Size>
                                        <av:PointCollection x:Key="TrueConnector">525,220 271,220</av:PointCollection>
                                        <av:PointCollection x:Key="FalseConnector">595,220 670,220</av:PointCollection>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <FlowDecision.False>
                                      <FlowStep x:Name="__ReferenceID5">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <av:Point x:Key="ShapeLocation">670,209</av:Point>
                                            <av:Size x:Key="ShapeSize">200,22</av:Size>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Throw Exception="[New System.Exception(strFailureReason)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_8">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </Throw>
                                      </FlowStep>
                                    </FlowDecision.False>
                                  </FlowDecision>
                                </FlowStep.Next>
                              </FlowStep>
                            </FlowDecision.False>
                          </FlowDecision>
                        </FlowStep.Next>
                      </FlowStep>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowStep.Next>
              </FlowStep>
              <x:Reference>__ReferenceID0</x:Reference>
              <x:Reference>__ReferenceID1</x:Reference>
              <x:Reference>__ReferenceID2</x:Reference>
              <x:Reference>__ReferenceID3</x:Reference>
              <x:Reference>__ReferenceID4</x:Reference>
              <x:Reference>__ReferenceID5</x:Reference>
            </Flowchart>
          </TryCatch.Try>
          <TryCatch.Catches>
            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="908,21" sap2010:WorkflowViewState.IdRef="Catch`1_9">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ActivityAction x:TypeArguments="s:Exception">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                </ActivityAction.Argument>
                <If Condition="[Not bRunning]" DisplayName="Error Handling" sap:VirtualizedContainerService.HintSize="771,1271" sap2010:WorkflowViewState.IdRef="If_83">
                  <If.Then>
                    <Rethrow sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Rethrow_3" />
                  </If.Then>
                  <If.Else>
                    <Sequence DisplayName="Multiple Jobs Error Handling" sap:VirtualizedContainerService.HintSize="526,1113" sap2010:WorkflowViewState.IdRef="Sequence_165">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:Int32" Name="intDelay" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="484,91" sap2010:WorkflowViewState.IdRef="LogMessage_71" Level="Warn" Message="[&quot;Multiple jobs running. Waiting for Existing Job to End.&quot;]" />
                      <ui:InterruptibleDoWhile CurrentIndex="{x:Null}" Condition="[bRunning AndAlso intDelay &lt;= 60]" DisplayName="Do While" sap:VirtualizedContainerService.HintSize="484,603" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_1">
                        <ui:InterruptibleDoWhile.Body>
                          <Sequence sap2010:Annotation.AnnotationText="Loop through Running Jobs for 10 minutes to wait for other existing job to terminate. If 10 minutes is exceeded then an error has likely occurred and will require investigation from LDPTI." DisplayName="Loop Through Running Jobs" sap:VirtualizedContainerService.HintSize="376,438" sap2010:WorkflowViewState.IdRef="Sequence_166">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Check for Multiple Jobs" sap:VirtualizedContainerService.HintSize="334,112" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_2" UnSafe="False" WorkflowFileName="Check for Multiple Jobs.xaml">
                              <ui:InvokeWorkflowFile.Arguments>
                                <OutArgument x:TypeArguments="x:String" x:Key="StrFailureReason">[strFailureReason]</OutArgument>
                                <OutArgument x:TypeArguments="x:Boolean" x:Key="BComplete">[bComplete]</OutArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="StrComponentRunning">[strComponentRunning]</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="StrProcessName">[strProcessName]</InArgument>
                                <OutArgument x:TypeArguments="x:Boolean" x:Key="BRunning">[bRunning]</OutArgument>
                                <InArgument x:TypeArguments="x:Boolean" x:Key="BErrorHandling">True</InArgument>
                                <InArgument x:TypeArguments="x:String" x:Key="StrOrchFolder">[strOrchFolder]</InArgument>
                              </ui:InvokeWorkflowFile.Arguments>
                            </ui:InvokeWorkflowFile>
                            <Delay DisplayName="Delay 10 Seconds" Duration="00:00:10" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Delay_1" />
                            <Assign DisplayName="Assign Delay" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_136">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:Int32">[intDelay]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:Int32">[intDelay + 1]</InArgument>
                              </Assign.Value>
                            </Assign>
                          </Sequence>
                        </ui:InterruptibleDoWhile.Body>
                      </ui:InterruptibleDoWhile>
                      <If Condition="[intDelay &gt; 60 OrElse bRunning]" DisplayName="If Timeout Exceeded or Multiple Jobs are Still Running" sap:VirtualizedContainerService.HintSize="484,247" sap2010:WorkflowViewState.IdRef="If_85">
                        <If.Then>
                          <Throw Exception="[New System.Exception(&quot;Multiple Jobs running at once. First job took longer than 10 minutes to terminate. Please investigate.&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_9" />
                        </If.Then>
                      </If>
                    </Sequence>
                  </If.Else>
                </If>
              </ActivityAction>
            </Catch>
          </TryCatch.Catches>
        </TryCatch>
        <Assign sap:VirtualizedContainerService.HintSize="1437.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_736">
          <Assign.To>
            <OutArgument x:TypeArguments="s:String[]">[strTestAvbakjfsd]</OutArgument>
          </Assign.To>
          <Assign.Value>
            <InArgument x:TypeArguments="x:String">Testing'</InArgument>
          </Assign.Value>
        </Assign>
        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="1437.2,317.2" sap2010:WorkflowViewState.IdRef="ForEach`1_208" Values="[strTestAvbakjfsd]">
          <ui:ForEach.Body>
            <ActivityAction x:TypeArguments="x:String">
              <ActivityAction.Argument>
                <DelegateInArgument x:TypeArguments="x:String" Name="currentItem" />
              </ActivityAction.Argument>
              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="496,190.8" sap2010:WorkflowViewState.IdRef="Sequence_1146">
                <Sequence.Variables>
                  <Variable x:TypeArguments="x:String" Name="strTestVariable" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_737">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[strTestVariable]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">testing</InArgument>
                  </Assign.Value>
                </Assign>
              </Sequence>
            </ActivityAction>
          </ui:ForEach.Body>
        </ui:ForEach>
        <Sequence DisplayName="Download Files from SPO" sap:VirtualizedContainerService.HintSize="1437.2,83.6" sap2010:WorkflowViewState.IdRef="Sequence_172">
          <Sequence.Variables>
            <Variable x:TypeArguments="scg:ICollection(x:String)" Name="arrFiles" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Assign sap:VirtualizedContainerService.HintSize="434,60" sap2010:WorkflowViewState.IdRef="Assign_198">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">
                <mva:VisualBasicReference x:TypeArguments="x:String" ExpressionText="strComponentRunning" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_7" />
              </OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">["Download Files from SPO"]</InArgument>
            </Assign.Value>
          </Assign>
          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,91" sap2010:WorkflowViewState.IdRef="LogMessage_85" Message="[strComponentRunning + &quot; Started.&quot;]">
            <ui:LogMessage.Level>
              <InArgument x:TypeArguments="ui:LogLevel">
                <Literal x:TypeArguments="ui:LogLevel" sap2010:WorkflowViewState.IdRef="Literal`1_2" Value="Info" />
              </InArgument>
            </ui:LogMessage.Level>
          </ui:LogMessage>
          <l1:Check_File_or_Folder_Exists ArrDirectories="{x:Null}" BFileFolderExists="{x:Null}" StrDocLibURLName="{x:Null}" ArrFiles="[arrFiles]" DisplayName="Check File or Folder Exists" sap:VirtualizedContainerService.HintSize="434,185" sap2010:WorkflowViewState.IdRef="Check_File_or_Folder_Exists_1" StrDocLibraryName="[strDocLib]" StrOrchFolder="/" StrSPOFileFolderName="New_Files" StrSPOSiteUrl="[strSPOSiteURL]" StrSubFolder="[strSubFolder + &quot;/&quot; + strSPOFolder]" />
          <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Downloads each file individually so that they can be deleted without the folder itself being deleted from SPO" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="434,404" sap2010:WorkflowViewState.IdRef="ForEach`1_65" Values="[arrFiles]">
            <ui:ForEach.Body>
              <ActivityAction x:TypeArguments="x:String">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="x:String" Name="file" />
                </ActivityAction.Argument>
                <l1:Download_File StrDocLibURLName="{x:Null}" BDeleteFile="True" DisplayName="Download File" sap:VirtualizedContainerService.HintSize="284,238" sap2010:WorkflowViewState.IdRef="Download_File_1" StrDocLibraryName="[strDocLib]" StrDownloadPath="[strNewFolder]" StrOrchFolder="/" StrSPOFileName="[file]" StrSPOSiteURL="[strSPOSiteURL]" StrSubFolder="[strSubFolder + &quot;/&quot; + strSPOFolder + &quot;/New_Files&quot;]">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </l1:Download_File>
              </ActivityAction>
            </ui:ForEach.Body>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:ForEach>
          <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="434,362" sap2010:WorkflowViewState.IdRef="ForEach`1_71" Values="[arrWorkingFiles]">
            <ui:ForEach.Body>
              <ActivityAction x:TypeArguments="x:String">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="x:String" Name="workingFilePath" />
                </ActivityAction.Argument>
                <l1:Download_File StrDocLibURLName="{x:Null}" BDeleteFile="False" DisplayName="Download Working File" sap:VirtualizedContainerService.HintSize="334,238" sap2010:WorkflowViewState.IdRef="Download_File_2" StrDocLibraryName="[strDocLib]" StrDownloadPath="[workingFilePath]" StrOrchFolder="/" StrSPOFileName="[workingFilePath.Replace(strDesktopFolder + &quot;\&quot;,&quot;&quot;)]" StrSPOSiteURL="[strSPOSiteURL]" StrSubFolder="[strSubFolder + &quot;/&quot; + strSPOFolder]" />
              </ActivityAction>
            </ui:ForEach.Body>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:ForEach>
          <l1:Download_File StrDocLibURLName="{x:Null}" BDeleteFile="False" DisplayName="Download Master Data File" sap:VirtualizedContainerService.HintSize="434,238" sap2010:WorkflowViewState.IdRef="Download_File_3" StrDocLibraryName="[strDocLib]" StrDownloadPath="[strMasterDataFile]" StrOrchFolder="/" StrSPOFileName="[strMasterDataFile.Replace(strDesktopFolder + &quot;\&quot;,&quot;&quot;)]" StrSPOSiteURL="[strSPOSiteURL]" StrSubFolder="[strSubFolder + &quot;/&quot; + strSPOFolder]" />
          <l1:Download_File StrDocLibURLName="{x:Null}" BDeleteFile="False" DisplayName="Download Master Customer List" sap:VirtualizedContainerService.HintSize="434,238" sap2010:WorkflowViewState.IdRef="Download_File_4" StrDocLibraryName="[strDocLib]" StrDownloadPath="[strCustomerList]" StrOrchFolder="/" StrSPOFileName="[strCustomerList.Replace(strDesktopFolder + &quot;\&quot;,&quot;&quot;)]" StrSPOSiteURL="[strSPOSiteURL]" StrSubFolder="[strSubFolder + &quot;/&quot; + strSPOFolder]" />
          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,91" sap2010:WorkflowViewState.IdRef="LogMessage_86" Message="[strComponentRunning + &quot; Complete.&quot;]">
            <ui:LogMessage.Level>
              <InArgument x:TypeArguments="ui:LogLevel">
                <Literal x:TypeArguments="ui:LogLevel" sap2010:WorkflowViewState.IdRef="Literal`1_3" Value="Info" />
              </InArgument>
            </ui:LogMessage.Level>
          </ui:LogMessage>
        </Sequence>
        <Sequence DisplayName="Extract New File Data" sap:VirtualizedContainerService.HintSize="1437.2,12842.4" sap2010:WorkflowViewState.IdRef="Sequence_117">
          <Sequence.Variables>
            <Variable x:TypeArguments="s:String[]" Name="arrHeaders" />
            <Variable x:TypeArguments="x:String" Name="strPONo" />
            <Variable x:TypeArguments="s:Object[]" Name="arrRowItems" />
            <Variable x:TypeArguments="sd:DataTable" Name="dtEmails" />
            <Variable x:TypeArguments="sd:DataTable" Name="dtBooking" />
            <Variable x:TypeArguments="sd:DataTable" Name="dtPurchaseOrder" />
            <Variable x:TypeArguments="x:String" Name="strPOLineNumber" />
            <Variable x:TypeArguments="s:Object[][]" Default="[{({,}),({,})}]" Name="arrTableRows" />
            <Variable x:TypeArguments="x:String" Name="strQtyKG" />
            <Variable x:TypeArguments="x:String" Name="strCustomerName" />
            <Variable x:TypeArguments="x:String" Name="strIncoterms" />
            <Variable x:TypeArguments="x:String" Name="strFinalDestination" />
            <Variable x:TypeArguments="x:String" Name="strZACode" />
            <Variable x:TypeArguments="x:String" Name="strBizType" />
            <Variable x:TypeArguments="x:String" Name="strProduct" />
            <Variable x:TypeArguments="x:String" Name="strReqDelDate" />
            <Variable x:TypeArguments="x:String" Name="strGrade" />
            <Variable x:TypeArguments="x:String" Name="strPODate" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:LogMessage DisplayName="Log message - Component Started" sap:VirtualizedContainerService.HintSize="1375.2,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_161" Level="Info" Message="[&quot;Extract New File Data Started.&quot;]" />
          <Assign DisplayName="Assign Investigation Folder" sap:VirtualizedContainerService.HintSize="1375.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_473">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[strInvestigationFolder]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Manual Investigation Required"]</InArgument>
            </Assign.Value>
          </Assign>
          <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each File" sap:VirtualizedContainerService.HintSize="1375.2,7142.8" sap2010:WorkflowViewState.IdRef="ForEach`1_21" Values="[IO.Directory.GetFiles(strNewFolder)]">
            <ui:ForEach.Body>
              <ActivityAction x:TypeArguments="x:String">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="x:String" Name="strMsgPath" />
                </ActivityAction.Argument>
                <TryCatch DisplayName="Try Catch - Loop Through New Files" sap:VirtualizedContainerService.HintSize="1339.6,7016.4" sap2010:WorkflowViewState.IdRef="TryCatch_48">
                  <TryCatch.Variables>
                    <Variable x:TypeArguments="x:String" Name="strMsgFile" />
                    <Variable x:TypeArguments="x:Boolean" Name="bClassified" />
                  </TryCatch.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch.Try>
                    <Sequence DisplayName="Loop through New Files" sap:VirtualizedContainerService.HintSize="1302,6759.6" sap2010:WorkflowViewState.IdRef="Sequence_204">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign DisplayName="Assign File Name" sap:VirtualizedContainerService.HintSize="1240,82.4" sap2010:WorkflowViewState.IdRef="Assign_97">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strMsgFile]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strMsgPath.Split("\"c).Last]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="1240,6528.8" sap2010:WorkflowViewState.IdRef="IfElseIf_1">
                        <ui:IfElseIf.ConditionBlocks>
                          <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                            <ui:IfElseIfBlock BlockType="If" Condition="[strMsgFile.ToLower.EndsWith(&quot;.msg&quot;)]">
                              <ui:IfElseIfBlock.Then>
                                <Sequence DisplayName="Classify Emails" sap:VirtualizedContainerService.HintSize="1189.2,6126.8" sap2010:WorkflowViewState.IdRef="Sequence_71">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="s:Exception" Name="exInvokeCode" />
                                    <Variable x:TypeArguments="x:String" Name="strMsgBody" />
                                    <Variable x:TypeArguments="x:Boolean" Name="bAttachment" />
                                    <Variable x:TypeArguments="x:String" Name="strContractNo" />
                                    <Variable x:TypeArguments="x:String" Name="strAttachments" />
                                    <Variable x:TypeArguments="s:String[]" Name="arrAttachments" />
                                    <Variable x:TypeArguments="s:String[]" Name="arrClassifications" />
                                    <Variable x:TypeArguments="scg:IEnumerable(str:Match)" Name="colMatches" />
                                    <Variable x:TypeArguments="x:Int32" Name="intClassification" />
                                    <Variable x:TypeArguments="x:String" Name="strAttachType" />
                                    <Variable x:TypeArguments="x:String" Name="strNewAttachName" />
                                    <Variable x:TypeArguments="s:DateTime" Name="daEmailDate" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="1127.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_494">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[strMsgFile + ": Extract Email Information and Attachments"]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:LogMessage DisplayName="Log message - Component Started" sap:VirtualizedContainerService.HintSize="1127.2,88" sap2010:WorkflowViewState.IdRef="LogMessage_59" Message="[strComponentRunning + &quot; Started.&quot;]">
                                    <ui:LogMessage.Level>
                                      <InArgument x:TypeArguments="ui:LogLevel">
                                        <Literal x:TypeArguments="ui:LogLevel" sap2010:WorkflowViewState.IdRef="Literal`1_3" Value="Info" />
                                      </InArgument>
                                    </ui:LogMessage.Level>
                                  </ui:LogMessage>
                                  <Assign DisplayName="Assign bClassified as False" sap:VirtualizedContainerService.HintSize="1127.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_175">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Boolean">[bClassified]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:InvokeCode ContinueOnError="{x:Null}" Code="Dim outlookApplication As _Application = New Microsoft.Office.Interop.Outlook.Application()&#xA;Dim item As MailItem = CType(outlookApplication.CreateItemFromTemplate(In_MsgFile,Type.Missing),MailItem)&#xA;Try&#xA;&#x9;If item.Body IsNot Nothing Then&#xA;&#x9;&#x9;Out_Body = item.Body.ToString&#xA;&#x9;Else&#xA;&#x9;&#x9;Out_Body = &quot;&quot;&#xA;&#x9;End If&#xA;&#x9;Out_Date = item.ReceivedTime&#xA;&#x9;If item.Attachments.Count &gt; 0 Then&#xA;&#x9;&#x9;Out_Attach = True&#xA;&#x9;End If&#xA;Catch ex As System.Exception&#xA;&#x9;Out_Ex = ex&#xA;End Try" DisplayName="Extract Email Body" sap:VirtualizedContainerService.HintSize="1127.2,164.8" sap2010:WorkflowViewState.IdRef="InvokeCode_1">
                                    <ui:InvokeCode.Arguments>
                                      <OutArgument x:TypeArguments="s:Exception" x:Key="Out_Ex">
                                        <mva:VisualBasicReference x:TypeArguments="s:Exception" ExpressionText="exInvokeCode" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_9" />
                                      </OutArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="In_MsgFile">[strMsgPath]</InArgument>
                                      <OutArgument x:TypeArguments="x:String" x:Key="Out_Body">[strMsgBody]</OutArgument>
                                      <OutArgument x:TypeArguments="x:Boolean" x:Key="Out_Attach">[bAttachment]</OutArgument>
                                      <OutArgument x:TypeArguments="s:DateTime" x:Key="Out_Date">[daEmailDate]</OutArgument>
                                    </ui:InvokeCode.Arguments>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:InvokeCode>
                                  <If DisplayName="If No Exception" sap:VirtualizedContainerService.HintSize="1127.2,53.2" sap2010:WorkflowViewState.IdRef="If_35">
                                    <If.Condition>
                                      <InArgument x:TypeArguments="x:Boolean">
                                        <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="exInvokeCode Is Nothing" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_4" />
                                      </InArgument>
                                    </If.Condition>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Else>
                                      <Throw Exception="[exInvokeCode]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_5" />
                                    </If.Else>
                                  </If>
                                  <Assign DisplayName="Assign Array of Classifications" sap:VirtualizedContainerService.HintSize="1127.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_451">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="s:String[]">[arrClassifications]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="s:String[]">[{"Import Delivery Instruction", "IDI", "MUGEN Invoice", "Payment WF", "Payment W/F", "Back to Back WF", "Back to Back W/F", "B2B", "Purchase WF", "Purchase W/F", "Shipping Advice", "Booking Advice", "ODP", "PO'", "Purchase Order", "BA"}]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:Matches FirstMatch="{x:Null}" DisplayName="Get Classification Matches" sap:VirtualizedContainerService.HintSize="1127.2,60" sap2010:WorkflowViewState.IdRef="Matches_1" Input="[strMsgFile]" IsBuilderTabModified="False" Pattern="[&quot;(?:&quot; + String.Join(&quot;|&quot;,arrClassifications) + &quot;)+&quot;]" RegexOption="IgnoreCase, Compiled" Result="[colMatches]" />
                                  <Assign DisplayName="Assign Number of Classifications" sap:VirtualizedContainerService.HintSize="1127,60" sap2010:WorkflowViewState.IdRef="Assign_452">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Int32">[intClassification]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Int32">[colMatches.Count]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Email Type" sap:VirtualizedContainerService.HintSize="1127,2321" sap2010:WorkflowViewState.IdRef="ForEach`1_77" Values="[arrClassifications]">
                                    <ui:ForEach.Body>
                                      <ActivityAction x:TypeArguments="x:String">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="x:String" Name="strMsgClassification" />
                                        </ActivityAction.Argument>
                                        <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="1091,2198" sap2010:WorkflowViewState.IdRef="IfElseIf_11">
                                          <ui:IfElseIf.ConditionBlocks>
                                            <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                              <ui:IfElseIfBlock BlockType="If" Condition="[(intClassification = 1 AndAlso strMsgFile.ToUpper.Contains(strMsgClassification.ToUpper)) OrElse (intClassification &gt; 1 AndAlso strMsgFile.ToUpper.StartsWith(strMsgClassification.ToUpper)) OrElse (intClassification = 1 AndAlso strMsgBody.ToUpper.StartsWith(strMsgClassification.ToUpper))]">
                                                <ui:IfElseIfBlock.Then>
                                                  <Sequence DisplayName="Classify Email Type" sap:VirtualizedContainerService.HintSize="1040,1862" sap2010:WorkflowViewState.IdRef="Sequence_236">
                                                    <Sequence.Variables>
                                                      <Variable x:TypeArguments="s:String[]" Name="arrContractLines" />
                                                    </Sequence.Variables>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="998,87" sap2010:WorkflowViewState.IdRef="LogMessage_164" Level="Info" Message="[&quot;Email identified as &quot; + strMsgClassification + &quot;. Assiging relevant variables.&quot;]" />
                                                    <Assign DisplayName="Assign - Clear Headers" sap:VirtualizedContainerService.HintSize="998,60" sap2010:WorkflowViewState.IdRef="Assign_486">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="s:String[]">[{}]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <Assign DisplayName="Assign - Clear Table Rows" sap:VirtualizedContainerService.HintSize="998,60" sap2010:WorkflowViewState.IdRef="Assign_509">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="s:String[][]">[{}]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <Assign DisplayName="Assign - Clear Contract Array" sap:VirtualizedContainerService.HintSize="998,60" sap2010:WorkflowViewState.IdRef="Assign_582">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="s:String[]">[arrContractLines]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="s:String[]">[{}]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <Flowchart DisplayName="Classification Flow" sap:VirtualizedContainerService.HintSize="1020.8,637.6" sap2010:WorkflowViewState.IdRef="Flowchart_5">
                                                      <Flowchart.Variables>
                                                        <Variable x:TypeArguments="x:String" Name="strExtractedText" />
                                                        <Variable x:TypeArguments="x:String" Name="strAttMsgBody" />
                                                        <Variable x:TypeArguments="x:String" Name="strVessel" />
                                                        <Variable x:TypeArguments="x:String" Name="strContractSplit" />
                                                        <Variable x:TypeArguments="x:String" Name="strContractStringManip" />
                                                        <Variable x:TypeArguments="x:String" Name="strBLNo" />
                                                        <Variable x:TypeArguments="x:String" Name="strETA" />
                                                        <Variable x:TypeArguments="x:String" Name="strETD" />
                                                      </Flowchart.Variables>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          <av:Point x:Key="ShapeLocation">430,2.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">60,75.2</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">460,77.5 460,126.5</av:PointCollection>
                                                          <x:Double x:Key="Width">986.8</x:Double>
                                                          <x:Double x:Key="Height">600.6</x:Double>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Flowchart.StartNode>
                                                        <x:Reference>__ReferenceID15</x:Reference>
                                                      </Flowchart.StartNode>
                                                      <FlowSwitch x:TypeArguments="x:String" x:Name="__ReferenceID15" DisplayName="Classification" Expression="[strMsgClassification.ToUpper]" sap:VirtualizedContainerService.HintSize="74.4,87.2" sap2010:WorkflowViewState.IdRef="FlowSwitch`1_4">
                                                        <FlowSwitch.Default>
                                                          <FlowStep x:Name="__ReferenceID12">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <av:Point x:Key="ShapeLocation">160,487</av:Point>
                                                                <av:Size x:Key="ShapeSize">200,69.6</av:Size>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Throw sap2010:Annotation.AnnotationText="Throw if invalid classification type is found." DisplayName="Throw" Exception="[New System.Exception (&quot;Invalid Classification type: &quot; + strMsgClassification + &quot;. Please Investigate: &quot; + strMsgFile + &quot;.&quot;)]" sap:VirtualizedContainerService.HintSize="200,69.6" sap2010:WorkflowViewState.IdRef="Throw_45">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </Throw>
                                                          </FlowStep>
                                                        </FlowSwitch.Default>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <av:Point x:Key="ShapeLocation">422,126.5</av:Point>
                                                            <av:Size x:Key="ShapeSize">74.4,87.2</av:Size>
                                                            <av:PointCollection x:Key="Default">440.6,213.7 440.6,521.8 360,521.8</av:PointCollection>
                                                            <av:PointCollection x:Key="BOOKING ADVICEConnector">441,126.5 441,81.0444444444445 100,81.0444444444445 100,117</av:PointCollection>
                                                            <av:PointCollection x:Key="IDIConnector">422,191.9 392,191.9 392,291.1 200,291.1</av:PointCollection>
                                                            <av:PointCollection x:Key="SHIPPING ADVICEConnector">477.8,126.5 477.8,96.5 830,96.5 830,117</av:PointCollection>
                                                            <av:PointCollection x:Key="IMPORT DELIVERY INSTRUCTIONConnector">422,148.3 392,148.3 392,234.5 100,234.5 100,264.5</av:PointCollection>
                                                            <av:PointCollection x:Key="PURCHASE WFConnector">496.4,191.9 526.4,191.9 526.4,401.1 730,401.1</av:PointCollection>
                                                            <av:PointCollection x:Key="PURCHASE W/FConnector">477.8,213.7 477.8,344.5 830,344.5 830,374.5</av:PointCollection>
                                                            <av:PointCollection x:Key="PAYMENT WFConnector">422,170.1 392,170.1 392,354.5 100,354.5 100,384.5</av:PointCollection>
                                                            <av:PointCollection x:Key="PAYMENT W/FConnector">459.2,213.7 459.2,411.1 200,411.1</av:PointCollection>
                                                            <av:PointCollection x:Key="MUGEN INVOICEConnector">496.4,170.1 526.4,170.1 526.4,281.1 730,281.1</av:PointCollection>
                                                            <av:PointCollection x:Key="BACK TO BACK WFConnector">459.2,126.5 459.2,101.1 960,101.1 960,401.1 930,401.1</av:PointCollection>
                                                            <av:PointCollection x:Key="BACK TO BACK W/FConnector">496.4,148.3 526.4,148.3 526.4,457.7 830,457.7 830,427.7</av:PointCollection>
                                                            <av:PointCollection x:Key="BAConnector">440.6,126.5 440.6,98.8 230,98.8 230,158.8 200,158.8</av:PointCollection>
                                                            <av:PointCollection x:Key="B2BConnector">459.2,126.5 459.2,101.1 700,101.1 700,401.1 730,401.1</av:PointCollection>
                                                            <av:PointCollection x:Key="ODPConnector">459.2,213.7 459.2,558.8 580,558.8</av:PointCollection>
                                                            <av:PointCollection x:Key="PO'Connector">477.8,213.7 477.8,558.8 580,558.8</av:PointCollection>
                                                            <av:PointCollection x:Key="PURCHASE ORDERConnector">477.8,213.7 477.8,558.8 580,558.8</av:PointCollection>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <FlowStep x:Key="PURCHASE WF" x:Name="__ReferenceID7">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">730,374.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,53.2</av:Size>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If Condition="[bAttachment]" DisplayName="Add Purchase WF Information to Table" sap:VirtualizedContainerService.HintSize="200,53.2" sap2010:WorkflowViewState.IdRef="If_217">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Then>
                                                              <Sequence DisplayName="Add Purchase WF Information to Table" sap:VirtualizedContainerService.HintSize="1444.8,4891.6" sap2010:WorkflowViewState.IdRef="Sequence_410">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RenameFileX sap2010:Annotation.AnnotationText="File needs to be renamed to exclude spaces as VbScript cannot handle them." DisplayName="Rename File" FilePath="[strMsgPath]" sap:VirtualizedContainerService.HintSize="1382.8,191.2" sap2010:WorkflowViewState.IdRef="RenameFileX_21" KeepExtension="True" NewName="[strMsgPath.Replace(&quot; &quot;,&quot;_&quot;)]">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:RenameFileX>
                                                                <Assign DisplayName="Assign File Path" sap:VirtualizedContainerService.HintSize="1382.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_359">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strMsgPath]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[strMsgPath.Replace(" ","_")]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <lm:VBS___Get_List_of_Attachments StrMsgPath="{x:Null}" DisplayName="VBS - Get List of Attachments (VBS___Get_List_of_Attachments)" sap:VirtualizedContainerService.HintSize="1382.8,81.2" sap2010:WorkflowViewState.IdRef="VBS___Get_List_of_Attachments_1" StrAttachments="[strMsgPath]" />
                                                                <Assign DisplayName="Assign Attachment Type" sap:VirtualizedContainerService.HintSize="1382.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_455">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strAttachType]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">.msg</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="1382.8,4186" sap2010:WorkflowViewState.IdRef="IfElseIf_9">
                                                                  <ui:IfElseIf.ConditionBlocks>
                                                                    <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                      <ui:IfElseIfBlock BlockType="If" Condition="[Regex.Matches(strAttachments.ToLower,Regex.Escape(strAttachType)).Count = 0]">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email contains no &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; attachments. &quot; + strMsgClassification + &quot; requires one &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; to be attached.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_87" />
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                      <ui:IfElseIfBlock BlockType="ElseIf" Condition="[Regex.Matches(strAttachments.ToLower,Regex.Escape(strAttachType)).Count &gt; 1]">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email contains multiple &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; attachments. &quot; + strMsgClassification + &quot; requires only one &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; to be attached.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_86" />
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                      <ui:IfElseIfBlock BlockType="Else">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Sequence DisplayName="Extract Each Attachment (Purchase WF)" sap:VirtualizedContainerService.HintSize="1332,3784" sap2010:WorkflowViewState.IdRef="Sequence_408">
                                                                            <Sequence.Variables>
                                                                              <Variable x:TypeArguments="x:String" Name="strPurchaseWF" />
                                                                            </Sequence.Variables>
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <Assign DisplayName="Assign Array of Attachments" sap:VirtualizedContainerService.HintSize="1270,82.4" sap2010:WorkflowViewState.IdRef="Assign_362">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="s:String[]">[arrAttachments]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="s:String[]">[strAttachments.Split(","c).ToArray]</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="1270,3553.2" sap2010:WorkflowViewState.IdRef="ForEach`1_98" Values="[arrAttachments]">
                                                                              <ui:ForEach.Body>
                                                                                <ActivityAction x:TypeArguments="x:String">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="x:String" Name="attachToFind" />
                                                                                  </ActivityAction.Argument>
                                                                                  <If Condition="[attachToFind.ToLower.EndsWith(strAttachType)]" DisplayName="If attachToFind ends with strAttachType" sap:VirtualizedContainerService.HintSize="1234.4,3428" sap2010:WorkflowViewState.IdRef="If_252">
                                                                                    <If.Then>
                                                                                      <Sequence DisplayName="Extract Info from Attachment (Purchase WF)" sap:VirtualizedContainerService.HintSize="1198.8,3257.2" sap2010:WorkflowViewState.IdRef="Sequence_407">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <Assign DisplayName="Assign Attachment Name" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_471">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strNewAttachName]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[strNewFolder + "\" + strMsgPath.Split("\"c).Last.Replace(".msg","") + "-" + DaOpDate.ToString("yyyyMMdd") + strAttachType]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <lm:VBS___Extract_Attachments IntAttachmentToFind="{x:Null}" StrAttachmentToFind="{x:Null}" StrNewAttachmentName="{x:Null}" DisplayName="VBS - Extract Attachments (VBS___Extract_Attachments)" sap:VirtualizedContainerService.HintSize="1136.8,81.2" sap2010:WorkflowViewState.IdRef="VBS___Extract_Attachments_1" StrMsgPath="[strNewAttachName]" />
                                                                                        <ui:InvokeCode ContinueOnError="{x:Null}" Code="Dim outlookApplication As _Application = New Microsoft.Office.Interop.Outlook.Application()&#xA;Dim item As MailItem = CType(outlookApplication.CreateItemFromTemplate(In_MsgFile,Type.Missing),MailItem)&#xA;Try&#xA;&#x9;Out_Body = item.Body.ToString&#xA;Catch ex As System.Exception&#xA;&#x9;Out_Ex = ex&#xA;End Try" DisplayName="Extract Attachment Email Body &amp; Subject" sap:VirtualizedContainerService.HintSize="1136.8,164.8" sap2010:WorkflowViewState.IdRef="InvokeCode_7">
                                                                                          <ui:InvokeCode.Arguments>
                                                                                            <OutArgument x:TypeArguments="s:Exception" x:Key="Out_Ex">[exInvokeCode]</OutArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="In_MsgFile">[strNewAttachName]</InArgument>
                                                                                            <OutArgument x:TypeArguments="x:String" x:Key="Out_Body">[strAttMsgBody]</OutArgument>
                                                                                          </ui:InvokeCode.Arguments>
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </ui:InvokeCode>
                                                                                        <If Condition="[exInvokeCode Is Nothing]" DisplayName="If No Exception" sap:VirtualizedContainerService.HintSize="1136.8,53.2" sap2010:WorkflowViewState.IdRef="If_214">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Else>
                                                                                            <Throw Exception="[exInvokeCode]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_52" />
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <If Condition="[strMsgBody.ToUpper.Contains(&quot;CEK&quot;) AndAlso strAttMsgBody.ToUpper.Contains(&quot;RZ&quot;)]" DisplayName="If Purchase WF Info can be Found" sap:VirtualizedContainerService.HintSize="1136.8,459.2" sap2010:WorkflowViewState.IdRef="If_248">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Then>
                                                                                            <ui:MultipleAssign DisplayName="Multiple Assign - Contract No, Purchase WF, BL No" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_41">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_202">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">["CEK" + System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_203">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strPurchaseWF]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strAttMsgBody," - ".ToCharArray)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_323">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strBLNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"B/L NO.".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                            </ui:MultipleAssign>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Sequence DisplayName="Delete Attachment and Throw Error" sap:VirtualizedContainerService.HintSize="416,308.8" sap2010:WorkflowViewState.IdRef="Sequence_451">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <ui:Delete ContinueOnError="{x:Null}" ResourceFile="{x:Null}" DisplayName="Delete Attachment" sap:VirtualizedContainerService.HintSize="354,135.6" sap2010:WorkflowViewState.IdRef="Delete_23" Path="[strNewAttachName]">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </ui:Delete>
                                                                                              <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Cannot find required &quot; + strMsgClassification + &quot; information within Email body and attached &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot;.&quot;)]" sap:VirtualizedContainerService.HintSize="354,24.8" sap2010:WorkflowViewState.IdRef="Throw_88" />
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <If Condition="[strContractNo.Trim.EndsWith(&quot;.&quot;)]" DisplayName="If Contract Ends With &quot;.&quot;" sap:VirtualizedContainerService.HintSize="1136.8,53.2" sap2010:WorkflowViewState.IdRef="If_415">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Then>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_626">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[strContractNo.Replace(".","")]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_627">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[strContractNo + System.Text.RegularExpressions.Regex.Split(strMsgBody,System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray)(1)).Last.Split(VbNewLine.ToCharArray)(0).Replace(".","")]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <If Condition="[strContractNo.Trim.EndsWith(&quot;,&quot;)]" DisplayName="If Contract Ends With &quot;,&quot;" sap:VirtualizedContainerService.HintSize="1136.8,53.2" sap2010:WorkflowViewState.IdRef="If_416">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Then>
                                                                                            <ui:MultipleAssign DisplayName="Assign Contract No" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_75">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_324">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractStringManip]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray).Last.Trim).Split(VbNewLine.ToCharArray)(0)]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_325">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(strMsgBody,"REF_NO.".ToCharArray)(1).Replace(":","").Replace(VBNewLine,"").Trim,strContractStringManip)(0).Trim + strContractStringManip)]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                            </ui:MultipleAssign>
                                                                                          </If.Then>
                                                                                        </If>
                                                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract" sap:VirtualizedContainerService.HintSize="1136.8,811.6" sap2010:WorkflowViewState.IdRef="ForEach`1_170" Values="[strContractNo.Split(&quot;,&quot;c)]">
                                                                                          <ui:ForEach.Body>
                                                                                            <ActivityAction x:TypeArguments="x:String">
                                                                                              <ActivityAction.Argument>
                                                                                                <DelegateInArgument x:TypeArguments="x:String" Name="strPurchaseContract" />
                                                                                              </ActivityAction.Argument>
                                                                                              <Sequence DisplayName="Extract Contract Lines" sap:VirtualizedContainerService.HintSize="1101.2,686.4" sap2010:WorkflowViewState.IdRef="Sequence_878">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <Assign DisplayName="Assign Contract Array" sap:VirtualizedContainerService.HintSize="1039.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_628">
                                                                                                  <Assign.To>
                                                                                                    <OutArgument x:TypeArguments="s:String[]">[arrContractLines]</OutArgument>
                                                                                                  </Assign.To>
                                                                                                  <Assign.Value>
                                                                                                    <InArgument x:TypeArguments="s:String[]">[(strPurchaseContract.Split("-"c).Last).Split("/"c)]</InArgument>
                                                                                                  </Assign.Value>
                                                                                                </Assign>
                                                                                                <If Condition="[strPurchaseContract.Contains(&quot;-&quot;)]" DisplayName="If Contract No contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="1039.2,455.6" sap2010:WorkflowViewState.IdRef="If_417">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <If.Then>
                                                                                                    <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract Number" sap:VirtualizedContainerService.HintSize="515.2,305.2" sap2010:WorkflowViewState.IdRef="ForEach`1_169" Values="[arrContractLines]">
                                                                                                      <ui:ForEach.Body>
                                                                                                        <ActivityAction x:TypeArguments="x:String">
                                                                                                          <ActivityAction.Argument>
                                                                                                            <DelegateInArgument x:TypeArguments="x:String" Name="strContractLine" />
                                                                                                          </ActivityAction.Argument>
                                                                                                          <ui:MultipleAssign DisplayName="Multiple Assign - Purchase WF" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_76">
                                                                                                            <ui:MultipleAssign.AssignOperations>
                                                                                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_326">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="x:String">[strPurchaseContract.Remove(strPurchaseContract.LastIndexof("-")).ToString.Trim + "-" + strContractLine.Trim]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_327">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="s:Object[]">[{strContractSplit.ToUpper.Trim, strPurchaseWF.ToUpper.Trim, strBLNo.ToUpper.Trim, strMsgFile}]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_328">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                              </scg:List>
                                                                                                            </ui:MultipleAssign.AssignOperations>
                                                                                                          </ui:MultipleAssign>
                                                                                                        </ActivityAction>
                                                                                                      </ui:ForEach.Body>
                                                                                                    </ui:ForEach>
                                                                                                  </If.Then>
                                                                                                  <If.Else>
                                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign - Purchase WF" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_77">
                                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_329">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="x:String">[strPurchaseContract.Trim]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_330">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="s:Object[]">[{strContractSplit.ToUpper.Trim, strPurchaseWF.ToUpper.Trim, strBLNo.ToUpper.Trim, strMsgFile}]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_331">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                        </scg:List>
                                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                                    </ui:MultipleAssign>
                                                                                                  </If.Else>
                                                                                                </If>
                                                                                              </Sequence>
                                                                                            </ActivityAction>
                                                                                          </ui:ForEach.Body>
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </ui:ForEach>
                                                                                        <ui:Delete ContinueOnError="{x:Null}" ResourceFile="{x:Null}" DisplayName="Delete Attachment" sap:VirtualizedContainerService.HintSize="1136.8,135.6" sap2010:WorkflowViewState.IdRef="Delete_15" Path="[strNewAttachName]">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </ui:Delete>
                                                                                        <Assign DisplayName="Assign Classification Folder" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_363">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Business Support Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <If Condition="[Not dtPurchaseWF Is Nothing]" DisplayName="If Table Already Exists" sap:VirtualizedContainerService.HintSize="1136.8,649.6" sap2010:WorkflowViewState.IdRef="If_212">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Else>
                                                                                            <Sequence DisplayName="Create Purchase WF DataTable" sap:VirtualizedContainerService.HintSize="496,499.2" sap2010:WorkflowViewState.IdRef="Sequence_405">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <Assign DisplayName="Assign Table Name" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_364">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="sd:DataTable">[dtPurchaseWF]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="sd:DataTable">[New System.Data.DataTable("3-Purchase WF")]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                              <Assign DisplayName="Assign Headers" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_365">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="s:String[]">[{"BRUCP contract no.", "Purchase W/F", "BL number", "File Name"}]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                              <AddToCollection x:TypeArguments="sd:DataTable" Collection="[colTables]" DisplayName="Add DataTable To Collection" sap:VirtualizedContainerService.HintSize="434,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_100" Item="[dtPurchaseWF]" />
                                                                                              <ui:CreateDirectory ContinueOnError="{x:Null}" Output="{x:Null}" DisplayName="Create Classification Folder" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_36" Path="[strClassificationFolder]" />
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <Assign DisplayName="Assign Data Table" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_366">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="sd:DataTable">[dtEmails]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="sd:DataTable">[dtPurchaseWF]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </Sequence>
                                                                                    </If.Then>
                                                                                  </If>
                                                                                </ActivityAction>
                                                                              </ui:ForEach.Body>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:ForEach>
                                                                          </Sequence>
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                    </sc:BindingList>
                                                                  </ui:IfElseIf.ConditionBlocks>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:IfElseIf>
                                                              </Sequence>
                                                            </If.Then>
                                                            <If.Else>
                                                              <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email identified as: &quot; + strMsgClassification + &quot;,  but has no attachments.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_85" />
                                                            </If.Else>
                                                          </If>
                                                        </FlowStep>
                                                        <x:Reference>__ReferenceID7<x:Key>PURCHASE W/F</x:Key></x:Reference>
                                                        <FlowStep x:Key="IDI" x:Name="__ReferenceID9">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">0,264.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,53.2</av:Size>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If Condition="[bAttachment]" DisplayName="Add IDI Information To Table" sap:VirtualizedContainerService.HintSize="200,53.2" sap2010:WorkflowViewState.IdRef="If_235">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Then>
                                                              <Sequence DisplayName="Add IDI Information to Table" sap:VirtualizedContainerService.HintSize="1444.8,4507.2" sap2010:WorkflowViewState.IdRef="Sequence_438">
                                                                <Sequence.Variables>
                                                                  <Variable x:TypeArguments="x:String" Name="strIDI" />
                                                                </Sequence.Variables>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RenameFileX sap2010:Annotation.AnnotationText="File needs to be renamed to exclude spaces as VbScript cannot handle them." DisplayName="Rename File" FilePath="[strMsgPath]" sap:VirtualizedContainerService.HintSize="1382.8,191.2" sap2010:WorkflowViewState.IdRef="RenameFileX_23" KeepExtension="True" NewName="[strMsgPath.Replace(&quot; &quot;,&quot;_&quot;)]">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:RenameFileX>
                                                                <Assign DisplayName="Assign File Path" sap:VirtualizedContainerService.HintSize="1382.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_377">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strMsgPath]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[strMsgPath.Replace(" ","_")]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <lm:VBS___Get_List_of_Attachments StrMsgPath="{x:Null}" DisplayName="VBS - Get List of Attachments (VBS___Get_List_of_Attachments)" sap:VirtualizedContainerService.HintSize="1382.8,81.2" sap2010:WorkflowViewState.IdRef="VBS___Get_List_of_Attachments_2" StrAttachments="[strMsgPath]" />
                                                                <Assign DisplayName="Assign Attachment Type" sap:VirtualizedContainerService.HintSize="1382.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_453">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strAttachType]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">.pdf</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="1382.8,3801.6" sap2010:WorkflowViewState.IdRef="IfElseIf_8">
                                                                  <ui:IfElseIf.ConditionBlocks>
                                                                    <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                      <ui:IfElseIfBlock BlockType="If" Condition="[Regex.Matches(strAttachments.ToLower,Regex.Escape(strAttachType)).Count = 0]">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email contains no &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; attachments. &quot; + strMsgClassification + &quot; requires one &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; to be attached.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_80" />
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                      <ui:IfElseIfBlock BlockType="ElseIf" Condition="[Regex.Matches(strAttachments.ToLower,Regex.Escape(strAttachType)).Count &gt; 1]">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email contains multiple &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; attachments. &quot; + strMsgClassification + &quot; requires only one &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; to be attached.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_81" />
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                      <ui:IfElseIfBlock BlockType="Else">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Sequence DisplayName="Extract Each Attachment (IDI)" sap:VirtualizedContainerService.HintSize="1332,3399.6" sap2010:WorkflowViewState.IdRef="Sequence_437">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <Assign DisplayName="Assign Array of Attachments" sap:VirtualizedContainerService.HintSize="1270,82.4" sap2010:WorkflowViewState.IdRef="Assign_380">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="s:String[]">[arrAttachments]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="s:String[]">[strAttachments.Split(","c).ToArray]</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="1270,3168.8" sap2010:WorkflowViewState.IdRef="ForEach`1_102" Values="[arrAttachments]">
                                                                              <ui:ForEach.Body>
                                                                                <ActivityAction x:TypeArguments="x:String">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="x:String" Name="attachToFind" />
                                                                                  </ActivityAction.Argument>
                                                                                  <If Condition="[attachToFind.ToLower.EndsWith(strAttachType)]" DisplayName="If Attachment Ends with strAttachType" sap:VirtualizedContainerService.HintSize="1234.4,3043.6" sap2010:WorkflowViewState.IdRef="If_253">
                                                                                    <If.Then>
                                                                                      <Sequence DisplayName="Extract Info from Attachment (IDI)" sap:VirtualizedContainerService.HintSize="1198.8,2872.8" sap2010:WorkflowViewState.IdRef="Sequence_436">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <Assign DisplayName="Assign Attachment Name" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_469">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strNewAttachName]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[strNewFolder + "\" + strMsgPath.Split("\"c).Last.Replace(".msg","") + "-" + DaOpDate.ToString("yyyyMMdd") + strAttachType]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <lm:VBS___Extract_Attachments IntAttachmentToFind="{x:Null}" StrAttachmentToFind="{x:Null}" StrNewAttachmentName="{x:Null}" DisplayName="VBS - Extract Attachments (VBS___Extract_Attachments)" sap:VirtualizedContainerService.HintSize="1136.8,81.2" sap2010:WorkflowViewState.IdRef="VBS___Extract_Attachments_2" StrMsgPath="[strNewAttachName]" />
                                                                                        <ui:ReadPDFText PreserveFormatting="{x:Null}" DisplayName="Read PDF Text" FileName="[strNewAttachName]" sap:VirtualizedContainerService.HintSize="1136.8,60" sap2010:WorkflowViewState.IdRef="ReadPDFText_10" Range="All" Text="[strExtractedText]" />
                                                                                        <If Condition="[strExtractedText.ToUpper.Contains(&quot;TCAN REF&quot;) AndAlso strExtractedText.toUpper.Contains(&quot;CONTRACT NO&quot;) AndAlso strExtractedText.ToUpper.Contains(&quot;TRANSPORT DOCUMENT&quot;)]" DisplayName="If IDI Info can be Found" sap:VirtualizedContainerService.HintSize="1136.8,459.2" sap2010:WorkflowViewState.IdRef="If_231">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Then>
                                                                                            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_43">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_209">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strExtractedText,"Contract No".ToCharArray)(1).Trim.Split(" "c)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_210">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strIDI]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strExtractedText,"TCAN Ref".ToCharArray)(1).Trim.Split(" "c)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_307">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strBLNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strExtractedText.ToUpper,"TRANSPORT DOCUMENT".ToString)(1).Split(VBNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                            </ui:MultipleAssign>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Sequence DisplayName="Delete Attachment and Throw Error" sap:VirtualizedContainerService.HintSize="416,308.8" sap2010:WorkflowViewState.IdRef="Sequence_434">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <ui:Delete ContinueOnError="{x:Null}" ResourceFile="{x:Null}" DisplayName="Delete Attachment" sap:VirtualizedContainerService.HintSize="354,135.6" sap2010:WorkflowViewState.IdRef="Delete_19" Path="[strNewAttachName]" />
                                                                                              <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Cannot find required &quot; + strMsgClassification + &quot; information within attached &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot;.&quot;)]" sap:VirtualizedContainerService.HintSize="354,24.8" sap2010:WorkflowViewState.IdRef="Throw_66" />
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract" sap:VirtualizedContainerService.HintSize="1136.8,811.6" sap2010:WorkflowViewState.IdRef="ForEach`1_164" Values="[strContractNo.Split(&quot;,&quot;c)]">
                                                                                          <ui:ForEach.Body>
                                                                                            <ActivityAction x:TypeArguments="x:String">
                                                                                              <ActivityAction.Argument>
                                                                                                <DelegateInArgument x:TypeArguments="x:String" Name="strIDIContract" />
                                                                                              </ActivityAction.Argument>
                                                                                              <Sequence DisplayName="Extract Contract Lines" sap:VirtualizedContainerService.HintSize="1101.2,686.4" sap2010:WorkflowViewState.IdRef="Sequence_860">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <Assign DisplayName="Assign Contract Array" sap:VirtualizedContainerService.HintSize="1039.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_618">
                                                                                                  <Assign.To>
                                                                                                    <OutArgument x:TypeArguments="s:String[]">[arrContractLines]</OutArgument>
                                                                                                  </Assign.To>
                                                                                                  <Assign.Value>
                                                                                                    <InArgument x:TypeArguments="s:String[]">[(strIDIContract.Split("-"c).Last).Split("/"c)]</InArgument>
                                                                                                  </Assign.Value>
                                                                                                </Assign>
                                                                                                <If Condition="[strIDIContract.Contains(&quot;-&quot;)]" DisplayName="If Contract No contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="1039.2,455.6" sap2010:WorkflowViewState.IdRef="If_405">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <If.Then>
                                                                                                    <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract Number" sap:VirtualizedContainerService.HintSize="515.2,305.2" sap2010:WorkflowViewState.IdRef="ForEach`1_163" Values="[arrContractLines]">
                                                                                                      <ui:ForEach.Body>
                                                                                                        <ActivityAction x:TypeArguments="x:String">
                                                                                                          <ActivityAction.Argument>
                                                                                                            <DelegateInArgument x:TypeArguments="x:String" Name="strContractLine" />
                                                                                                          </ActivityAction.Argument>
                                                                                                          <ui:MultipleAssign DisplayName="Multiple Assign - Shipping Advice Row Items" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_70">
                                                                                                            <ui:MultipleAssign.AssignOperations>
                                                                                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_308">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="x:String">[strIDIContract.Remove(strIDIContract.LastIndexof("-")).ToString.Trim + "-" + strContractLine]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_309">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="s:Object[]">[{strContractSplit.ToUpper.Trim, strIDI.ToUpper.Trim, strBLNo.ToUpper.Trim, strMsgFile}]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_310">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                              </scg:List>
                                                                                                            </ui:MultipleAssign.AssignOperations>
                                                                                                          </ui:MultipleAssign>
                                                                                                        </ActivityAction>
                                                                                                      </ui:ForEach.Body>
                                                                                                    </ui:ForEach>
                                                                                                  </If.Then>
                                                                                                  <If.Else>
                                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign - Shipping Advice Row Items" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_71">
                                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_311">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="x:String">[strIDIContract]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_312">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="s:Object[]">[{strContractSplit.ToUpper.Trim, strIDI.ToUpper.Trim, strBLNo.ToUpper.Trim, strMsgFile}]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_313">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                        </scg:List>
                                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                                    </ui:MultipleAssign>
                                                                                                  </If.Else>
                                                                                                </If>
                                                                                              </Sequence>
                                                                                            </ActivityAction>
                                                                                          </ui:ForEach.Body>
                                                                                        </ui:ForEach>
                                                                                        <ui:Delete ContinueOnError="{x:Null}" ResourceFile="{x:Null}" DisplayName="Delete Attachment" sap:VirtualizedContainerService.HintSize="1136.8,135.6" sap2010:WorkflowViewState.IdRef="Delete_20" Path="[strNewAttachName]" />
                                                                                        <Assign DisplayName="Assign Classification Folder" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_381">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Business Support Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <If Condition="[Not dtIDI Is Nothing]" DisplayName="If Table Already Exists" sap:VirtualizedContainerService.HintSize="1136.8,649.6" sap2010:WorkflowViewState.IdRef="If_232">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Else>
                                                                                            <Sequence DisplayName="Create IDI DataTable" sap:VirtualizedContainerService.HintSize="496,499.2" sap2010:WorkflowViewState.IdRef="Sequence_435">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <Assign DisplayName="Assign Table Name" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_383">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="sd:DataTable">[dtIDI]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="sd:DataTable">[New System.Data.DataTable("3-IDI")]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                              <Assign DisplayName="Assign Headers" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_384">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="s:String[]">[{"BRUCP contract no.", "IDI", "BL number", "File Name"}]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                              <AddToCollection x:TypeArguments="sd:DataTable" Collection="[colTables]" DisplayName="Add DataTable To Collection" sap:VirtualizedContainerService.HintSize="434,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_110" Item="[dtIDI]" />
                                                                                              <ui:CreateDirectory ContinueOnError="{x:Null}" Output="{x:Null}" DisplayName="Create Classification Folder" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_38" Path="[strClassificationFolder]" />
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <Assign DisplayName="Assign Data Table" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_385">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="sd:DataTable">[dtEmails]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="sd:DataTable">[dtIDI]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </Sequence>
                                                                                    </If.Then>
                                                                                  </If>
                                                                                </ActivityAction>
                                                                              </ui:ForEach.Body>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:ForEach>
                                                                          </Sequence>
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                    </sc:BindingList>
                                                                  </ui:IfElseIf.ConditionBlocks>
                                                                </ui:IfElseIf>
                                                              </Sequence>
                                                            </If.Then>
                                                            <If.Else>
                                                              <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email identified as: &quot; + strMsgClassification + &quot;,  but has no attachments.&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_68" />
                                                            </If.Else>
                                                          </If>
                                                        </FlowStep>
                                                        <FlowStep x:Key="PAYMENT W/F" x:Name="__ReferenceID8">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">0,384.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,53.2</av:Size>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If Condition="[bAttachment]" DisplayName="Add Payment WF Information to Table" sap:VirtualizedContainerService.HintSize="200,53.2" sap2010:WorkflowViewState.IdRef="If_243">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Then>
                                                              <Sequence DisplayName="Add Payment WF Information to Table" sap:VirtualizedContainerService.HintSize="1444.8,4840.4" sap2010:WorkflowViewState.IdRef="Sequence_446">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RenameFileX sap2010:Annotation.AnnotationText="File needs to be renamed to exclude spaces as VbScript cannot handle them." DisplayName="Rename File" FilePath="[strMsgPath]" sap:VirtualizedContainerService.HintSize="1382.8,191.2" sap2010:WorkflowViewState.IdRef="RenameFileX_24" KeepExtension="True" NewName="[strMsgPath.Replace(&quot; &quot;,&quot;_&quot;)]">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:RenameFileX>
                                                                <Assign DisplayName="Assign File Path" sap:VirtualizedContainerService.HintSize="1382.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_386">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strMsgPath]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[strMsgPath.Replace(" ","_")]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <lm:VBS___Get_List_of_Attachments StrMsgPath="{x:Null}" DisplayName="VBS - Get List of Attachments (VBS___Get_List_of_Attachments)" sap:VirtualizedContainerService.HintSize="1382.8,81.2" sap2010:WorkflowViewState.IdRef="VBS___Get_List_of_Attachments_3" StrAttachments="[strMsgPath]" />
                                                                <Assign DisplayName="Assign Attachment Type" sap:VirtualizedContainerService.HintSize="1382.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_454">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strAttachType]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">.msg</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <ui:IfElseIf sap2010:Annotation.AnnotationText="Checks if there are either 0 or more than 1 specific type of attachment within the Email and throws if so. If exactly 1, continue with classification." DisplayName="Else If" sap:VirtualizedContainerService.HintSize="1382.8,4134.8" sap2010:WorkflowViewState.IdRef="IfElseIf_7">
                                                                  <ui:IfElseIf.ConditionBlocks>
                                                                    <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                      <ui:IfElseIfBlock BlockType="If" Condition="[Regex.Matches(strAttachments.ToLower,Regex.Escape(strAttachType)).Count = 0]">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email contains no &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; attachments. &quot; + strMsgClassification + &quot; requires one &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; to be attached.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_79" />
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                      <ui:IfElseIfBlock BlockType="ElseIf" Condition="[Regex.Matches(strAttachments.ToLower,Regex.Escape(strAttachType)).Count &gt; 1]">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email contains multiple &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; attachments. &quot; + strMsgClassification + &quot; requires only one &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; to be attached.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_77" />
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                      <ui:IfElseIfBlock BlockType="Else">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Sequence DisplayName="Extract Each Attachment (Payment WF)" sap:VirtualizedContainerService.HintSize="1332,3701.6" sap2010:WorkflowViewState.IdRef="Sequence_445">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <Assign DisplayName="Assign Array of Attachments" sap:VirtualizedContainerService.HintSize="1270,82.4" sap2010:WorkflowViewState.IdRef="Assign_389">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="s:String[]">[arrAttachments]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="s:String[]">[strAttachments.Split(","c).ToArray]</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="1270,3470.8" sap2010:WorkflowViewState.IdRef="ForEach`1_103" Values="[arrAttachments]">
                                                                              <ui:ForEach.Body>
                                                                                <ActivityAction x:TypeArguments="x:String">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="x:String" Name="attachToFind" />
                                                                                  </ActivityAction.Argument>
                                                                                  <If Condition="[attachToFind.ToLower.EndsWith(strAttachType)]" DisplayName="If Attachment Ends with strAttachType" sap:VirtualizedContainerService.HintSize="1234.4,3345.6" sap2010:WorkflowViewState.IdRef="If_254">
                                                                                    <If.Then>
                                                                                      <Sequence DisplayName="Extract Info from Attachment (Payment WF)" sap:VirtualizedContainerService.HintSize="1198.8,3174.8" sap2010:WorkflowViewState.IdRef="Sequence_444">
                                                                                        <Sequence.Variables>
                                                                                          <Variable x:TypeArguments="x:String" Name="strPaymentWF" />
                                                                                        </Sequence.Variables>
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <Assign DisplayName="Assign Attachment Name" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_468">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strNewAttachName]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[strNewFolder + "\" + strMsgPath.Split("\"c).Last.Replace(".msg","") + "-" + DaOpDate.ToString("yyyyMMdd") + strAttachType]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <lm:VBS___Extract_Attachments IntAttachmentToFind="{x:Null}" StrAttachmentToFind="{x:Null}" StrNewAttachmentName="{x:Null}" DisplayName="VBS - Extract Attachments (VBS___Extract_Attachments)" sap:VirtualizedContainerService.HintSize="1136.8,81.2" sap2010:WorkflowViewState.IdRef="VBS___Extract_Attachments_3" StrMsgPath="[strNewAttachName]" />
                                                                                        <ui:InvokeCode ContinueOnError="{x:Null}" Code="Dim outlookApplication As _Application = New Microsoft.Office.Interop.Outlook.Application()&#xA;Dim item As MailItem = CType(outlookApplication.CreateItemFromTemplate(In_MsgFile,Type.Missing),MailItem)&#xA;Try&#xA;&#x9;Out_Body = item.Body.ToString&#xA;Catch ex As System.Exception&#xA;&#x9;Out_Ex = ex&#xA;End Try" DisplayName="Extract Attachment Email Body &amp; Subject" sap:VirtualizedContainerService.HintSize="1136.8,164.8" sap2010:WorkflowViewState.IdRef="InvokeCode_9">
                                                                                          <ui:InvokeCode.Arguments>
                                                                                            <OutArgument x:TypeArguments="s:Exception" x:Key="Out_Ex">[exInvokeCode]</OutArgument>
                                                                                            <InArgument x:TypeArguments="x:String" x:Key="In_MsgFile">[strNewAttachName]</InArgument>
                                                                                            <OutArgument x:TypeArguments="x:String" x:Key="Out_Body">[strAttMsgBody]</OutArgument>
                                                                                          </ui:InvokeCode.Arguments>
                                                                                        </ui:InvokeCode>
                                                                                        <If Condition="[exInvokeCode Is Nothing]" DisplayName="If No Exception" sap:VirtualizedContainerService.HintSize="1136.8,53.2" sap2010:WorkflowViewState.IdRef="If_238">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Else>
                                                                                            <Throw Exception="[exInvokeCode]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_75" />
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <If Condition="[strAttMsgBody.ToUpper.Contains(&quot;PI01&quot;) AndAlso strMsgBody.ToUpper.Contains(&quot;CEK&quot;) AndAlso strMsgBody.ToUpper.Contains(&quot;B/L NO.&quot;)]" DisplayName="If Payment WF Info can be Found" sap:VirtualizedContainerService.HintSize="1136.8,459.2" sap2010:WorkflowViewState.IdRef="If_239">
                                                                                          <If.Then>
                                                                                            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_44">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_212">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">["CEK" + System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_213">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strPaymentWF]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strAttMsgBody," - ".ToCharArray)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_297">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strBLNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"B/L NO.".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                            </ui:MultipleAssign>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Sequence DisplayName="Delete Attachment and Throw Error" sap:VirtualizedContainerService.HintSize="416,308.8" sap2010:WorkflowViewState.IdRef="Sequence_442">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <ui:Delete ContinueOnError="{x:Null}" ResourceFile="{x:Null}" DisplayName="Delete Attachment" sap:VirtualizedContainerService.HintSize="354,135.6" sap2010:WorkflowViewState.IdRef="Delete_21" Path="[strNewAttachName]" />
                                                                                              <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Cannot find required &quot; + strMsgClassification + &quot; information within Email body and attached &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot;.&quot;)]" sap:VirtualizedContainerService.HintSize="354,24.8" sap2010:WorkflowViewState.IdRef="Throw_76" />
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <If Condition="[strContractNo.Trim.EndsWith(&quot;.&quot;)]" DisplayName="If Contract Ends With &quot;.&quot;" sap:VirtualizedContainerService.HintSize="1136.8,53.2" sap2010:WorkflowViewState.IdRef="If_403">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Then>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_616">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[strContractNo.Replace(".","")]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_615">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[strContractNo + System.Text.RegularExpressions.Regex.Split(strMsgBody,System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray)(1)).Last.Split(VbNewLine.ToCharArray)(0).Replace(".","")]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <If Condition="[strContractNo.Trim.EndsWith(&quot;,&quot;)]" DisplayName="If Contract Ends With &quot;,&quot;" sap:VirtualizedContainerService.HintSize="1136.8,53.2" sap2010:WorkflowViewState.IdRef="If_402">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Then>
                                                                                            <ui:MultipleAssign DisplayName="Assign Contract No" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_67">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_298">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractStringManip]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray).Last.Trim).Split(VbNewLine.ToCharArray)(0)]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_299">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(strMsgBody,"REF_NO.".ToCharArray)(1).Replace(":","").Replace(VBNewLine,"").Trim,strContractStringManip)(0).Trim + strContractStringManip)]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                            </ui:MultipleAssign>
                                                                                          </If.Then>
                                                                                        </If>
                                                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract" sap:VirtualizedContainerService.HintSize="1136.8,811.6" sap2010:WorkflowViewState.IdRef="ForEach`1_162" Values="[strContractNo.Split(&quot;,&quot;c)]">
                                                                                          <ui:ForEach.Body>
                                                                                            <ActivityAction x:TypeArguments="x:String">
                                                                                              <ActivityAction.Argument>
                                                                                                <DelegateInArgument x:TypeArguments="x:String" Name="strPurchaseContract" />
                                                                                              </ActivityAction.Argument>
                                                                                              <Sequence DisplayName="Extract Contract Lines" sap:VirtualizedContainerService.HintSize="1101.2,686.4" sap2010:WorkflowViewState.IdRef="Sequence_859">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <Assign DisplayName="Assign Contract Array" sap:VirtualizedContainerService.HintSize="1039.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_617">
                                                                                                  <Assign.To>
                                                                                                    <OutArgument x:TypeArguments="s:String[]">[arrContractLines]</OutArgument>
                                                                                                  </Assign.To>
                                                                                                  <Assign.Value>
                                                                                                    <InArgument x:TypeArguments="s:String[]">[(strPurchaseContract.Split("-"c).Last).Split("/"c)]</InArgument>
                                                                                                  </Assign.Value>
                                                                                                </Assign>
                                                                                                <If Condition="[strPurchaseContract.Contains(&quot;-&quot;)]" DisplayName="If Contract No contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="1039.2,455.6" sap2010:WorkflowViewState.IdRef="If_404">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <If.Then>
                                                                                                    <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract Number" sap:VirtualizedContainerService.HintSize="515.2,305.2" sap2010:WorkflowViewState.IdRef="ForEach`1_161" Values="[arrContractLines]">
                                                                                                      <ui:ForEach.Body>
                                                                                                        <ActivityAction x:TypeArguments="x:String">
                                                                                                          <ActivityAction.Argument>
                                                                                                            <DelegateInArgument x:TypeArguments="x:String" Name="strContractLine" />
                                                                                                          </ActivityAction.Argument>
                                                                                                          <ui:MultipleAssign DisplayName="Multiple Assign - Shipping Advice Row Items" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_68">
                                                                                                            <ui:MultipleAssign.AssignOperations>
                                                                                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_301">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="x:String">[strPurchaseContract.Remove(strPurchaseContract.LastIndexof("-")).ToString.Trim + "-" + strContractLine]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_302">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="s:String[]">[{strContractSplit.ToUpper.Trim, strPaymentWF.ToUpper.Trim, strBLNo.ToUpper.Trim, strMsgFile}]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_303">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                              </scg:List>
                                                                                                            </ui:MultipleAssign.AssignOperations>
                                                                                                          </ui:MultipleAssign>
                                                                                                        </ActivityAction>
                                                                                                      </ui:ForEach.Body>
                                                                                                    </ui:ForEach>
                                                                                                  </If.Then>
                                                                                                  <If.Else>
                                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign - Shipping Advice Row Items" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_69">
                                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_304">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="x:String">[strPurchaseContract]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_305">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="s:Object[]">[{strContractSplit.ToUpper.Trim, strPaymentWF.ToUpper.Trim, strBLNo.ToUpper.Trim, strMsgFile}]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_306">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                        </scg:List>
                                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                                    </ui:MultipleAssign>
                                                                                                  </If.Else>
                                                                                                </If>
                                                                                              </Sequence>
                                                                                            </ActivityAction>
                                                                                          </ui:ForEach.Body>
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </ui:ForEach>
                                                                                        <ui:Delete ContinueOnError="{x:Null}" ResourceFile="{x:Null}" DisplayName="Delete Attachment" sap:VirtualizedContainerService.HintSize="1136.8,53.2" sap2010:WorkflowViewState.IdRef="Delete_22" Path="[strNewAttachName]">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </ui:Delete>
                                                                                        <Assign DisplayName="Assign Classification Folder" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_390">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Business Support Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <If Condition="[Not dtPaymentWF Is Nothing]" DisplayName="If Table Already Exists" sap:VirtualizedContainerService.HintSize="1136.8,649.6" sap2010:WorkflowViewState.IdRef="If_240">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Else>
                                                                                            <Sequence DisplayName="Create Payment WF DataTable" sap:VirtualizedContainerService.HintSize="496,499.2" sap2010:WorkflowViewState.IdRef="Sequence_443">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <Assign DisplayName="Assign Table Name" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_392">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="sd:DataTable">[dtPaymentWF]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="sd:DataTable">[New System.Data.DataTable("3-Payment WF")]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                              <Assign DisplayName="Assign Headers" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_393">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="s:String[]">[{"BRUCP contract no.", "Payment W/F", "BL number", "File Name"}]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                              <AddToCollection x:TypeArguments="sd:DataTable" Collection="[colTables]" DisplayName="Add DataTable To Collection" sap:VirtualizedContainerService.HintSize="434,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_111" Item="[dtPaymentWF]" />
                                                                                              <ui:CreateDirectory ContinueOnError="{x:Null}" Output="{x:Null}" DisplayName="Create Classification Folder" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_39" Path="[strClassificationFolder]" />
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <Assign DisplayName="Assign Data Table" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_394">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="sd:DataTable">[dtEmails]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="sd:DataTable">[dtPaymentWF]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </Sequence>
                                                                                    </If.Then>
                                                                                  </If>
                                                                                </ActivityAction>
                                                                              </ui:ForEach.Body>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:ForEach>
                                                                          </Sequence>
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                    </sc:BindingList>
                                                                  </ui:IfElseIf.ConditionBlocks>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:IfElseIf>
                                                              </Sequence>
                                                            </If.Then>
                                                            <If.Else>
                                                              <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email identified as: &quot; + strMsgClassification + &quot;,  but has no attachments.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_78" />
                                                            </If.Else>
                                                          </If>
                                                        </FlowStep>
                                                        <x:Reference>__ReferenceID8<x:Key>PAYMENT WF</x:Key></x:Reference>
                                                        <FlowStep x:Key="BOOKING ADVICE" x:Name="__ReferenceID10">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">0,117</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,83.6</av:Size>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Sequence DisplayName="Add Booking Advice Information to Table" sap:VirtualizedContainerService.HintSize="200,83.6" sap2010:WorkflowViewState.IdRef="Sequence_448">
                                                            <Sequence.Variables>
                                                              <Variable x:TypeArguments="x:String" Name="strLineSplit" />
                                                              <Variable x:TypeArguments="x:String" Name="strPortDestination" />
                                                              <Variable x:TypeArguments="x:Int32" Name="intLineIndex" />
                                                              <Variable x:TypeArguments="x:Int32" Name="intPOIndex" />
                                                              <Variable x:TypeArguments="x:String" Name="strRevision" />
                                                            </Sequence.Variables>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If Condition="[strMsgFile.ToUpper.Contains(&quot;(REVISE)&quot;)]" DisplayName="If Booking Advise is Revision" sap:VirtualizedContainerService.HintSize="2207,218" sap2010:WorkflowViewState.IdRef="If_314">
                                                              <If.Then>
                                                                <Assign DisplayName="Assign Revision" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_576">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strRevision]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">YES</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Assign DisplayName="Assign Revision as Nothing" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_577">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strRevision]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">
                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                    </InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Else>
                                                            </If>
                                                            <If Condition="[strMsgBody.Contains(&quot;REF NO.&quot;)]" DisplayName="If Booking Advice Info can be Found" sap:VirtualizedContainerService.HintSize="2207,475" sap2010:WorkflowViewState.IdRef="If_245">
                                                              <If.Then>
                                                                <ui:MultipleAssign sap2010:Annotation.AnnotationText="Assign Booking Advice Variables from msg body" DisplayName="Multiple Assign Booking Advice Variables" sap:VirtualizedContainerService.HintSize="431,317" sap2010:WorkflowViewState.IdRef="MultipleAssign_45">
                                                                  <ui:MultipleAssign.AssignOperations>
                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_216">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strLineSplit]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[String.Join("",strMsgBody.Split(Environment.Newline.ToArray()))]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_217">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strPONo]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split((System.Text.RegularExpressions.Regex.Split((strMsgBody.Replace(vbNewLine,"").Replace(" ","").Trim),"SENDER:".ToCharArray).First),"PONO.".ToCharArray).Last.Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_218">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"REF NO.".ToCharArray)(1).Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_219">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strETD]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[DateTime.ParseExact(System.Text.RegularExpressions.Regex.Split(strMsgBody,"ETA-ETD:".ToCharArray)(1).Split(vbNewLine.ToCharArray)(0).Split("-".ToCharArray).Last.Trim,"yyyy/MM/dd",System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_220">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strETA]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[DateTime.ParseExact(System.Text.RegularExpressions.Regex.Split(strMsgBody,"ETA:".ToCharArray)(2).Split(vbNewLine.ToCharArray).First.Trim,"yyyy/MM/dd",System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_221">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strVessel]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Match(strLineSplit.tostring,"(?&lt;=VESSEL:).*(?=VOYAGE NO:)").Value.Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_222">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strPortDestination]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[System.Globalization.CultureInfo.CurrentCulture.TextInfo.ToTitleCase(System.Text.RegularExpressions.Regex.Match(strLineSplit.tostring,"(?&lt;=PLACE OF DELIVERY:).*(?=ETA)").Value.Trim.ToLower())]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                    </scg:List>
                                                                  </ui:MultipleAssign.AssignOperations>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:MultipleAssign>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Cannot find required &quot; + strMsgClassification + &quot; information within Email body.&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_83" />
                                                              </If.Else>
                                                            </If>
                                                            <If Condition="[strPONo.Contains(&quot;REF&quot;)]" DisplayName="If PO Number requires further splitting" sap:VirtualizedContainerService.HintSize="2207,51" sap2010:WorkflowViewState.IdRef="If_313">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <Assign DisplayName="Assign PO No" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_575">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strPONo]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strPONo,"REF".ToCharArray).First]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Then>
                                                            </If>
                                                            <If Condition="[strContractNo.Contains(&quot;,&quot;)]" DisplayName="If Multiple Contract No's" sap:VirtualizedContainerService.HintSize="2207,51" sap2010:WorkflowViewState.IdRef="If_286">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <ui:MultipleAssign DisplayName="Multiple Assign - Multiple Contract Nos" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_54">
                                                                  <ui:MultipleAssign.AssignOperations>
                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_263">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strContractStringManip]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray).Last.Trim).Split(VbNewLine.ToCharArray)(0)]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_264">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(strMsgBody,"REF NO.".ToCharArray)(1).Replace(VBNewLine,"").Trim,strContractStringManip)(0).Trim + strContractStringManip)]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                    </scg:List>
                                                                  </ui:MultipleAssign.AssignOperations>
                                                                </ui:MultipleAssign>
                                                              </If.Then>
                                                            </If>
                                                            <Assign DisplayName="Assign Line Index" sap:VirtualizedContainerService.HintSize="2207,60" sap2010:WorkflowViewState.IdRef="Assign_515">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Int32">[intLineIndex]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Int32">[0]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <Assign DisplayName="Assign PO Index" sap:VirtualizedContainerService.HintSize="2207,60" sap2010:WorkflowViewState.IdRef="Assign_531">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Int32">[intPOIndex]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Purchase Order on BA" sap:VirtualizedContainerService.HintSize="2207,2661" sap2010:WorkflowViewState.IdRef="ForEach`1_124" Values="[strPONo.Split(&quot;,&quot;c)]">
                                                              <ui:ForEach.Body>
                                                                <ActivityAction x:TypeArguments="x:String">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:String" Name="strPOBookingAdvice" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Assign Line Item Variables" sap:VirtualizedContainerService.HintSize="2171,2537" sap2010:WorkflowViewState.IdRef="Sequence_584">
                                                                    <Sequence.Variables>
                                                                      <Variable x:TypeArguments="s:String[]" Name="arrLineItems" />
                                                                      <Variable x:TypeArguments="x:Int32" Name="intContractIndex" />
                                                                    </Sequence.Variables>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If Condition="[strPOBookingAdvice.Contains(&quot;-&quot;)]" DisplayName="If PO Contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="2129,218" sap2010:WorkflowViewState.IdRef="If_290">
                                                                      <If.Then>
                                                                        <Assign DisplayName="Assign Line Item Array" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_510">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="s:String[]">[arrLineItems]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="s:String[]">[(strPOBookingAdvice.Split("-"c).Last).Split("/"c)]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                      </If.Then>
                                                                      <If.Else>
                                                                        <Assign DisplayName="Assign Line Item Array as Nothing" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_526">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="s:String[]">[arrLineItems]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="s:String[]">[{""}]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                      </If.Else>
                                                                    </If>
                                                                    <Assign DisplayName="Assign Contract Index" sap:VirtualizedContainerService.HintSize="2129,60" sap2010:WorkflowViewState.IdRef="Assign_533">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:Int32">[intContractIndex]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <If Condition="[strContractNo.Contains(&quot;,&quot;)]" DisplayName="If Multiple Contract Nos" sap:VirtualizedContainerService.HintSize="2129,1987" sap2010:WorkflowViewState.IdRef="If_298">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <If.Then>
                                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract No" sap:VirtualizedContainerService.HintSize="1099,1829" sap2010:WorkflowViewState.IdRef="ForEach`1_129" Values="[strContractNo.Split(&quot;,&quot;c)]">
                                                                          <ui:ForEach.Body>
                                                                            <ActivityAction x:TypeArguments="x:String">
                                                                              <ActivityAction.Argument>
                                                                                <DelegateInArgument x:TypeArguments="x:String" Name="strContractBookingAdvice" />
                                                                              </ActivityAction.Argument>
                                                                              <Sequence DisplayName="Loop Through Contract Nos" sap:VirtualizedContainerService.HintSize="1063,1705" sap2010:WorkflowViewState.IdRef="Sequence_620">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <Assign DisplayName="Assign Line Index" sap:VirtualizedContainerService.HintSize="1021,60" sap2010:WorkflowViewState.IdRef="Assign_550">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:Int32">[intLineIndex]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                                <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Line Item" sap:VirtualizedContainerService.HintSize="1021,1413" sap2010:WorkflowViewState.IdRef="ForEach`1_130" Values="[arrLineItems]">
                                                                                  <ui:ForEach.Body>
                                                                                    <ActivityAction x:TypeArguments="x:String">
                                                                                      <ActivityAction.Argument>
                                                                                        <DelegateInArgument x:TypeArguments="x:String" Name="strLineNumber" />
                                                                                      </ActivityAction.Argument>
                                                                                      <If Condition="[intPOIndex + intLineIndex = intContractIndex + intLineIndex]" DisplayName="If Correct Contract Number" sap:VirtualizedContainerService.HintSize="985,1289" sap2010:WorkflowViewState.IdRef="If_302">
                                                                                        <If.Then>
                                                                                          <Sequence DisplayName="Assign BA Line Item Values" sap:VirtualizedContainerService.HintSize="949,1102" sap2010:WorkflowViewState.IdRef="Sequence_612">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <If Condition="[strPOBookingAdvice.Contains(&quot;-&quot;) AndAlso (strPOBookingAdvice.Split(&quot;-&quot;c).Last.Length+1) &lt;= 2 OrElse strPOBookingAdvice.Contains(&quot;-&quot;) AndAlso strPOBookingAdvice.Contains(&quot;/&quot;)]" DisplayName="If PO No contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="907,289" sap2010:WorkflowViewState.IdRef="If_303">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <If.Then>
                                                                                                <ui:MultipleAssign DisplayName="Multiple Assign - PO No &amp; Line Item" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_61">
                                                                                                  <ui:MultipleAssign.AssignOperations>
                                                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_277">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[strPONo]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[strPOBookingAdvice.Remove(strPOBookingAdvice.LastIndexof("-")).ToString.Trim]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_278">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[strPOLineNumber]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[strLineNumber]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                    </scg:List>
                                                                                                  </ui:MultipleAssign.AssignOperations>
                                                                                                </ui:MultipleAssign>
                                                                                              </If.Then>
                                                                                              <If.Else>
                                                                                                <ui:MultipleAssign DisplayName="Multiple Assign - PO No &amp; Line Item" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_62">
                                                                                                  <ui:MultipleAssign.AssignOperations>
                                                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_279">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[strPONo]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">[strPOBookingAdvice.Trim]</InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_280">
                                                                                                        <ui:AssignOperation.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[strPOLineNumber]</OutArgument>
                                                                                                        </ui:AssignOperation.To>
                                                                                                        <ui:AssignOperation.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">
                                                                                                            <Literal x:TypeArguments="x:String" Value="" />
                                                                                                          </InArgument>
                                                                                                        </ui:AssignOperation.Value>
                                                                                                      </ui:AssignOperation>
                                                                                                    </scg:List>
                                                                                                  </ui:MultipleAssign.AssignOperations>
                                                                                                </ui:MultipleAssign>
                                                                                              </If.Else>
                                                                                            </If>
                                                                                            <Assign DisplayName="Assign Contract Number Array" sap:VirtualizedContainerService.HintSize="907,60" sap2010:WorkflowViewState.IdRef="Assign_543">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="s:String[]">[arrContractLines]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="s:String[]">[(strContractBookingAdvice.Split("-"c).Last).Split("/"c)]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                            <If Condition="[strContractBookingAdvice.Contains(&quot;-&quot;)]" DisplayName="If Contract No Contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="907,410" sap2010:WorkflowViewState.IdRef="If_299">
                                                                                              <If.Then>
                                                                                                <Sequence DisplayName="Assign Contract No" sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_618">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <Assign DisplayName="Assign - Contract No" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_545">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[strContractBookingAdvice.Remove(strContractBookingAdvice.LastIndexof("-")).ToString.Trim + "-" + arrContractLines(intLineIndex).Trim]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_549">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:Int32">[intLineIndex]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:Int32">[intLineIndex + 1]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </Sequence>
                                                                                              </If.Then>
                                                                                              <If.Else>
                                                                                                <Assign DisplayName="Assign - Contract No" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_546">
                                                                                                  <Assign.To>
                                                                                                    <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                  </Assign.To>
                                                                                                  <Assign.Value>
                                                                                                    <InArgument x:TypeArguments="x:String">[strContractBookingAdvice.Trim]</InArgument>
                                                                                                  </Assign.Value>
                                                                                                </Assign>
                                                                                              </If.Else>
                                                                                            </If>
                                                                                            <ui:MultipleAssign DisplayName="Multiple Assign - Row Items" sap:VirtualizedContainerService.HintSize="907,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_60">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_275">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="s:Object[]">[{strPONo.ToUpper.Trim, strContractSplit.ToUpper.Trim, strETD.ToUpper.Trim, strETA.ToUpper.Trim, strVessel.ToUpper.Trim, strPortDestination.ToUpper.Trim, strPOLineNumber.ToUpper.Trim, strRevision.ToUpper.Trim, daEmailDate, strMsgFile}]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_276">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                            </ui:MultipleAssign>
                                                                                          </Sequence>
                                                                                        </If.Then>
                                                                                      </If>
                                                                                    </ActivityAction>
                                                                                  </ui:ForEach.Body>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                </ui:ForEach>
                                                                                <Assign DisplayName="Assign Contract Index" sap:VirtualizedContainerService.HintSize="1021,60" sap2010:WorkflowViewState.IdRef="Assign_547">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:Int32">[intContractIndex]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:Int32">[intContractIndex + 1]</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </Sequence>
                                                                            </ActivityAction>
                                                                          </ui:ForEach.Body>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:ForEach>
                                                                      </If.Then>
                                                                      <If.Else>
                                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Line Item" sap:VirtualizedContainerService.HintSize="985,1136" sap2010:WorkflowViewState.IdRef="ForEach`1_128" Values="[arrLineItems]">
                                                                          <ui:ForEach.Body>
                                                                            <ActivityAction x:TypeArguments="x:String">
                                                                              <ActivityAction.Argument>
                                                                                <DelegateInArgument x:TypeArguments="x:String" Name="strLineNumber" />
                                                                              </ActivityAction.Argument>
                                                                              <Sequence DisplayName="Assign BA Line Item Values" sap:VirtualizedContainerService.HintSize="949,1012" sap2010:WorkflowViewState.IdRef="Sequence_609">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If Condition="[strPOBookingAdvice.Contains(&quot;-&quot;) AndAlso (strPOBookingAdvice.Split(&quot;-&quot;c).Last.Length+1) &lt;= 2 OrElse strPOBookingAdvice.Contains(&quot;-&quot;) AndAlso strPOBookingAdvice.Contains(&quot;/&quot;)]" DisplayName="If PO No contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="907,289" sap2010:WorkflowViewState.IdRef="If_293">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <If.Then>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign - PO No &amp; Line Item" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_56">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_267">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[strPONo]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[strPOBookingAdvice.Remove(strPOBookingAdvice.LastIndexof("-")).ToString.Trim]</InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_268">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[strPOLineNumber]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[strLineNumber]</InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                    </ui:MultipleAssign>
                                                                                  </If.Then>
                                                                                  <If.Else>
                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign - PO No &amp; Line Item" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_57">
                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_269">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[strPONo]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[strPOBookingAdvice.Trim]</InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_270">
                                                                                            <ui:AssignOperation.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[strPOLineNumber]</OutArgument>
                                                                                            </ui:AssignOperation.To>
                                                                                            <ui:AssignOperation.Value>
                                                                                              <InArgument x:TypeArguments="x:String">
                                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                                              </InArgument>
                                                                                            </ui:AssignOperation.Value>
                                                                                          </ui:AssignOperation>
                                                                                        </scg:List>
                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                    </ui:MultipleAssign>
                                                                                  </If.Else>
                                                                                </If>
                                                                                <Assign DisplayName="Assign Contract Lines" sap:VirtualizedContainerService.HintSize="907,60" sap2010:WorkflowViewState.IdRef="Assign_539">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="s:String[]">[arrContractLines]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="s:String[]">[(strContractNo.Split("-"c).Last).Split("/"c)]</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                                <If Condition="[strContractNo.Contains(&quot;-&quot;)]" DisplayName="If Contract No Contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="907,220" sap2010:WorkflowViewState.IdRef="If_296">
                                                                                  <If.Then>
                                                                                    <Assign DisplayName="Assign - Contract No" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_540">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[strContractNo.Remove(strContractNo.LastIndexof("-")).ToString.Trim + "-" + arrContractLines(intLineIndex).Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Then>
                                                                                  <If.Else>
                                                                                    <Assign DisplayName="Assign - Contract No" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_541">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[strContractNo.Trim]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Else>
                                                                                </If>
                                                                                <ui:MultipleAssign DisplayName="Multiple Assign - Row Items" sap:VirtualizedContainerService.HintSize="907,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_59">
                                                                                  <ui:MultipleAssign.AssignOperations>
                                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_273">
                                                                                        <ui:AssignOperation.To>
                                                                                          <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                        </ui:AssignOperation.To>
                                                                                        <ui:AssignOperation.Value>
                                                                                          <InArgument x:TypeArguments="s:Object[]">[{strPONo.ToUpper.Trim, strContractSplit.ToUpper.Trim, strETD.ToUpper.Trim, strETA.ToUpper.Trim, strVessel.ToUpper.Trim, strPortDestination.ToUpper.Trim, strPOLineNumber.ToUpper.Trim, strRevision.ToUpper.Trim, daEmailDate, strMsgFile}]</InArgument>
                                                                                        </ui:AssignOperation.Value>
                                                                                      </ui:AssignOperation>
                                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_274">
                                                                                        <ui:AssignOperation.To>
                                                                                          <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                        </ui:AssignOperation.To>
                                                                                        <ui:AssignOperation.Value>
                                                                                          <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                        </ui:AssignOperation.Value>
                                                                                      </ui:AssignOperation>
                                                                                    </scg:List>
                                                                                  </ui:MultipleAssign.AssignOperations>
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                </ui:MultipleAssign>
                                                                                <Assign DisplayName="Assign Line Index" sap:VirtualizedContainerService.HintSize="907,60" sap2010:WorkflowViewState.IdRef="Assign_542">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:Int32">[intLineIndex]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:Int32">[intLineIndex + 1]</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </Sequence>
                                                                            </ActivityAction>
                                                                          </ui:ForEach.Body>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:ForEach>
                                                                      </If.Else>
                                                                    </If>
                                                                    <Assign DisplayName="Assign PO Index" sap:VirtualizedContainerService.HintSize="2129,60" sap2010:WorkflowViewState.IdRef="Assign_532">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:Int32">[intPOIndex]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:Int32">[intPOIndex + 1]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:ForEach.Body>
                                                            </ui:ForEach>
                                                            <Assign DisplayName="Assign Classification Folder" sap:VirtualizedContainerService.HintSize="2207,60" sap2010:WorkflowViewState.IdRef="Assign_395">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Booking Advice Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <If Condition="[Not dtBooking Is Nothing]" DisplayName="If Table Already Exists" sap:VirtualizedContainerService.HintSize="2207,591" sap2010:WorkflowViewState.IdRef="If_246">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Else>
                                                                <Sequence DisplayName="Create Booking DataTable" sap:VirtualizedContainerService.HintSize="376,433" sap2010:WorkflowViewState.IdRef="Sequence_447">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign DisplayName="Assign Table Name" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_396">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="sd:DataTable">[dtBooking]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="sd:DataTable">[New System.Data.DataTable("1-Booking Advice")]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <Assign DisplayName="Assign Headers" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_397">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="s:String[]">[{"Customer PO no.", "BRUCP contract no.", "ETD", "ETA", "Vessel name", "Port destination", "Customer PO line number","Revision","Date of Email", "File Name"}]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <AddToCollection x:TypeArguments="sd:DataTable" Collection="[colTables]" DisplayName="Add DataTable To Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_112" Item="[dtBooking]" />
                                                                  <ui:CreateDirectory ContinueOnError="{x:Null}" Output="{x:Null}" DisplayName="Create Classification Folder" sap:VirtualizedContainerService.HintSize="334,79" sap2010:WorkflowViewState.IdRef="CreateDirectory_40" Path="[strClassificationFolder]" />
                                                                </Sequence>
                                                              </If.Else>
                                                            </If>
                                                            <Assign DisplayName="Assign Data Table" sap:VirtualizedContainerService.HintSize="2207,60" sap2010:WorkflowViewState.IdRef="Assign_398">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="sd:DataTable">[dtEmails]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="sd:DataTable">[dtBooking]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </Sequence>
                                                        </FlowStep>
                                                        <FlowStep x:Key="SHIPPING ADVICE" x:Name="__ReferenceID13">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">730,117</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,83.6</av:Size>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Sequence DisplayName="Add Shipping Advice Information to Table" sap:VirtualizedContainerService.HintSize="200,83.6" sap2010:WorkflowViewState.IdRef="Sequence_393">
                                                            <Sequence.Variables>
                                                              <Variable x:TypeArguments="x:Int32" Name="intShipmentCount" />
                                                            </Sequence.Variables>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If Condition="[strMsgBody.Contains(&quot;B/L NO.&quot;)]" DisplayName="If Shipping Advice Info can be Found" sap:VirtualizedContainerService.HintSize="1021,413" sap2010:WorkflowViewState.IdRef="If_247">
                                                              <If.Then>
                                                                <ui:MultipleAssign DisplayName="Multiple Assign - Shipping Advice Info" sap:VirtualizedContainerService.HintSize="431,255" sap2010:WorkflowViewState.IdRef="MultipleAssign_39">
                                                                  <ui:MultipleAssign.AssignOperations>
                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_196">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"REF_NO.".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_197">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strBLNo]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"B/L NO.".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_281">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strVessel]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"VESSEL".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_293">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strQtyKG]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"QUANTITY".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_344">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strETA]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[Datetime.ParseExact((System.Text.RegularExpressions.Regex.Split(strMsgBody.Replace(" ",""),"ETA:".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim),"yyyy/MM/dd",System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_350">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strETD]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[Datetime.ParseExact((System.Text.RegularExpressions.Regex.Split(strMsgBody.Replace(" ",""),"B/LDATE:".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim),"yyyy/MM/dd",System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                    </scg:List>
                                                                  </ui:MultipleAssign.AssignOperations>
                                                                </ui:MultipleAssign>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Cannot find required &quot; + strMsgClassification + &quot; information within Email body.&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_84" />
                                                              </If.Else>
                                                            </If>
                                                            <If Condition="[strContractNo.Contains(&quot;,&quot;)]" DisplayName="If Contract contains &quot;,&quot;" sap:VirtualizedContainerService.HintSize="1021,51" sap2010:WorkflowViewState.IdRef="If_398">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <ui:MultipleAssign DisplayName="Assign Contract No" sap:VirtualizedContainerService.HintSize="431,131" sap2010:WorkflowViewState.IdRef="MultipleAssign_66">
                                                                  <ui:MultipleAssign.AssignOperations>
                                                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_294">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strContractStringManip]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray).Last.Trim).Split(VbNewLine.ToCharArray)(0)]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_295">
                                                                        <ui:AssignOperation.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                        </ui:AssignOperation.To>
                                                                        <ui:AssignOperation.Value>
                                                                          <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(strMsgBody,"REF_NO.".ToCharArray)(1).Replace(":","").Replace(VBNewLine,"").Trim,strContractStringManip)(0).Trim + strContractStringManip)]</InArgument>
                                                                        </ui:AssignOperation.Value>
                                                                      </ui:AssignOperation>
                                                                    </scg:List>
                                                                  </ui:MultipleAssign.AssignOperations>
                                                                </ui:MultipleAssign>
                                                              </If.Then>
                                                            </If>
                                                            <Switch x:TypeArguments="x:String" DisplayName="Switch - Qty/Kg Handling" Expression="[strQtyKG.Split(&quot; &quot;c)(1).ToString]" sap:VirtualizedContainerService.HintSize="1021,138" sap2010:WorkflowViewState.IdRef="Switch`1_8">
                                                              <Switch.Default>
                                                                <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Unknown Unit of Measure on Shipping Advice.&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_102" />
                                                              </Switch.Default>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Assign x:Key="M/T" DisplayName="Assign Qty/KG" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_587">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:String">[strQtyKG]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:String">[(Cdbl(strQtyKG.Split(" "c).First)*1000).ToString]</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                            </Switch>
                                                            <Assign DisplayName="Assign Number of Contracts" sap:VirtualizedContainerService.HintSize="1021,60" sap2010:WorkflowViewState.IdRef="Assign_670">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Int32">[intShipmentCount]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Int32">[strContractNo.Split(","c).Count]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract" sap:VirtualizedContainerService.HintSize="1021,860" sap2010:WorkflowViewState.IdRef="ForEach`1_159" Values="[strContractNo.Split(&quot;,&quot;c)]">
                                                              <ui:ForEach.Body>
                                                                <ActivityAction x:TypeArguments="x:String">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:String" Name="strShippingContract" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Extract Contract Lines" sap:VirtualizedContainerService.HintSize="985,736" sap2010:WorkflowViewState.IdRef="Sequence_848">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <Assign DisplayName="Assign Contract Array" sap:VirtualizedContainerService.HintSize="943,60" sap2010:WorkflowViewState.IdRef="Assign_583">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="s:String[]">[arrContractLines]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="s:String[]">[(strShippingContract.Split("-"c).Last).Split("/"c)]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <Assign DisplayName="Assign Number of Contract Lines" sap:VirtualizedContainerService.HintSize="943,60" sap2010:WorkflowViewState.IdRef="Assign_586">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:Int32">[intShipmentCount]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:Int32">[intShipmentCount + arrContractLines.Count - 1]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <If Condition="[strShippingContract.Contains(&quot;-&quot;)]" DisplayName="If Contract No contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="943,444" sap2010:WorkflowViewState.IdRef="If_334">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <If.Then>
                                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract Number" sap:VirtualizedContainerService.HintSize="467,286" sap2010:WorkflowViewState.IdRef="ForEach`1_145" Values="[arrContractLines]">
                                                                          <ui:ForEach.Body>
                                                                            <ActivityAction x:TypeArguments="x:String">
                                                                              <ActivityAction.Argument>
                                                                                <DelegateInArgument x:TypeArguments="x:String" Name="strContractLine" />
                                                                              </ActivityAction.Argument>
                                                                              <ui:MultipleAssign DisplayName="Multiple Assign - Shipping Advice Row Items" sap:VirtualizedContainerService.HintSize="431,162" sap2010:WorkflowViewState.IdRef="MultipleAssign_63">
                                                                                <ui:MultipleAssign.AssignOperations>
                                                                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_282">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[strShippingContract.Remove(strShippingContract.LastIndexof("-")).ToString.Trim + "-" + strContractLine]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_283">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="s:Object[]">[{strContractSplit.ToUpper.Trim, strBLNo.ToUpper.Trim, strVessel.ToUpper.Trim, strQtyKG.ToUpper.Trim, strETA, strETD, intShipmentCount, daEmailDate, strMsgFile}]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_284">
                                                                                      <ui:AssignOperation.To>
                                                                                        <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                      </ui:AssignOperation.To>
                                                                                      <ui:AssignOperation.Value>
                                                                                        <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                      </ui:AssignOperation.Value>
                                                                                    </ui:AssignOperation>
                                                                                  </scg:List>
                                                                                </ui:MultipleAssign.AssignOperations>
                                                                              </ui:MultipleAssign>
                                                                            </ActivityAction>
                                                                          </ui:ForEach.Body>
                                                                        </ui:ForEach>
                                                                      </If.Then>
                                                                      <If.Else>
                                                                        <ui:MultipleAssign DisplayName="Multiple Assign - Shipping Advice Row Items" sap:VirtualizedContainerService.HintSize="431,162" sap2010:WorkflowViewState.IdRef="MultipleAssign_64">
                                                                          <ui:MultipleAssign.AssignOperations>
                                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_285">
                                                                                <ui:AssignOperation.To>
                                                                                  <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                </ui:AssignOperation.To>
                                                                                <ui:AssignOperation.Value>
                                                                                  <InArgument x:TypeArguments="x:String">[strShippingContract]</InArgument>
                                                                                </ui:AssignOperation.Value>
                                                                              </ui:AssignOperation>
                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_286">
                                                                                <ui:AssignOperation.To>
                                                                                  <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                </ui:AssignOperation.To>
                                                                                <ui:AssignOperation.Value>
                                                                                  <InArgument x:TypeArguments="s:Object[]">[{strContractSplit.ToUpper.Trim, strBLNo.ToUpper.Trim, strVessel.ToUpper.Trim, strQtyKG.ToUpper.Trim, strETA, strETD, intShipmentCount, daEmailDate, strMsgFile}]</InArgument>
                                                                                </ui:AssignOperation.Value>
                                                                              </ui:AssignOperation>
                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_287">
                                                                                <ui:AssignOperation.To>
                                                                                  <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                </ui:AssignOperation.To>
                                                                                <ui:AssignOperation.Value>
                                                                                  <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                </ui:AssignOperation.Value>
                                                                              </ui:AssignOperation>
                                                                            </scg:List>
                                                                          </ui:MultipleAssign.AssignOperations>
                                                                        </ui:MultipleAssign>
                                                                      </If.Else>
                                                                    </If>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:ForEach.Body>
                                                            </ui:ForEach>
                                                            <Assign DisplayName="Assign Classification Folder" sap:VirtualizedContainerService.HintSize="1021,60" sap2010:WorkflowViewState.IdRef="Assign_346">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Shipping Advice Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <If Condition="[Not dtShipping Is Nothing]" DisplayName="If Table Already Exists" sap:VirtualizedContainerService.HintSize="1021,591" sap2010:WorkflowViewState.IdRef="If_204">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Else>
                                                                <Sequence DisplayName="Create Shipping DataTable" sap:VirtualizedContainerService.HintSize="376,433" sap2010:WorkflowViewState.IdRef="Sequence_392">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign DisplayName="Assign Table Name" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_347">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="sd:DataTable">[dtShipping]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="sd:DataTable">[New System.Data.DataTable("2-Shipping Advice")]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <Assign DisplayName="Assign Headers" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_348">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="s:String[]">[{"BRUCP contract no.", "BL number", "Vessel name", "Qty/kg", "ETA", "ETD", "Shipment Count", "Date of Email", "File Name"}]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <AddToCollection x:TypeArguments="sd:DataTable" Collection="[colTables]" DisplayName="Add DataTable To Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_96" Item="[dtShipping]" />
                                                                  <ui:CreateDirectory ContinueOnError="{x:Null}" Output="{x:Null}" DisplayName="Create Classification Folder" sap:VirtualizedContainerService.HintSize="334,79" sap2010:WorkflowViewState.IdRef="CreateDirectory_34" Path="[strClassificationFolder]" />
                                                                </Sequence>
                                                              </If.Else>
                                                            </If>
                                                            <Assign DisplayName="Assign Data Table" sap:VirtualizedContainerService.HintSize="1021,60" sap2010:WorkflowViewState.IdRef="Assign_349">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="sd:DataTable">[dtEmails]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="sd:DataTable">[dtShipping]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </Sequence>
                                                        </FlowStep>
                                                        <x:Reference>__ReferenceID9<x:Key>IMPORT DELIVERY INSTRUCTION</x:Key></x:Reference>
                                                        <FlowStep x:Key="MUGEN INVOICE" x:Name="__ReferenceID14">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">730,254.5</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,53.2</av:Size>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If Condition="[bAttachment]" DisplayName="Add Invoice Information to Table" sap:VirtualizedContainerService.HintSize="200,53.2" sap2010:WorkflowViewState.IdRef="If_210">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Then>
                                                              <Sequence DisplayName="Add Invoice Information to Table" sap:VirtualizedContainerService.HintSize="1444.8,7639.6" sap2010:WorkflowViewState.IdRef="Sequence_401">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RenameFileX sap2010:Annotation.AnnotationText="File needs to be renamed to exclude spaces as VbScript cannot handle them." DisplayName="Rename File" FilePath="[strMsgPath]" sap:VirtualizedContainerService.HintSize="1382.8,191.2" sap2010:WorkflowViewState.IdRef="RenameFileX_20" KeepExtension="True" NewName="[strMsgPath.Replace(&quot; &quot;,&quot;_&quot;)]">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:RenameFileX>
                                                                <Assign DisplayName="Assign File Path" sap:VirtualizedContainerService.HintSize="1382.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_350">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strMsgPath]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[strMsgPath.Replace(" ","_")]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <lm:VBS___Get_List_of_Attachments StrMsgPath="{x:Null}" DisplayName="VBS - Get List of Attachments (VBS___Get_List_of_Attachments)" sap:VirtualizedContainerService.HintSize="1382.8,81.2" sap2010:WorkflowViewState.IdRef="VBS___Get_List_of_Attachments_4" StrAttachments="[strAttachments]" />
                                                                <Assign DisplayName="Assign Attachment Type" sap:VirtualizedContainerService.HintSize="1382.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_456">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strAttachType]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">.pdf</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <ui:IfElseIf sap2010:Annotation.AnnotationText="Checks if there are either 0 or more than 2 specific type of attachment within the Email and throws if so. If exactly 1, continue with classification. If there are 2 of the specific attachment attached but one of them is &quot;SHIPPING DOCS&quot; then continue with classification." DisplayName="Else If - Determine number of relevant attachments" sap:VirtualizedContainerService.HintSize="1382.8,6934" sap2010:WorkflowViewState.IdRef="IfElseIf_10">
                                                                  <ui:IfElseIf.ConditionBlocks>
                                                                    <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                      <ui:IfElseIfBlock BlockType="If" Condition="[Regex.Matches(strAttachments.ToLower,Regex.Escape(strAttachType)).Count = 0]">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email contains no &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; attachments. &quot; + strMsgClassification + &quot; requires one &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; to be attached.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_95" />
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                      <ui:IfElseIfBlock BlockType="ElseIf" Condition="[Regex.Matches(strAttachments.ToLower,Regex.Escape(strAttachType)).Count = 2 AndAlso Not strAttachments.Replace(&quot; &quot;, &quot;_&quot;).ToUpper.Contains(&quot;SHIPPING_DOCS&quot; + strAttachType.ToUpper) AndAlso Not strAttachments.Replace(&quot; &quot;, &quot;_&quot;).ToUpper.Contains(&quot;SHIPPING_DOCUMENTS&quot; + strAttachType.ToUpper)]">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email contains multiple &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; attachments. &quot; + strMsgClassification + &quot; requires only one &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; to be attached. The only exception to this is 'SHIPPING DOCS.pdf'.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_94" />
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                      <ui:IfElseIfBlock BlockType="ElseIf" Condition="[Regex.Matches(strAttachments.ToLower,Regex.Escape(strAttachType)).Count &gt; 2]">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email contains multiple &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; attachments. &quot; + strMsgClassification + &quot; requires only one &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot; to be attached.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_97" />
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                      <ui:IfElseIfBlock BlockType="Else">
                                                                        <ui:IfElseIfBlock.Then>
                                                                          <Sequence DisplayName="Extract Each Attachment (Invoice)" sap:VirtualizedContainerService.HintSize="1332,6339.6" sap2010:WorkflowViewState.IdRef="Sequence_399">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <Assign DisplayName="Assign Array of Attachments" sap:VirtualizedContainerService.HintSize="1270,82.4" sap2010:WorkflowViewState.IdRef="Assign_353">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="s:String[]">[arrAttachments]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="s:String[]">[strAttachments.Split(","c).ToArray]</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="1270,6108.8" sap2010:WorkflowViewState.IdRef="ForEach`1_97" Values="[arrAttachments]">
                                                                              <ui:ForEach.Body>
                                                                                <ActivityAction x:TypeArguments="x:String">
                                                                                  <ActivityAction.Argument>
                                                                                    <DelegateInArgument x:TypeArguments="x:String" Name="attachToFind" />
                                                                                  </ActivityAction.Argument>
                                                                                  <If Condition="[attachToFind.ToLower.EndsWith(strAttachType) AndAlso Not attachToFind.Replace(&quot; &quot;, &quot;_&quot;).ToUpper.Contains(&quot;SHIPPING_DOCS&quot; + strAttachType.ToUpper) AndAlso Not attachToFind.Replace(&quot; &quot;, &quot;_&quot;).ToUpper.Contains(&quot;SHIPPING_DOCUMENTS&quot; + strAttachType.ToUpper)]" DisplayName="If Ends with Attach Type and Is Not Shipping Docs" sap:VirtualizedContainerService.HintSize="1234.4,5983.6" sap2010:WorkflowViewState.IdRef="If_579">
                                                                                    <If.Then>
                                                                                      <Sequence DisplayName="Extract Info from Attachment (Invoice)" sap:VirtualizedContainerService.HintSize="1198.8,5812.8" sap2010:WorkflowViewState.IdRef="Sequence_1109">
                                                                                        <Sequence.Variables>
                                                                                          <Variable x:TypeArguments="x:String" Name="strInvoiceNo" />
                                                                                          <Variable x:TypeArguments="x:String" Name="strDueDate" />
                                                                                          <Variable x:TypeArguments="x:String" Name="strPaymetMethod" />
                                                                                        </Sequence.Variables>
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <Assign DisplayName="Assign Attachment Name" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_681">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strNewAttachName]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[strNewFolder + "\" + strMsgPath.Split("\"c).Last.Replace(".msg","") + "-" + DaOpDate.ToString("yyyyMMdd") + strAttachType]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <lm:VBS___Extract_Attachments IntAttachmentToFind="{x:Null}" StrAttachmentToFind="{x:Null}" StrNewAttachmentName="{x:Null}" DisplayName="VBS - Extract Attachments (VBS___Extract_Attachments)" sap:VirtualizedContainerService.HintSize="1136.8,81.2" sap2010:WorkflowViewState.IdRef="VBS___Extract_Attachments_4" StrMsgPath="[strNewAttachName]" />
                                                                                        <ui:ReadPDFText PreserveFormatting="{x:Null}" DisplayName="Read PDF Text" FileName="[strNewAttachName]" sap:VirtualizedContainerService.HintSize="1136.8,60" sap2010:WorkflowViewState.IdRef="ReadPDFText_11" Range="All" Text="[strExtractedText]" />
                                                                                        <If Condition="[strExtractedText.ToUpper.Contains(&quot;INVOICE NO.&quot;) AndAlso strMsgBody.ToUpper.Contains(&quot;CEK&quot;)]" DisplayName="If MUGEN Invoice Info can be Found" sap:VirtualizedContainerService.HintSize="1136.8,459.2" sap2010:WorkflowViewState.IdRef="If_574">
                                                                                          <If.Then>
                                                                                            <ui:MultipleAssign DisplayName="Multiple Assign - Contract No, Invoice No" sap:VirtualizedContainerService.HintSize="479.6,148.8" sap2010:WorkflowViewState.IdRef="MultipleAssign_79">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_351">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">["CEK" + System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_352">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strInvoiceNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strExtractedText,"Invoice No.:".ToCharArray)(1).Trim.Split(" "c)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                            </ui:MultipleAssign>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Sequence DisplayName="Delete Attachment and Throw Error" sap:VirtualizedContainerService.HintSize="416,308.8" sap2010:WorkflowViewState.IdRef="Sequence_1106">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <ui:Delete ContinueOnError="{x:Null}" ResourceFile="{x:Null}" DisplayName="Delete Attachment" sap:VirtualizedContainerService.HintSize="354,135.6" sap2010:WorkflowViewState.IdRef="Delete_28" Path="[strNewAttachName]" />
                                                                                              <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Cannot find required &quot; + strMsgClassification + &quot; information within Email body and attached &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot;.&quot;)]" sap:VirtualizedContainerService.HintSize="354,24.8" sap2010:WorkflowViewState.IdRef="Throw_105" />
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <If Condition="[strMsgBody.ToUpper.Contains(&quot;B/L NO.&quot;)]" DisplayName="If MUGEN Invoice Info can be Found" sap:VirtualizedContainerService.HintSize="1136.8,268" sap2010:WorkflowViewState.IdRef="If_621">
                                                                                          <If.Then>
                                                                                            <ui:MultipleAssign DisplayName="Multiple Assign - BL No" sap:VirtualizedContainerService.HintSize="479.6,117.6" sap2010:WorkflowViewState.IdRef="MultipleAssign_90">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_395">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strBLNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"B/L NO.".ToCharArray)(1).Replace(":","").Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                            </ui:MultipleAssign>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <ui:MultipleAssign DisplayName="Multiple Assign - BL No" sap:VirtualizedContainerService.HintSize="479.6,117.6" sap2010:WorkflowViewState.IdRef="MultipleAssign_91">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_396">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strBLNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">
                                                                                                        <Literal x:TypeArguments="x:String" Value="" />
                                                                                                      </InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                            </ui:MultipleAssign>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_718">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strExtractedText]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Match(strExtractedText,"(?=INVOICE AMOUNT)([\S\s]*)(?=CARRIER/VESSEL NAME)").Value.Trim]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <ui:IfElseIf DisplayName="Else If" sap:VirtualizedContainerService.HintSize="1136.8,1359.2" sap2010:WorkflowViewState.IdRef="IfElseIf_37">
                                                                                          <ui:IfElseIf.ConditionBlocks>
                                                                                            <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                                                              <ui:IfElseIfBlock BlockType="If" Condition="[strExtractedText.ToUpper.Contains(&quot;DAYS&quot;)]">
                                                                                                <ui:IfElseIfBlock.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_719">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strPaymetMethod]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">DAYS</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </ui:IfElseIfBlock.Then>
                                                                                              </ui:IfElseIfBlock>
                                                                                              <ui:IfElseIfBlock BlockType="ElseIf" Condition="[strExtractedText.ToUpper.Contains(&quot;CASH AGAINST DOCUMENTS&quot;)]">
                                                                                                <ui:IfElseIfBlock.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_720">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strPaymetMethod]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">CASH AGAINST DOCUMENTS</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </ui:IfElseIfBlock.Then>
                                                                                              </ui:IfElseIfBlock>
                                                                                              <ui:IfElseIfBlock BlockType="ElseIf" Condition="[strExtractedText.ToUpper.Contains(&quot;T/T&quot;)]">
                                                                                                <ui:IfElseIfBlock.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_721">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strPaymetMethod]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">T/T</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </ui:IfElseIfBlock.Then>
                                                                                              </ui:IfElseIfBlock>
                                                                                              <ui:IfElseIfBlock BlockType="ElseIf" Condition="[strExtractedText.ToUpper.Contains(&quot;CASH IN ADVANCE&quot;)]">
                                                                                                <ui:IfElseIfBlock.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_722">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strPaymetMethod]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">CASH IN ADVANCE</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </ui:IfElseIfBlock.Then>
                                                                                              </ui:IfElseIfBlock>
                                                                                              <ui:IfElseIfBlock BlockType="ElseIf" Condition="[strExtractedText.ToUpper.Contains(&quot;AT SIGHT&quot;)]">
                                                                                                <ui:IfElseIfBlock.Then>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_723">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strPaymetMethod]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">AT SIGHT</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </ui:IfElseIfBlock.Then>
                                                                                              </ui:IfElseIfBlock>
                                                                                              <ui:IfElseIfBlock BlockType="Else">
                                                                                                <ui:IfElseIfBlock.Then>
                                                                                                  <Sequence DisplayName="Delete Attachment and Throw Error" sap:VirtualizedContainerService.HintSize="416,226.4" sap2010:WorkflowViewState.IdRef="Sequence_1130">
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                    <ui:Delete ContinueOnError="{x:Null}" ResourceFile="{x:Null}" DisplayName="Delete Attachment" sap:VirtualizedContainerService.HintSize="354,53.2" sap2010:WorkflowViewState.IdRef="Delete_31" Path="[strNewAttachName]">
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                    </ui:Delete>
                                                                                                    <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Cannot find required &quot; + strMsgClassification + &quot; information within Email body and attached &quot; + strAttachType.Replace(&quot;.&quot;,&quot;&quot;) + &quot;.&quot;)]" sap:VirtualizedContainerService.HintSize="354,24.8" sap2010:WorkflowViewState.IdRef="Throw_107" />
                                                                                                  </Sequence>
                                                                                                </ui:IfElseIfBlock.Then>
                                                                                              </ui:IfElseIfBlock>
                                                                                            </sc:BindingList>
                                                                                          </ui:IfElseIf.ConditionBlocks>
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </ui:IfElseIf>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_724">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strDueDate]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(strExtractedText.ToUpper,"INVOICE AMOUNT".ToCharArray)(1),strPaymetMethod.ToCharArray)(1).Trim]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <TryCatch DisplayName="Try Catch - IF Date cannot be extracted, try extracting from &quot;T/T&quot; instead" sap:VirtualizedContainerService.HintSize="1136.8,315.6" sap2010:WorkflowViewState.IdRef="TryCatch_88">
                                                                                          <TryCatch.Try>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_725">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[strDueDate]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="x:String" xml:space="preserve">[DateTime.ParseExact(strDueDate.Split(" "c)(0) + " " + strDueDate.Split(" "c)(1) + " " +  strDueDate.Split(" "c)(2), "MMM dd. yyyy", System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </TryCatch.Try>
                                                                                          <TryCatch.Catches>
                                                                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="437.6,22.8" sap2010:WorkflowViewState.IdRef="Catch`1_95">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <ActivityAction x:TypeArguments="s:Exception">
                                                                                                <ActivityAction.Argument>
                                                                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                                                </ActivityAction.Argument>
                                                                                                <Sequence DisplayName="Extract from T/T" sap:VirtualizedContainerService.HintSize="496,289.6" sap2010:WorkflowViewState.IdRef="Sequence_1145">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_734">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strDueDate]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(strExtractedText.ToUpper,"INVOICE AMOUNT".ToCharArray)(1),"T/T".ToCharArray)(1).Trim]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_735">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strDueDate]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String" xml:space="preserve">[DateTime.ParseExact(strDueDate.Split(" "c)(0) + " " + strDueDate.Split(" "c)(1) + " " +  strDueDate.Split(" "c)(2), "MMM dd. yyyy", System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                  </Assign>
                                                                                                </Sequence>
                                                                                              </ActivityAction>
                                                                                            </Catch>
                                                                                          </TryCatch.Catches>
                                                                                        </TryCatch>
                                                                                        <If Condition="[strContractNo.Trim.EndsWith(&quot;.&quot;)]" DisplayName="If Contract Ends With &quot;.&quot;" sap:VirtualizedContainerService.HintSize="1136.8,232.8" sap2010:WorkflowViewState.IdRef="If_575">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Then>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_682">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[strContractNo.Replace(".","")]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_683">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="x:String">[strContractNo + System.Text.RegularExpressions.Regex.Split(strMsgBody,System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray)(1)).Last.Split(VbNewLine.ToCharArray)(0).Replace(".","")]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <If Condition="[strContractNo.Trim.EndsWith(&quot;,&quot;)]" DisplayName="If Contract Ends With &quot;,&quot;" sap:VirtualizedContainerService.HintSize="1136.8,319.6" sap2010:WorkflowViewState.IdRef="If_576">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Then>
                                                                                            <ui:MultipleAssign DisplayName="Assign Contract No" sap:VirtualizedContainerService.HintSize="479.6,148.8" sap2010:WorkflowViewState.IdRef="MultipleAssign_80">
                                                                                              <ui:MultipleAssign.AssignOperations>
                                                                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_356">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractStringManip]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(strMsgBody,"CEK".ToCharArray).Last.Trim).Split(VbNewLine.ToCharArray)(0)]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_357">
                                                                                                    <ui:AssignOperation.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[strContractNo]</OutArgument>
                                                                                                    </ui:AssignOperation.To>
                                                                                                    <ui:AssignOperation.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(strMsgBody,"REF_NO.".ToCharArray)(1).Replace(":","").Replace(VBNewLine,"").Trim,strContractStringManip)(0).Trim + strContractStringManip)]</InArgument>
                                                                                                    </ui:AssignOperation.Value>
                                                                                                  </ui:AssignOperation>
                                                                                                </scg:List>
                                                                                              </ui:MultipleAssign.AssignOperations>
                                                                                            </ui:MultipleAssign>
                                                                                          </If.Then>
                                                                                        </If>
                                                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract" sap:VirtualizedContainerService.HintSize="1136.8,811.6" sap2010:WorkflowViewState.IdRef="ForEach`1_200" Values="[strContractNo.Split(&quot;,&quot;c)]">
                                                                                          <ui:ForEach.Body>
                                                                                            <ActivityAction x:TypeArguments="x:String">
                                                                                              <ActivityAction.Argument>
                                                                                                <DelegateInArgument x:TypeArguments="x:String" Name="strInvoiceContract" />
                                                                                              </ActivityAction.Argument>
                                                                                              <Sequence DisplayName="Extract Contract Lines" sap:VirtualizedContainerService.HintSize="1101.2,686.4" sap2010:WorkflowViewState.IdRef="Sequence_1107">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <Assign DisplayName="Assign Contract Array" sap:VirtualizedContainerService.HintSize="1039.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_684">
                                                                                                  <Assign.To>
                                                                                                    <OutArgument x:TypeArguments="s:String[]">[arrContractLines]</OutArgument>
                                                                                                  </Assign.To>
                                                                                                  <Assign.Value>
                                                                                                    <InArgument x:TypeArguments="s:String[]">[(strInvoiceContract.Split("-"c).Last).Split("/"c)]</InArgument>
                                                                                                  </Assign.Value>
                                                                                                </Assign>
                                                                                                <If Condition="[strInvoiceContract.Contains(&quot;-&quot;)]" DisplayName="If Contract No contains &quot;-&quot;" sap:VirtualizedContainerService.HintSize="1039.2,455.6" sap2010:WorkflowViewState.IdRef="If_577">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <If.Then>
                                                                                                    <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Contract Number" sap:VirtualizedContainerService.HintSize="515.2,305.2" sap2010:WorkflowViewState.IdRef="ForEach`1_199" Values="[arrContractLines]">
                                                                                                      <ui:ForEach.Body>
                                                                                                        <ActivityAction x:TypeArguments="x:String">
                                                                                                          <ActivityAction.Argument>
                                                                                                            <DelegateInArgument x:TypeArguments="x:String" Name="strContractLine" />
                                                                                                          </ActivityAction.Argument>
                                                                                                          <ui:MultipleAssign DisplayName="Multiple Assign - MUGEN Invoice" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_81">
                                                                                                            <ui:MultipleAssign.AssignOperations>
                                                                                                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_358">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="x:String">[strInvoiceContract.Remove(strInvoiceContract.LastIndexof("-")).ToString.Trim + "-" + strContractLine.Trim]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_359">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="s:Object[]">[{strContractSplit.ToUpper.Trim, strInvoiceNo.ToUpper.Trim, strBLNo.ToUpper.Trim, strDueDate, strMsgFile}]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_360">
                                                                                                                  <ui:AssignOperation.To>
                                                                                                                    <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                                                  </ui:AssignOperation.To>
                                                                                                                  <ui:AssignOperation.Value>
                                                                                                                    <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                                                  </ui:AssignOperation.Value>
                                                                                                                </ui:AssignOperation>
                                                                                                              </scg:List>
                                                                                                            </ui:MultipleAssign.AssignOperations>
                                                                                                          </ui:MultipleAssign>
                                                                                                        </ActivityAction>
                                                                                                      </ui:ForEach.Body>
                                                                                                    </ui:ForEach>
                                                                                                  </If.Then>
                                                                                                  <If.Else>
                                                                                                    <ui:MultipleAssign DisplayName="Multiple Assign - MUGEN Invoice Row Items" sap:VirtualizedContainerService.HintSize="479.6,180" sap2010:WorkflowViewState.IdRef="MultipleAssign_82">
                                                                                                      <ui:MultipleAssign.AssignOperations>
                                                                                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_361">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="x:String">[strContractSplit]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="x:String">[strInvoiceContract.Trim]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_362">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="s:Object[]">[{strContractSplit.ToUpper.Trim, strInvoiceNo.ToUpper.Trim, strBLNo.ToUpper.Trim, strDueDate, strMsgFile}]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_363">
                                                                                                            <ui:AssignOperation.To>
                                                                                                              <OutArgument x:TypeArguments="s:Object[][]">[arrTableRows]</OutArgument>
                                                                                                            </ui:AssignOperation.To>
                                                                                                            <ui:AssignOperation.Value>
                                                                                                              <InArgument x:TypeArguments="s:Object[][]">[arrTableRows.Concat({arrRowItems}).ToArray]</InArgument>
                                                                                                            </ui:AssignOperation.Value>
                                                                                                          </ui:AssignOperation>
                                                                                                        </scg:List>
                                                                                                      </ui:MultipleAssign.AssignOperations>
                                                                                                    </ui:MultipleAssign>
                                                                                                  </If.Else>
                                                                                                </If>
                                                                                              </Sequence>
                                                                                            </ActivityAction>
                                                                                          </ui:ForEach.Body>
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </ui:ForEach>
                                                                                        <ui:Delete ContinueOnError="{x:Null}" ResourceFile="{x:Null}" DisplayName="Delete Attachment" sap:VirtualizedContainerService.HintSize="1136.8,135.6" sap2010:WorkflowViewState.IdRef="Delete_29" Path="[strNewAttachName]" />
                                                                                        <Assign DisplayName="Assign Classification Folder" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_685">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Business Support Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                        <If Condition="[Not dtInvoice Is Nothing]" DisplayName="If Table Already Exists" sap:VirtualizedContainerService.HintSize="1136.8,649.6" sap2010:WorkflowViewState.IdRef="If_578">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <If.Else>
                                                                                            <Sequence DisplayName="Create Invoice DataTable" sap:VirtualizedContainerService.HintSize="496,499.2" sap2010:WorkflowViewState.IdRef="Sequence_1108">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <Assign DisplayName="Assign Table Name" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_686">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="sd:DataTable">[dtInvoice]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="sd:DataTable">[New System.Data.DataTable("3-Invoice")]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                              <Assign DisplayName="Assign Headers" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_687">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="s:String[]">[{"BRUCP contract no.", "Invoice no.", "BL number", "Due Date", "File Name"}]</InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                              <AddToCollection x:TypeArguments="sd:DataTable" Collection="[colTables]" DisplayName="Add DataTable To Collection" sap:VirtualizedContainerService.HintSize="434,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_246" Item="[dtInvoice]" />
                                                                                              <ui:CreateDirectory ContinueOnError="{x:Null}" Output="{x:Null}" DisplayName="Create Classification Folder" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_71" Path="[strClassificationFolder]" />
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                        <Assign DisplayName="Assign Data Table" sap:VirtualizedContainerService.HintSize="1136.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_688">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="sd:DataTable">[dtEmails]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="sd:DataTable">[dtInvoice]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </Sequence>
                                                                                    </If.Then>
                                                                                  </If>
                                                                                </ActivityAction>
                                                                              </ui:ForEach.Body>
                                                                            </ui:ForEach>
                                                                          </Sequence>
                                                                        </ui:IfElseIfBlock.Then>
                                                                      </ui:IfElseIfBlock>
                                                                    </sc:BindingList>
                                                                  </ui:IfElseIf.ConditionBlocks>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:IfElseIf>
                                                              </Sequence>
                                                            </If.Then>
                                                            <If.Else>
                                                              <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email identified as: &quot; + strMsgClassification + &quot;,  but has no attachments.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_91" />
                                                            </If.Else>
                                                          </If>
                                                        </FlowStep>
                                                        <x:Reference>__ReferenceID7<x:Key>BACK TO BACK W/F</x:Key></x:Reference>
                                                        <x:Reference>__ReferenceID7<x:Key>BACK TO BACK WF</x:Key></x:Reference>
                                                        <x:Reference>__ReferenceID10<x:Key>BA</x:Key></x:Reference>
                                                        <x:Reference>__ReferenceID7<x:Key>B2B</x:Key></x:Reference>
                                                        <FlowStep x:Key="ODP" x:Name="__ReferenceID11">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">580,517</av:Point>
                                                              <av:Size x:Key="ShapeSize">221.2,83.6</av:Size>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Sequence DisplayName="Add Purchase Order Information to Table" sap:VirtualizedContainerService.HintSize="1744.4,3586" sap2010:WorkflowViewState.IdRef="Sequence_1110">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If Condition="[Not bAttachment]" DisplayName="If  Email Contains Attachment " sap:VirtualizedContainerService.HintSize="1682.4,3474.8" sap2010:WorkflowViewState.IdRef="If_580">
                                                              <If.Then>
                                                                <Sequence DisplayName="Extract Email PO Information" sap:VirtualizedContainerService.HintSize="702.4,3313.2" sap2010:WorkflowViewState.IdRef="Sequence_1111">
                                                                  <Sequence.Variables>
                                                                    <Variable x:TypeArguments="x:String" Name="strUOM" />
                                                                    <Variable x:TypeArguments="x:Int32" Default="0" Name="intSplitIndex" />
                                                                  </Sequence.Variables>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:MultipleAssign DisplayName="Multiple Assign - PO Data" sap:VirtualizedContainerService.HintSize="640.4,242.4" sap2010:WorkflowViewState.IdRef="MultipleAssign_85">
                                                                    <ui:MultipleAssign.AssignOperations>
                                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_372">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:String">[strCustomerName]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"Customer:".ToCharArray)(1).Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_373">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:String">[strIncoterms]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"Incoterms:".ToCharArray)(1).Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_374">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:String">[strFinalDestination]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody,"Final Destination:".ToCharArray)(1).Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_375">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:String">[strUOM]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(strMsgBody.ToUpper,"QUANTITY".ToCharArray)(1).Split(vbNewLine.ToCharArray)(0).Trim]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_380">
                                                                          <ui:AssignOperation.To>
                                                                            <OutArgument x:TypeArguments="x:String">[strPODate]</OutArgument>
                                                                          </ui:AssignOperation.To>
                                                                          <ui:AssignOperation.Value>
                                                                            <InArgument x:TypeArguments="x:String">[Datetime.ParseExact(daEmailDate.ToString,"MM/dd/yyyy hh:mm:ss",System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                                                                          </ui:AssignOperation.Value>
                                                                        </ui:AssignOperation>
                                                                      </scg:List>
                                                                    </ui:MultipleAssign.AssignOperations>
                                                                  </ui:MultipleAssign>
                                                                  <If Condition="[strUOM.Contains(&quot;KILOGRAM&quot;)]" DisplayName="If UOM is Kilogram" sap:VirtualizedContainerService.HintSize="640.4,274.4" sap2010:WorkflowViewState.IdRef="If_581">
                                                                    <If.Then>
                                                                      <Assign DisplayName="Assign UOM" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_690">
                                                                        <Assign.To>
                                                                          <OutArgument x:TypeArguments="x:String">[strUOM]</OutArgument>
                                                                        </Assign.To>
                                                                        <Assign.Value>
                                                                          <InArgument x:TypeArguments="x:String">KG</InArgument>
                                                                        </Assign.Value>
                                                                      </Assign>
                                                                    </If.Then>
                                                                  </If>
                                                                  <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Update Customer Name from Customer List" sap:VirtualizedContainerService.HintSize="640.4,53.2" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_13" InstanceCachePeriod="3000" Visible="False" WorkbookPath="[strCustomerList]">
                                                                    <ui:ExcelApplicationScope.Body>
                                                                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                        </ActivityAction.Argument>
                                                                        <Sequence DisplayName="Get Customer Details from Email Reference" sap:VirtualizedContainerService.HintSize="1590.8,1790.4" sap2010:WorkflowViewState.IdRef="Sequence_1115">
                                                                          <Sequence.Variables>
                                                                            <Variable x:TypeArguments="scg:ICollection(x:String)" Default="[New List(Of String)]" Name="colCustomersOCR" />
                                                                          </Sequence.Variables>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:ExcelReadRange AddHeaders="True" DataTable="[dtCustomers]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="1759.6,60" sap2010:WorkflowViewState.IdRef="ExcelReadRange_10" SheetName="Customers">
                                                                            <ui:ExcelReadRange.Range>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <Literal x:TypeArguments="x:String" Value="" />
                                                                              </InArgument>
                                                                            </ui:ExcelReadRange.Range>
                                                                          </ui:ExcelReadRange>
                                                                          <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtCustomers]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="1759.6,141.2" sap2010:WorkflowViewState.IdRef="ForEachRow_43">
                                                                            <ui:ForEachRow.Body>
                                                                              <ActivityAction x:TypeArguments="sd:DataRow">
                                                                                <ActivityAction.Argument>
                                                                                  <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CustomerRow" />
                                                                                </ActivityAction.Argument>
                                                                                <AddToCollection x:TypeArguments="x:String" Collection="[colCustomersOCR]" DisplayName="Add To OCR Customer Collection" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_247" Item="[System.Text.RegularExpressions.Regex.Replace((CustomerRow(&quot;Extracted Customer Name&quot;).ToString.ToUpper),&quot;[^a-zA-Z0-9-]&quot;,&quot;&quot;)]" />
                                                                              </ActivityAction>
                                                                            </ui:ForEachRow.Body>
                                                                          </ui:ForEachRow>
                                                                          <If Condition="[Not strCustomerName = &quot;&quot;]" DisplayName="If Customer Name not Blank" sap:VirtualizedContainerService.HintSize="1759.6,1383.2" sap2010:WorkflowViewState.IdRef="If_584">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <If.Then>
                                                                              <If Condition="[colCustomersOCR.Contains(System.Text.RegularExpressions.Regex.Replace((strCustomerName.ToUpper),&quot;[^a-zA-Z0-9-]&quot;,&quot;&quot;))]" DisplayName="If List Contains Extracted Customer Name" sap:VirtualizedContainerService.HintSize="1530.8,1260.4" sap2010:WorkflowViewState.IdRef="If_583">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <If.Then>
                                                                                  <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtCustomers]" DisplayName="For Each Row in Customer List DataTable" sap:VirtualizedContainerService.HintSize="990.4,1100" sap2010:WorkflowViewState.IdRef="ForEachRow_44">
                                                                                    <ui:ForEachRow.Body>
                                                                                      <ActivityAction x:TypeArguments="sd:DataRow">
                                                                                        <ActivityAction.Argument>
                                                                                          <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CustomerRow" />
                                                                                        </ActivityAction.Argument>
                                                                                        <If Condition="[System.Text.RegularExpressions.Regex.Replace((CustomerRow(&quot;Extracted Customer Name&quot;).ToString.ToUpper),&quot;[^a-zA-Z0-9-]&quot;,&quot;&quot;) = System.Text.RegularExpressions.Regex.Replace((strCustomerName.ToUpper),&quot;[^a-zA-Z0-9-]&quot;,&quot;&quot;) AndAlso Trim(CustomerRow(&quot;Customer Name&quot;).ToString) &lt;&gt; &quot;&quot; AndAlso Trim(CustomerRow(&quot;ZA Code&quot;).ToString) &lt;&gt; &quot;&quot;]" DisplayName="Get Row Information from Customer List DataTable" sap:VirtualizedContainerService.HintSize="956.4,983.6" sap2010:WorkflowViewState.IdRef="If_582">
                                                                                          <If.Then>
                                                                                            <Sequence DisplayName="Get Customer Details" sap:VirtualizedContainerService.HintSize="416,823.2" sap2010:WorkflowViewState.IdRef="Sequence_1112">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <ui:GetRowItem Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="Customer Name" DisplayName="Get Row Item - Customer Name" sap:VirtualizedContainerService.HintSize="354,190" sap2010:WorkflowViewState.IdRef="GetRowItem_6" Row="[CustomerRow]">
                                                                                                <ui:GetRowItem.Value>
                                                                                                  <OutArgument x:TypeArguments="x:String">[strCustomerName]</OutArgument>
                                                                                                </ui:GetRowItem.Value>
                                                                                              </ui:GetRowItem>
                                                                                              <ui:GetRowItem Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="ZA Code" DisplayName="Get Row Item - ZA Code" sap:VirtualizedContainerService.HintSize="354,190" sap2010:WorkflowViewState.IdRef="GetRowItem_7" Row="[CustomerRow]">
                                                                                                <ui:GetRowItem.Value>
                                                                                                  <OutArgument x:TypeArguments="x:String">[strZACode]</OutArgument>
                                                                                                </ui:GetRowItem.Value>
                                                                                              </ui:GetRowItem>
                                                                                              <ui:GetRowItem Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="Business type" DisplayName="Get Row Item - Business type" sap:VirtualizedContainerService.HintSize="354,190" sap2010:WorkflowViewState.IdRef="GetRowItem_8" Row="[CustomerRow]">
                                                                                                <ui:GetRowItem.Value>
                                                                                                  <OutArgument x:TypeArguments="x:String">[strBizType]</OutArgument>
                                                                                                </ui:GetRowItem.Value>
                                                                                              </ui:GetRowItem>
                                                                                              <ui:Break sap:VirtualizedContainerService.HintSize="354,24.8" sap2010:WorkflowViewState.IdRef="Break_10" />
                                                                                            </Sequence>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Sequence DisplayName="Assign Blank Variables" sap:VirtualizedContainerService.HintSize="496,313.2" sap2010:WorkflowViewState.IdRef="Sequence_1123">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <Assign DisplayName="Assign ZA Code as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_714">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[strZACode]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">
                                                                                                    <Literal x:TypeArguments="x:String" Value="" />
                                                                                                  </InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                              <Assign DisplayName="Assign Business Type as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_715">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[strBizType]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">
                                                                                                    <Literal x:TypeArguments="x:String" Value="" />
                                                                                                  </InArgument>
                                                                                                </Assign.Value>
                                                                                              </Assign>
                                                                                            </Sequence>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                      </ActivityAction>
                                                                                    </ui:ForEachRow.Body>
                                                                                  </ui:ForEachRow>
                                                                                </If.Then>
                                                                                <If.Else>
                                                                                  <Sequence DisplayName="Add New Data to Customer Master List" sap:VirtualizedContainerService.HintSize="496,870.4" sap2010:WorkflowViewState.IdRef="Sequence_1113">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <ui:LogMessage DisplayName="Log Message - New AI-OCR Customer Name" sap:VirtualizedContainerService.HintSize="434,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_223" Level="Warn" Message="[strMsgFile + &quot;: New form of Customer Name '&quot; + strCustomerName + &quot;'  has been found through AI-OCR.&quot;]" />
                                                                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{strCustomerName.ToUpper,&quot;&quot;,&quot;&quot;}]" DataTable="[dtCustomers]" DisplayName="Add New Data Row" sap:VirtualizedContainerService.HintSize="434,190" sap2010:WorkflowViewState.IdRef="AddDataRow_42" />
                                                                                    <ui:ExcelWriteRange AddHeaders="False" DataTable="[dtCustomers]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_5" SheetName="Customers" StartingCell="A2" />
                                                                                    <Assign DisplayName="Assign ZA Code as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_691">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[strZACode]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">
                                                                                          <Literal x:TypeArguments="x:String" Value="" />
                                                                                        </InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <Assign DisplayName="Assign Business Type as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_692">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[strBizType]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">
                                                                                          <Literal x:TypeArguments="x:String" Value="" />
                                                                                        </InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <AddToCollection x:TypeArguments="x:String" Collection="[colNewCustomers]" DisplayName="Add To New Customer Collection" sap:VirtualizedContainerService.HintSize="434,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_248" Item="[strCustomerName]" />
                                                                                  </Sequence>
                                                                                </If.Else>
                                                                              </If>
                                                                            </If.Then>
                                                                            <If.Else>
                                                                              <Sequence DisplayName="Assign Blank Variables" sap:VirtualizedContainerService.HintSize="496,313.2" sap2010:WorkflowViewState.IdRef="Sequence_1114">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <Assign DisplayName="Assign ZA Code as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_693">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[strZACode]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                                <Assign DisplayName="Assign Business Type as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_694">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[strBizType]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </Sequence>
                                                                            </If.Else>
                                                                          </If>
                                                                        </Sequence>
                                                                      </ActivityAction>
                                                                    </ui:ExcelApplicationScope.Body>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:ExcelApplicationScope>
                                                                  <Assign DisplayName="Assign Classification Folder" sap:VirtualizedContainerService.HintSize="640.4,82.4" sap2010:WorkflowViewState.IdRef="Assign_707">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Customer PO Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <If Condition="[Not dtPurchaseOrder is Nothing]" DisplayName="If Table Already Exists" sap:VirtualizedContainerService.HintSize="640.4,1017.2" sap2010:WorkflowViewState.IdRef="If_585">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If.Else>
                                                                      <Sequence DisplayName="Create Purchase Order DataTable" sap:VirtualizedContainerService.HintSize="496,855.6" sap2010:WorkflowViewState.IdRef="Sequence_1116">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <Assign DisplayName="Assign Table Name" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_695">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="sd:DataTable">[dtPurchaseOrder]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="sd:DataTable">[New System.Data.DataTable("0-Customer PO")]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <Assign DisplayName="Assign Headers" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_696">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="s:String[]">[{"Customer name","Customer PO no.","Customer PO line number","PO RECEIPT DATE","Product","Grade","Qty/kg","Customer request delivery date","Incoterms sales","Final destination","ZA code", "File Name", "Business type"}]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Header" sap:VirtualizedContainerService.HintSize="434,316.4" sap2010:WorkflowViewState.IdRef="ForEach`1_201" Values="[arrHeaders]">
                                                                          <ui:ForEach.Body>
                                                                            <ActivityAction x:TypeArguments="x:String">
                                                                              <ActivityAction.Argument>
                                                                                <DelegateInArgument x:TypeArguments="x:String" Name="header" />
                                                                              </ActivityAction.Argument>
                                                                              <ui:AddDataColumn x:TypeArguments="x:Object" AllowDBNull="{x:Null}" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" Unique="{x:Null}" ColumnName="[header]" DataTable="[dtPurchaseOrder]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,190" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_51">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </ui:AddDataColumn>
                                                                            </ActivityAction>
                                                                          </ui:ForEach.Body>
                                                                        </ui:ForEach>
                                                                        <AddToCollection x:TypeArguments="sd:DataTable" Collection="[colTables]" DisplayName="Add To Data Table Collection" sap:VirtualizedContainerService.HintSize="434,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_249" Item="[dtPurchaseOrder]" />
                                                                        <ui:CreateDirectory ContinueOnError="{x:Null}" Output="{x:Null}" DisplayName="Create Classification Folder" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_72" Path="[strClassificationFolder]" />
                                                                      </Sequence>
                                                                    </If.Else>
                                                                  </If>
                                                                  <ui:InterruptibleDoWhile Condition="[intSplitIndex*5 &lt; Split(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(Trim(strMsgBody.Replace(vbNewline+vbNewLine, &quot;|&quot;)),&quot;Delivery Date&quot;.ToCharArray)(1).Replace(&quot; &quot;,&quot;&quot;),&quot;END&quot;.ToCharArray)(0),&quot;|&quot;.ToCharArray).Count-10]" CurrentIndex="[intSplitIndex]" DisplayName="Do While - Loop Each Row" sap:VirtualizedContainerService.HintSize="640.4,1212.8" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_2">
                                                                    <ui:InterruptibleDoWhile.Body>
                                                                      <Sequence DisplayName="Extract PO Lines" sap:VirtualizedContainerService.HintSize="541.6,1044.8" sap2010:WorkflowViewState.IdRef="Sequence_1117">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:MultipleAssign DisplayName="Multiple Assign - Line Data" sap:VirtualizedContainerService.HintSize="479.6,211.2" sap2010:WorkflowViewState.IdRef="MultipleAssign_87">
                                                                          <ui:MultipleAssign.AssignOperations>
                                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_381">
                                                                                <ui:AssignOperation.To>
                                                                                  <OutArgument x:TypeArguments="x:String">[strProduct]</OutArgument>
                                                                                </ui:AssignOperation.To>
                                                                                <ui:AssignOperation.Value>
                                                                                  <InArgument x:TypeArguments="x:String">[Split(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(Trim(strMsgBody.Replace(vbNewline+vbNewLine, "|")),"Delivery Date".ToCharArray)(1).Replace(" ",""),"END".ToCharArray)(0),"|".ToCharArray)(intSplitIndex*5+1).ToUpper]</InArgument>
                                                                                </ui:AssignOperation.Value>
                                                                              </ui:AssignOperation>
                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_382">
                                                                                <ui:AssignOperation.To>
                                                                                  <OutArgument x:TypeArguments="x:String">[strGrade]</OutArgument>
                                                                                </ui:AssignOperation.To>
                                                                                <ui:AssignOperation.Value>
                                                                                  <InArgument x:TypeArguments="x:String">[Split(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(Trim(strMsgBody.Replace(vbNewline+vbNewLine, "|")),"Delivery Date".ToCharArray)(1).Replace(" ",""),"END".ToCharArray)(0),"|".ToCharArray)(intSplitIndex*5+2).ToUpper]</InArgument>
                                                                                </ui:AssignOperation.Value>
                                                                              </ui:AssignOperation>
                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_383">
                                                                                <ui:AssignOperation.To>
                                                                                  <OutArgument x:TypeArguments="x:String">[strQtyKG]</OutArgument>
                                                                                </ui:AssignOperation.To>
                                                                                <ui:AssignOperation.Value>
                                                                                  <InArgument x:TypeArguments="x:String">[Split(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(Trim(strMsgBody.Replace(vbNewline+vbNewLine, "|")),"Delivery Date".ToCharArray)(1).Replace(" ",""),"END".ToCharArray)(0),"|".ToCharArray)(intSplitIndex*5+3)]</InArgument>
                                                                                </ui:AssignOperation.Value>
                                                                              </ui:AssignOperation>
                                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_384">
                                                                                <ui:AssignOperation.To>
                                                                                  <OutArgument x:TypeArguments="x:String">[strReqDelDate]</OutArgument>
                                                                                </ui:AssignOperation.To>
                                                                                <ui:AssignOperation.Value>
                                                                                  <InArgument x:TypeArguments="x:String">[Split(System.Text.RegularExpressions.Regex.Split(System.Text.RegularExpressions.Regex.Split(Trim(strMsgBody.Replace(vbNewline+vbNewLine, "|")),"Delivery Date".ToCharArray)(1).Replace(" ",""),"END".ToCharArray)(0),"|".ToCharArray)(intSplitIndex*5+5).Replace(".","").Replace("/","")]</InArgument>
                                                                                </ui:AssignOperation.Value>
                                                                              </ui:AssignOperation>
                                                                            </scg:List>
                                                                          </ui:MultipleAssign.AssignOperations>
                                                                        </ui:MultipleAssign>
                                                                        <If Condition="[Trim(strProduct) = &quot;-&quot;]" DisplayName="If Blank Product" sap:VirtualizedContainerService.HintSize="479.6,53.2" sap2010:WorkflowViewState.IdRef="If_590">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <If.Then>
                                                                            <Assign DisplayName="Assign Product as Blank" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_702">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="x:String">[strProduct]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="x:String">
                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                </InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                          </If.Then>
                                                                        </If>
                                                                        <If Condition="[Trim(strGrade) = &quot;-&quot;]" DisplayName="If Blank Grade" sap:VirtualizedContainerService.HintSize="479.6,53.2" sap2010:WorkflowViewState.IdRef="If_591">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <If.Then>
                                                                            <Assign DisplayName="Assign Grade as Blank" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_703">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="x:String">[strGrade]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="x:String">
                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                </InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                          </If.Then>
                                                                        </If>
                                                                        <If Condition="[Trim(strQtyKG) = &quot;-&quot;]" DisplayName="If Blank QTY" sap:VirtualizedContainerService.HintSize="479.6,53.2" sap2010:WorkflowViewState.IdRef="If_586">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <If.Then>
                                                                            <Assign DisplayName="Assign QTY as Blank" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_697">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="x:String">[strQtyKG]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="x:String">
                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                </InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                          </If.Then>
                                                                          <If.Else>
                                                                            <If Condition="[strUOM.Contains(&quot;MT&quot;)]" DisplayName="If QTY is MT" sap:VirtualizedContainerService.HintSize="791,408" sap2010:WorkflowViewState.IdRef="If_587">
                                                                              <If.Then>
                                                                                <Assign DisplayName="Assign - Convert MT to KG" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_698">
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">[strQtyKG]</OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">[(Cdbl(strQtyKG)*1000).ToString]</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </If.Then>
                                                                              <If.Else>
                                                                                <If Condition="[Not strUOM.Contains(&quot;KG&quot;)]" DisplayName="If UOM Other Than KG" sap:VirtualizedContainerService.HintSize="484,249" sap2010:WorkflowViewState.IdRef="If_588">
                                                                                  <If.Then>
                                                                                    <Assign DisplayName="Assign QTY Other Than KG" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_699">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[strQtyKG]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[strQtyKG+strUOM]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </If.Then>
                                                                                </If>
                                                                              </If.Else>
                                                                            </If>
                                                                          </If.Else>
                                                                        </If>
                                                                        <If Condition="[Trim(strReqDelDate) = &quot;-&quot;]" DisplayName="If Blank Delivery Date" sap:VirtualizedContainerService.HintSize="479.6,53.2" sap2010:WorkflowViewState.IdRef="If_589">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <If.Then>
                                                                            <Assign DisplayName="Assign Delivery Date as Blank" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_700">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="x:String">[strReqDelDate]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="x:String">
                                                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                                                </InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                          </If.Then>
                                                                          <If.Else>
                                                                            <Assign DisplayName="Assign Delivery Date" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_701">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="x:String">[strReqDelDate]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="x:String">[Datetime.ParseExact(strReqDelDate,"ddMMyyyy",System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                          </If.Else>
                                                                        </If>
                                                                        <Assign DisplayName="Assign Row Items" sap:VirtualizedContainerService.HintSize="479.6,82.4" sap2010:WorkflowViewState.IdRef="Assign_704">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="s:Object[]">[{strCustomerName,"","",strPODate,strProduct,strGrade,strQtyKG,strReqDelDate,strIncoterms,strFinalDestination,strZACode,strMsgFile,strBizType.ToUpper}]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[arrRowItems]" DataTable="[dtPurchaseOrder]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="479.6,190" sap2010:WorkflowViewState.IdRef="AddDataRow_43" />
                                                                      </Sequence>
                                                                    </ui:InterruptibleDoWhile.Body>
                                                                  </ui:InterruptibleDoWhile>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="640.4,82.4" sap2010:WorkflowViewState.IdRef="Assign_706">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="s:String[]">[{}]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                </Sequence>
                                                              </If.Then>
                                                              <If.Else>
                                                                <Sequence DisplayName="Extract Attachments" sap:VirtualizedContainerService.HintSize="935.6,2283.2" sap2010:WorkflowViewState.IdRef="Sequence_1120">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="873.6,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_224" Level="Info" Message="[&quot;Purchase Order Email contains attachments. Extracting pdf Attachments.&quot;]" />
                                                                  <ui:RenameFileX sap2010:Annotation.AnnotationText="File needs to be renamed to exclude spaces as VbScript cannot handle them." DisplayName="Rename File" FilePath="[strMsgPath]" sap:VirtualizedContainerService.HintSize="873.6,191.2" sap2010:WorkflowViewState.IdRef="RenameFileX_25" KeepExtension="True" NewName="[strMsgPath.Replace(&quot; &quot;,&quot;_&quot;).Replace(&quot;'&quot;,&quot;&quot;)]">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:RenameFileX>
                                                                  <Assign DisplayName="Assign File Path" sap:VirtualizedContainerService.HintSize="873.6,82.4" sap2010:WorkflowViewState.IdRef="Assign_708">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:String">[strMsgPath]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">[strMsgPath.Replace(" ","_").Replace("'","")]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <lm:VBS___Get_List_of_Attachments StrMsgPath="{x:Null}" DisplayName="VBS - Get List of Attachments (VBS___Get_List_of_Attachments)" sap:VirtualizedContainerService.HintSize="873.6,81.2" sap2010:WorkflowViewState.IdRef="VBS___Get_List_of_Attachments_5" StrAttachments="[strMsgPath]" />
                                                                  <Assign DisplayName="Assign Attachment Type" sap:VirtualizedContainerService.HintSize="873.6,82.4" sap2010:WorkflowViewState.IdRef="Assign_709">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:String">[strAttachType]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">.pdf</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <If Condition="[strAttachments.ToLower.Contains(strAttachType)]" DisplayName="If List of Attachments Contains Attachment Type" sap:VirtualizedContainerService.HintSize="873.6,1443.2" sap2010:WorkflowViewState.IdRef="If_593">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If.Then>
                                                                      <Sequence DisplayName="Extract Each PDF Attachment" sap:VirtualizedContainerService.HintSize="629.2,1281.6" sap2010:WorkflowViewState.IdRef="Sequence_1119">
                                                                        <Sequence.Variables>
                                                                          <Variable x:TypeArguments="x:Int32" Name="intAttach" />
                                                                        </Sequence.Variables>
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <Assign DisplayName="Assign Array of Attachments" sap:VirtualizedContainerService.HintSize="567.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_710">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="s:String[]">[arrAttachments]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="s:String[]">[strAttachments.Split(","c).ToArray]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <Assign DisplayName="Assign Attachment Iteration" sap:VirtualizedContainerService.HintSize="567.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_711">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="x:Int32">[intAttach]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="x:Int32">1</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Attachment" sap:VirtualizedContainerService.HintSize="567.2,752.8" sap2010:WorkflowViewState.IdRef="ForEach`1_202" Values="[arrAttachments]">
                                                                          <ui:ForEach.Body>
                                                                            <ActivityAction x:TypeArguments="x:String">
                                                                              <ActivityAction.Argument>
                                                                                <DelegateInArgument x:TypeArguments="x:String" Name="attachToFind" />
                                                                              </ActivityAction.Argument>
                                                                              <If Condition="[attachToFind.ToLower.EndsWith(strAttachType)]" DisplayName="If Attachment Ends with strAttachType" sap:VirtualizedContainerService.HintSize="531.6,626.4" sap2010:WorkflowViewState.IdRef="If_592">
                                                                                <If.Then>
                                                                                  <Sequence DisplayName="Extract Attachments" sap:VirtualizedContainerService.HintSize="496,434.4" sap2010:WorkflowViewState.IdRef="Sequence_1118">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <Assign DisplayName="Assign Attachment Name" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_712">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:String">[strNewAttachName]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:String">[strNewFolder + "\" + strMsgPath.Split("\"c).Last.Replace(".msg","") + "-" + DaOpDate.ToString("yyyyMMdd-HHmm") + "-" + intAttach.ToString + strAttachType]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                    <lm:VBS___Extract_Attachments IntAttachmentToFind="{x:Null}" StrAttachmentToFind="{x:Null}" StrNewAttachmentName="{x:Null}" DisplayName="VBS - Extract Attachments (VBS___Extract_Attachments)" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="VBS___Extract_Attachments_5" StrMsgPath="[strNewAttachName]" />
                                                                                    <Assign DisplayName="Assign Attachment Iteration" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_713">
                                                                                      <Assign.To>
                                                                                        <OutArgument x:TypeArguments="x:Int32">[intAttach]</OutArgument>
                                                                                      </Assign.To>
                                                                                      <Assign.Value>
                                                                                        <InArgument x:TypeArguments="x:Int32">[intAttach + 1]</InArgument>
                                                                                      </Assign.Value>
                                                                                    </Assign>
                                                                                  </Sequence>
                                                                                </If.Then>
                                                                              </If>
                                                                            </ActivityAction>
                                                                          </ui:ForEach.Body>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:ForEach>
                                                                        <ui:Delete ResourceFile="{x:Null}" ContinueOnError="False" DisplayName="Delete Email" sap:VirtualizedContainerService.HintSize="567.2,135.6" sap2010:WorkflowViewState.IdRef="Delete_30" Path="[strMsgPath]" />
                                                                      </Sequence>
                                                                    </If.Then>
                                                                    <If.Else>
                                                                      <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;No pdf files were attached to Email for PO extraction.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_106" />
                                                                    </If.Else>
                                                                  </If>
                                                                </Sequence>
                                                              </If.Else>
                                                            </If>
                                                          </Sequence>
                                                        </FlowStep>
                                                        <x:Reference>__ReferenceID11<x:Key>PURCHASE ORDER</x:Key></x:Reference>
                                                        <x:Reference>__ReferenceID11<x:Key>PO'</x:Key></x:Reference>
                                                      </FlowSwitch>
                                                      <x:Reference>__ReferenceID12</x:Reference>
                                                      <x:Reference>__ReferenceID13</x:Reference>
                                                      <x:Reference>__ReferenceID14</x:Reference>
                                                      <x:Reference>__ReferenceID7</x:Reference>
                                                      <x:Reference>__ReferenceID9</x:Reference>
                                                      <x:Reference>__ReferenceID8</x:Reference>
                                                      <x:Reference>__ReferenceID10</x:Reference>
                                                      <x:Reference>__ReferenceID11</x:Reference>
                                                    </Flowchart>
                                                    <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Header" sap:VirtualizedContainerService.HintSize="998,51" sap2010:WorkflowViewState.IdRef="ForEach`1_79" Values="[arrHeaders]">
                                                      <ui:ForEach.Body>
                                                        <ActivityAction x:TypeArguments="x:String">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:String" Name="header" />
                                                          </ActivityAction.Argument>
                                                          <If DisplayName="If Header isn't in Table" sap:VirtualizedContainerService.HintSize="484,351" sap2010:WorkflowViewState.IdRef="If_105">
                                                            <If.Condition>
                                                              <InArgument x:TypeArguments="x:Boolean">
                                                                <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="Not dtEmails.Columns.Contains(header)" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_15" />
                                                              </InArgument>
                                                            </If.Condition>
                                                            <If.Then>
                                                              <ui:AddDataColumn x:TypeArguments="x:Object" AllowDBNull="{x:Null}" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" Unique="{x:Null}" ColumnName="[header]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,185" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_12">
                                                                <ui:AddDataColumn.DataTable>
                                                                  <InArgument x:TypeArguments="sd:DataTable">
                                                                    <mva:VisualBasicValue x:TypeArguments="sd:DataTable" ExpressionText="dtEmails" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_16" />
                                                                  </InArgument>
                                                                </ui:AddDataColumn.DataTable>
                                                              </ui:AddDataColumn>
                                                            </If.Then>
                                                          </If>
                                                        </ActivityAction>
                                                      </ui:ForEach.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ForEach>
                                                    <ui:ForEach x:TypeArguments="s:Object[]" CurrentIndex="{x:Null}" DisplayName="For Each - Add New Data Rows" sap:VirtualizedContainerService.HintSize="998,51" sap2010:WorkflowViewState.IdRef="ForEach`1_142" Values="[arrTableRows]">
                                                      <ui:ForEach.Body>
                                                        <ActivityAction x:TypeArguments="s:Object[]">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="s:Object[]" Name="rowItems" />
                                                          </ActivityAction.Argument>
                                                          <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[rowItems]" DataTable="[dtEmails]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="334,185" sap2010:WorkflowViewState.IdRef="AddDataRow_15">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:AddDataRow>
                                                        </ActivityAction>
                                                      </ui:ForEach.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ForEach>
                                                    <If Condition="[IO.File.Exists(strMsgPath)]" DisplayName="If Msg File Not Deleted" sap:VirtualizedContainerService.HintSize="998,323" sap2010:WorkflowViewState.IdRef="If_594">
                                                      <If.Then>
                                                        <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strClassificationFolder + &quot;\&quot; +strMsgFile]" DisplayName="Move File to Classification Folder" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="MoveFile_19" Path="[strMsgPath]">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:MoveFile>
                                                      </If.Then>
                                                    </If>
                                                    <Assign DisplayName="Assign bClassified as True" sap:VirtualizedContainerService.HintSize="998,60" sap2010:WorkflowViewState.IdRef="Assign_192">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Boolean">[bClassified]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <ui:Break sap:VirtualizedContainerService.HintSize="998,22" sap2010:WorkflowViewState.IdRef="Break_6" />
                                                  </Sequence>
                                                </ui:IfElseIfBlock.Then>
                                              </ui:IfElseIfBlock>
                                              <ui:IfElseIfBlock BlockType="ElseIf" Condition="[intClassification &gt; 1 AndAlso strMsgFile.ToUpper.Contains(strMsgClassification.ToUpper) AndAlso Not strMsgFile.ToUpper.StartsWith(strMsgClassification.ToUpper)]">
                                                <ui:IfElseIfBlock.Then>
                                                  <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Multiple classifications were found within the Email file name: &quot; + String.Join(&quot;, &quot;, colMatches) + &quot;. Please ensure the correct classification is either the only one within the file name, or at the beginning of the file name.&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_96" />
                                                </ui:IfElseIfBlock.Then>
                                              </ui:IfElseIfBlock>
                                            </sc:BindingList>
                                          </ui:IfElseIf.ConditionBlocks>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:IfElseIf>
                                      </ActivityAction>
                                    </ui:ForEach.Body>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:ForEach>
                                  <If DisplayName="If Email Not Classified and has no Attachments" sap:VirtualizedContainerService.HintSize="1127,51" sap2010:WorkflowViewState.IdRef="If_40">
                                    <If.Condition>
                                      <InArgument x:TypeArguments="x:Boolean">
                                        <mva:VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="Not bClassified AndAlso Not bAttachment" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_22" />
                                      </InArgument>
                                    </If.Condition>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Email could not be classified and does not contain attachments for PO extraction.&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_70" />
                                    </If.Then>
                                  </If>
                                  <If sap2010:Annotation.AnnotationText="Extract attachments from msg files" Condition="[bAttachment AndAlso Not bClassified AndAlso Not String.Join(&quot;,&quot;, colBRUCPErrors).Contains(strMsgFile + &quot;:&quot;)]" DisplayName="If Email has Attachments and not Classified" sap:VirtualizedContainerService.HintSize="1127.2,2445.2" sap2010:WorkflowViewState.IdRef="If_58">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence DisplayName="Extract Attachments" sap:VirtualizedContainerService.HintSize="935.6,2243.2" sap2010:WorkflowViewState.IdRef="Sequence_78">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="873.6,88" sap2010:WorkflowViewState.IdRef="LogMessage_67" Message="[&quot;Email contains attachments and has not been classified. Extracting pdf Attachments.&quot;]">
                                          <ui:LogMessage.Level>
                                            <InArgument x:TypeArguments="ui:LogLevel">
                                              <Literal x:TypeArguments="ui:LogLevel" sap2010:WorkflowViewState.IdRef="Literal`1_10" Value="Info" />
                                            </InArgument>
                                          </ui:LogMessage.Level>
                                        </ui:LogMessage>
                                        <ui:RenameFileX sap2010:Annotation.AnnotationText="File needs to be renamed to exclude spaces as VbScript cannot handle them." DisplayName="Rename File" sap:VirtualizedContainerService.HintSize="873.6,191.2" sap2010:WorkflowViewState.IdRef="RenameFileX_2" KeepExtension="True" NewName="[strMsgPath.Replace(&quot; &quot;,&quot;_&quot;)]">
                                          <ui:RenameFileX.FilePath>
                                            <InArgument x:TypeArguments="x:String">
                                              <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strMsgPath" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_26" />
                                            </InArgument>
                                          </ui:RenameFileX.FilePath>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:RenameFileX>
                                        <Assign DisplayName="Assign File Path" sap:VirtualizedContainerService.HintSize="873.6,82.4" sap2010:WorkflowViewState.IdRef="Assign_95">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">
                                              <mva:VisualBasicReference x:TypeArguments="x:String" ExpressionText="strMsgPath" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_26" />
                                            </OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[strMsgPath.Replace(" ","_")]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <lm:VBS___Get_List_of_Attachments StrMsgPath="{x:Null}" DisplayName="VBS - Get List of Attachments (VBS___Get_List_of_Attachments)" sap:VirtualizedContainerService.HintSize="873.6,81.2" sap2010:WorkflowViewState.IdRef="VBS___Get_List_of_Attachments_6" StrAttachments="[strAttachments]" />
                                        <Assign DisplayName="Assign Attachment Type" sap:VirtualizedContainerService.HintSize="873.6,82.4" sap2010:WorkflowViewState.IdRef="Assign_460">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[strAttachType]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">.pdf</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <If Condition="[strAttachments.ToLower.Contains(strAttachType)]" DisplayName="If List of Attachments Contains Attachment Type" sap:VirtualizedContainerService.HintSize="873.6,1409.6" sap2010:WorkflowViewState.IdRef="If_106">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence DisplayName="Extract Each PDF Attachment" sap:VirtualizedContainerService.HintSize="629.2,1259.2" sap2010:WorkflowViewState.IdRef="Sequence_251">
                                              <Sequence.Variables>
                                                <Variable x:TypeArguments="x:Int32" Name="intAttach" />
                                              </Sequence.Variables>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign DisplayName="Assign Array of Attachments" sap:VirtualizedContainerService.HintSize="567.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_465">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="s:String[]">[arrAttachments]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="s:String[]">[strAttachments.Split(","c).ToArray]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <Assign DisplayName="Assign Attachment Iteration" sap:VirtualizedContainerService.HintSize="567.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_464">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[intAttach]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">1</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Attachment" sap:VirtualizedContainerService.HintSize="567.2,730.4" sap2010:WorkflowViewState.IdRef="ForEach`1_109" Values="[arrAttachments]">
                                                <ui:ForEach.Body>
                                                  <ActivityAction x:TypeArguments="x:String">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="x:String" Name="attachToFind" />
                                                    </ActivityAction.Argument>
                                                    <If Condition="[attachToFind.ToLower.EndsWith(strAttachType)]" DisplayName="If Attachment Ends with strAttachType" sap:VirtualizedContainerService.HintSize="531.6,605.2" sap2010:WorkflowViewState.IdRef="If_255">
                                                      <If.Then>
                                                        <Sequence DisplayName="Extract Attachments" sap:VirtualizedContainerService.HintSize="496,434.4" sap2010:WorkflowViewState.IdRef="Sequence_502">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign DisplayName="Assign Attachment Name" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_470">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[strNewAttachName]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[strNewFolder + "\" + strMsgPath.Split("\"c).Last.Replace(".msg","") + "-" + DaOpDate.ToString("yyyyMMdd-HHmm") + "-" + intAttach.ToString + strAttachType]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                          <lm:VBS___Extract_Attachments IntAttachmentToFind="{x:Null}" StrAttachmentToFind="{x:Null}" StrNewAttachmentName="{x:Null}" DisplayName="VBS - Extract Attachments (VBS___Extract_Attachments)" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="VBS___Extract_Attachments_6" StrMsgPath="[strNewAttachName]" />
                                                          <Assign DisplayName="Assign Attachment Iteration" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_466">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:Int32">[intAttach]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:Int32">[intAttach + 1]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </Sequence>
                                                      </If.Then>
                                                    </If>
                                                  </ActivityAction>
                                                </ui:ForEach.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ForEach>
                                              <ui:Delete ResourceFile="{x:Null}" ContinueOnError="False" DisplayName="Delete Email" sap:VirtualizedContainerService.HintSize="567.2,135.6" sap2010:WorkflowViewState.IdRef="Delete_27" Path="[strMsgPath]" />
                                            </Sequence>
                                          </If.Then>
                                          <If.Else>
                                            <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;No pdf files were attached to Email for PO extraction.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_72" />
                                          </If.Else>
                                        </If>
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                  <ui:LogMessage DisplayName="Log message - Component Complete" sap:VirtualizedContainerService.HintSize="1127.2,88" sap2010:WorkflowViewState.IdRef="LogMessage_68" Message="[strComponentRunning + &quot; Complete.&quot;]">
                                    <ui:LogMessage.Level>
                                      <InArgument x:TypeArguments="ui:LogLevel">
                                        <Literal x:TypeArguments="ui:LogLevel" sap2010:WorkflowViewState.IdRef="Literal`1_9" Value="Info" />
                                      </InArgument>
                                    </ui:LogMessage.Level>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:LogMessage>
                                </Sequence>
                              </ui:IfElseIfBlock.Then>
                            </ui:IfElseIfBlock>
                            <ui:IfElseIfBlock BlockType="ElseIf" Condition="[strMsgFile.ToLower.EndsWith(&quot;.pdf&quot;)]">
                              <ui:IfElseIfBlock.Then>
                                <ui:Continue sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Continue_5" />
                              </ui:IfElseIfBlock.Then>
                            </ui:IfElseIfBlock>
                            <ui:IfElseIfBlock BlockType="Else">
                              <ui:IfElseIfBlock.Then>
                                <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;File type (&quot; + strMsgFile.Split(&quot;.&quot;c).Last+ &quot;) is not supported. Please ensure only msg and pdf files are submitted.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_69" />
                              </ui:IfElseIfBlock.Then>
                            </ui:IfElseIfBlock>
                          </sc:BindingList>
                        </ui:IfElseIf.ConditionBlocks>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:IfElseIf>
                    </Sequence>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1305.6,22.8" sap2010:WorkflowViewState.IdRef="Catch`1_49">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <Rethrow sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Rethrow_5" />
                      </ActivityAction>
                    </Catch>
                    <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="1305.6,22.8" sap2010:WorkflowViewState.IdRef="Catch`1_52">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Move to Investigation Folder" sap:VirtualizedContainerService.HintSize="496,580.8" sap2010:WorkflowViewState.IdRef="Sequence_453">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="434,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_163" Level="Warn" Message="[strMsgFile + &quot;: &quot; + exception.Message + &quot; Moving File to Investigation Folder.&quot;]" />
                          <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="AddToCollection - Error" sap:VirtualizedContainerService.HintSize="434,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_113" Item="[&quot;&lt;b&gt;&quot; + strMsgFile + &quot;&lt;/b&gt;: &quot; + exception.Message]" />
                          <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_45" Path="[strInvestigationFolder]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:CreateDirectory>
                          <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + strMsgFile]" DisplayName="Move File - Investigation Folder" sap:VirtualizedContainerService.HintSize="434,162" sap2010:WorkflowViewState.IdRef="MoveFile_63" Path="[strMsgPath]" />
                        </Sequence>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                </TryCatch>
              </ActivityAction>
            </ui:ForEach.Body>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:ForEach>
          <Sequence DisplayName="Process PDF's" sap:VirtualizedContainerService.HintSize="1375.2,5157.2" sap2010:WorkflowViewState.IdRef="Sequence_906">
            <Sequence.Variables>
              <Variable x:TypeArguments="x:String" Name="strQueueRef" />
              <Variable x:TypeArguments="ui:QueueItem" Name="qItem" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each pdf" sap:VirtualizedContainerService.HintSize="1047.6,1745.6" sap2010:WorkflowViewState.IdRef="ForEach`1_174" Values="[IO.Directory.GetFiles(strNewFolder)]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="x:String">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:String" Name="strPDFPath" />
                  </ActivityAction.Argument>
                  <TryCatch DisplayName="Try Catch - Loop through PDFs" sap:VirtualizedContainerService.HintSize="840,1619.2" sap2010:WorkflowViewState.IdRef="TryCatch_69">
                    <TryCatch.Variables>
                      <Variable x:TypeArguments="x:String" Name="strPDFFile" />
                    </TryCatch.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch.Try>
                      <Sequence DisplayName="For Each PDF File" sap:VirtualizedContainerService.HintSize="802.4,1362.4" sap2010:WorkflowViewState.IdRef="Sequence_897">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Assign DisplayName="Assign File Name" sap:VirtualizedContainerService.HintSize="740.4,82.4" sap2010:WorkflowViewState.IdRef="Assign_631">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:String">[strPDFFile]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:String">[strPDFPath.Split("\"c).Last]</InArgument>
                          </Assign.Value>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Assign>
                        <If Condition="[strPDFPath.ToLower.EndsWith(&quot;.pdf&quot;)]" DisplayName="If File is a PDF" sap:VirtualizedContainerService.HintSize="740.4,1131.6" sap2010:WorkflowViewState.IdRef="If_427">
                          <If.Then>
                            <Sequence DisplayName="Add PDF item to Queue" sap:VirtualizedContainerService.HintSize="496,970" sap2010:WorkflowViewState.IdRef="Sequence_896">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_632">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[strPdfFile + ": Add PDF to PO Queue"]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:LogMessage DisplayName="Log message - Component Started" sap:VirtualizedContainerService.HintSize="434,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_201" Level="Info" Message="[strComponentRunning + &quot; Started.&quot;]" />
                              <Assign DisplayName="Assign Queue Ref" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_633">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[strQueueRef]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[Now.ToString("yyyyMMdd-HHmmssff")]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:AddQueueItem ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Add Queue Item" FolderPath="[strOrchFolder]" sap:VirtualizedContainerService.HintSize="434,24.8" sap2010:WorkflowViewState.IdRef="AddQueueItem_7" Priority="Normal" QueueType="[strQueueDU]" Reference="[strQueueRef]">
                                <ui:AddQueueItem.ItemInformation>
                                  <InArgument x:TypeArguments="x:String" x:Key="TargetFile">[strPendingFolder + "\" + strPDFFile]</InArgument>
                                </ui:AddQueueItem.ItemInformation>
                              </ui:AddQueueItem>
                              <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Pending Folder" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_59" Path="[strPendingFolder]" />
                              <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strPendingFolder + &quot;\&quot; + strPdfFile]" DisplayName="Move File - Pending Folder" sap:VirtualizedContainerService.HintSize="434,162" sap2010:WorkflowViewState.IdRef="MoveFile_76" Overwrite="True" Path="[strPDFPath]" />
                              <ui:LogMessage DisplayName="Log message - Component Complete" sap:VirtualizedContainerService.HintSize="434,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_202" Level="Info" Message="[strComponentRunning + &quot; Complete.&quot;]" />
                            </Sequence>
                          </If.Then>
                          <If.Else>
                            <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;File type (&quot; + strPDFFile.Split(&quot;.&quot;c).Last+ &quot;) is not supported. Please ensure only msg and pdf files are submitted.&quot;)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_103" />
                          </If.Else>
                        </If>
                      </Sequence>
                    </TryCatch.Try>
                    <TryCatch.Catches>
                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="806,22.8" sap2010:WorkflowViewState.IdRef="Catch`1_75">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="s:Exception">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                          </ActivityAction.Argument>
                          <Rethrow sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Rethrow_7" />
                        </ActivityAction>
                      </Catch>
                      <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="806,22.8" sap2010:WorkflowViewState.IdRef="Catch`1_76">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="Move to Investigation Folder" sap:VirtualizedContainerService.HintSize="496,580.8" sap2010:WorkflowViewState.IdRef="Sequence_898">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="434,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_203" Level="Warn" Message="[strPDFFile + &quot;: &quot; + exception.Message + &quot; Moving File to Investigation Folder.&quot;]" />
                            <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="AddToCollection - Error" sap:VirtualizedContainerService.HintSize="434,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_178" Item="[&quot;&lt;b&gt;&quot; + strPDFFile + &quot;: &lt;/b&gt;&quot; + exception.Message]" />
                            <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_60" Path="[strInvestigationFolder]" />
                            <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + strPDFFile]" DisplayName="Move File - Investigation Folder" sap:VirtualizedContainerService.HintSize="434,162" sap2010:WorkflowViewState.IdRef="MoveFile_77" Path="[strPDFPath]" />
                          </Sequence>
                        </ActivityAction>
                      </Catch>
                    </TryCatch.Catches>
                  </TryCatch>
                </ActivityAction>
              </ui:ForEach.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:ForEach>
            <ui:GetQueueItem ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Get Transaction Item" FolderPath="[strOrchFolder]" sap:VirtualizedContainerService.HintSize="1047.6,24.8" sap2010:WorkflowViewState.IdRef="GetQueueItem_4" QueueType="[strQueuePODetails]" TransactionItem="[qItem]" />
            <ui:InterruptibleWhile CurrentIndex="{x:Null}" Condition="[qItem IsNot Nothing]" DisplayName="While qItem IsNot Nothing" sap:VirtualizedContainerService.HintSize="1047.6,3195.6" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_11">
              <ui:InterruptibleWhile.Body>
                <TryCatch sap:VirtualizedContainerService.HintSize="1012,3027.6" sap2010:WorkflowViewState.IdRef="TryCatch_70">
                  <TryCatch.Try>
                    <Sequence DisplayName="Assign Variables from Queue Item" sap:VirtualizedContainerService.HintSize="974.4,2794.4" sap2010:WorkflowViewState.IdRef="Sequence_904">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:String" Name="strCurrency" />
                        <Variable x:TypeArguments="x:String" Name="strQueueFile" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="912.4,82.4" sap2010:WorkflowViewState.IdRef="Assign_634">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["Queue Ref " + qItem.Reference + ": Extract Purchase Order Information"]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:LogMessage DisplayName="Log message - Component Started" sap:VirtualizedContainerService.HintSize="912.4,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_204" Level="Info" Message="[strComponentRunning + &quot; Started.&quot;]" />
                      <If Condition="[Not dtPurchaseOrder is Nothing]" DisplayName="If Table Already Exists" sap:VirtualizedContainerService.HintSize="912.4,53.2" sap2010:WorkflowViewState.IdRef="If_428">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Else>
                          <Sequence DisplayName="Create Purchase Order DataTable" sap:VirtualizedContainerService.HintSize="476,662" sap2010:WorkflowViewState.IdRef="Sequence_899">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Assign DisplayName="Assign Table Name" sap:VirtualizedContainerService.HintSize="434,60" sap2010:WorkflowViewState.IdRef="Assign_635">
                              <Assign.To>
                                <OutArgument x:TypeArguments="sd:DataTable">[dtPurchaseOrder]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="sd:DataTable">[New System.Data.DataTable("0-Customer PO")]</InArgument>
                              </Assign.Value>
                            </Assign>
                            <Assign DisplayName="Assign Headers" sap:VirtualizedContainerService.HintSize="434,60" sap2010:WorkflowViewState.IdRef="Assign_636">
                              <Assign.To>
                                <OutArgument x:TypeArguments="s:String[]">[arrHeaders]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="s:String[]">[{"Customer name","Customer PO no.","Customer PO line number","PO RECEIPT DATE","Product","Grade","Qty/kg","Customer request delivery date","Incoterms sales","Final destination","ZA code", "File Name", "Business type"}]</InArgument>
                              </Assign.Value>
                            </Assign>
                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Header" sap:VirtualizedContainerService.HintSize="434,308" sap2010:WorkflowViewState.IdRef="ForEach`1_175" Values="[arrHeaders]">
                              <ui:ForEach.Body>
                                <ActivityAction x:TypeArguments="x:String">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="x:String" Name="header" />
                                  </ActivityAction.Argument>
                                  <ui:AddDataColumn x:TypeArguments="x:Object" AllowDBNull="{x:Null}" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" Unique="{x:Null}" ColumnName="[header]" DataTable="[dtPurchaseOrder]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,185" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_31">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:AddDataColumn>
                                </ActivityAction>
                              </ui:ForEach.Body>
                            </ui:ForEach>
                            <AddToCollection x:TypeArguments="sd:DataTable" Collection="[colTables]" DisplayName="Add To Data Table Collection" sap:VirtualizedContainerService.HintSize="434,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_179" Item="[dtPurchaseOrder]" />
                          </Sequence>
                        </If.Else>
                      </If>
                      <ui:MultipleAssign DisplayName="Multiple Assign - Purchase Order Values" sap:VirtualizedContainerService.HintSize="912.4,367.2" sap2010:WorkflowViewState.IdRef="MultipleAssign_78">
                        <ui:MultipleAssign.AssignOperations>
                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_332">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strCustomerName]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[qItem.SpecificContent("Customer Name").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_333">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strPONo]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[qItem.SpecificContent("PO Number").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_334">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strPOLineNumber]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[qItem.SpecificContent("Line Item").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_336">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strProduct]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[qItem.SpecificContent("Product").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_337">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strGrade]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[qitem.SpecificContent("Grade").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_338">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strQtyKG]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[qitem.SpecificContent("QtyKg").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_340">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strIncoterms]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[qitem.SpecificContent("Incoterms").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_341">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strFinalDestination]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[qitem.SpecificContent("Destination").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_343">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strQueueFile]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[qitem.SpecificContent("FileName").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                          </scg:List>
                        </ui:MultipleAssign.AssignOperations>
                      </ui:MultipleAssign>
                      <If Condition="[Not qItem.SpecificContent(&quot;PO Date&quot;).ToString = &quot;&quot;]" DisplayName="If PO Date not Blank " sap:VirtualizedContainerService.HintSize="912.4,242.8" sap2010:WorkflowViewState.IdRef="If_566">
                        <If.Then>
                          <Assign DisplayName="Assign DateTime PO Date" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_672">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strPODate]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[Datetime.ParseExact(qItem.SpecificContent("PO Date").ToString,"yyyy-MM-dd",System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </If.Then>
                        <If.Else>
                          <Assign DisplayName="Assign PO Date as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_673">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strPODate]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" Value="" />
                              </InArgument>
                            </Assign.Value>
                          </Assign>
                        </If.Else>
                      </If>
                      <If Condition="[Not qItem.SpecificContent(&quot;Delivery Date&quot;).ToString = &quot;&quot;]" DisplayName="If Req Del Date not Blank" sap:VirtualizedContainerService.HintSize="912.4,242.8" sap2010:WorkflowViewState.IdRef="If_565">
                        <If.Then>
                          <Assign DisplayName="Assign DateTime Req Del Date" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_675">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strReqDelDate]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[Datetime.ParseExact(qitem.SpecificContent("Delivery Date").ToString,"yyyy-MM-dd",System.Globalization.CultureInfo.InvariantCulture).ToString("dd-MMM-yyyy")]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </If.Then>
                        <If.Else>
                          <Assign DisplayName="Assign Req Del Date as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_674">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strReqDelDate]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" Value="" />
                              </InArgument>
                            </Assign.Value>
                          </Assign>
                        </If.Else>
                      </If>
                      <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Update Customer Name from Customer List" sap:VirtualizedContainerService.HintSize="912.4,53.2" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_11" InstanceCachePeriod="3000" Visible="False" WorkbookPath="[strCustomerList]">
                        <ui:ExcelApplicationScope.Body>
                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Get Customer Details from AI-OCR Reference" sap:VirtualizedContainerService.HintSize="1590.8,1758.4" sap2010:WorkflowViewState.IdRef="Sequence_903">
                              <Sequence.Variables>
                                <Variable x:TypeArguments="scg:ICollection(x:String)" Default="[New List(Of String)]" Name="colCustomersOCR" />
                              </Sequence.Variables>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtCustomers]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="1528.8,60" sap2010:WorkflowViewState.IdRef="ExcelReadRange_9" SheetName="Customers">
                                <ui:ExcelReadRange.Range>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" Value="" />
                                  </InArgument>
                                </ui:ExcelReadRange.Range>
                              </ui:ExcelReadRange>
                              <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtCustomers]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="1528.8,141.2" sap2010:WorkflowViewState.IdRef="ForEachRow_35">
                                <ui:ForEachRow.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CustomerRow" />
                                    </ActivityAction.Argument>
                                    <AddToCollection x:TypeArguments="x:String" Collection="[colCustomersOCR]" DisplayName="Add To OCR Customer Collection" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_180" Item="[System.Text.RegularExpressions.Regex.Replace((CustomerRow(&quot;Extracted Customer Name&quot;).ToString.ToUpper),&quot;[^a-zA-Z0-9-]&quot;,&quot;&quot;)]" />
                                  </ActivityAction>
                                </ui:ForEachRow.Body>
                              </ui:ForEachRow>
                              <If Condition="[Not strCustomerName = &quot;&quot;]" DisplayName="If Customer Name not Blank" sap:VirtualizedContainerService.HintSize="1528.8,1346.4" sap2010:WorkflowViewState.IdRef="If_560">
                                <If.Then>
                                  <If Condition="[colCustomersOCR.Contains(System.Text.RegularExpressions.Regex.Replace((strCustomerName.ToUpper),&quot;[^a-zA-Z0-9-]&quot;,&quot;&quot;))]" DisplayName="If List Contains Extracted Customer Name" sap:VirtualizedContainerService.HintSize="1410.8,1260.4" sap2010:WorkflowViewState.IdRef="If_430">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtCustomers]" DisplayName="For Each Row in Customer List DataTable" sap:VirtualizedContainerService.HintSize="990.4,1100" sap2010:WorkflowViewState.IdRef="ForEachRow_36">
                                        <ui:ForEachRow.Body>
                                          <ActivityAction x:TypeArguments="sd:DataRow">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CustomerRow" />
                                            </ActivityAction.Argument>
                                            <If Condition="[System.Text.RegularExpressions.Regex.Replace((CustomerRow(&quot;Extracted Customer Name&quot;).ToString.ToUpper),&quot;[^a-zA-Z0-9-]&quot;,&quot;&quot;) = System.Text.RegularExpressions.Regex.Replace((strCustomerName.ToUpper),&quot;[^a-zA-Z0-9-]&quot;,&quot;&quot;) AndAlso Trim(CustomerRow(&quot;Customer Name&quot;).ToString) &lt;&gt; &quot;&quot; AndAlso Trim(CustomerRow(&quot;ZA Code&quot;).ToString) &lt;&gt; &quot;&quot;]" DisplayName="Get Row Information from Customer List DataTable" sap:VirtualizedContainerService.HintSize="956.4,983.6" sap2010:WorkflowViewState.IdRef="If_429">
                                              <If.Then>
                                                <Sequence DisplayName="Get Customer Details" sap:VirtualizedContainerService.HintSize="416,823.2" sap2010:WorkflowViewState.IdRef="Sequence_900">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:GetRowItem Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="Customer Name" DisplayName="Get Row Item - Customer Name" sap:VirtualizedContainerService.HintSize="354,190" sap2010:WorkflowViewState.IdRef="GetRowItem_3" Row="[CustomerRow]">
                                                    <ui:GetRowItem.Value>
                                                      <OutArgument x:TypeArguments="x:String">[strCustomerName]</OutArgument>
                                                    </ui:GetRowItem.Value>
                                                  </ui:GetRowItem>
                                                  <ui:GetRowItem Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="ZA Code" DisplayName="Get Row Item - ZA Code" sap:VirtualizedContainerService.HintSize="354,190" sap2010:WorkflowViewState.IdRef="GetRowItem_4" Row="[CustomerRow]">
                                                    <ui:GetRowItem.Value>
                                                      <OutArgument x:TypeArguments="x:String">[strZACode]</OutArgument>
                                                    </ui:GetRowItem.Value>
                                                  </ui:GetRowItem>
                                                  <ui:GetRowItem Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="Business type" DisplayName="Get Row Item - Business type" sap:VirtualizedContainerService.HintSize="354,190" sap2010:WorkflowViewState.IdRef="GetRowItem_5" Row="[CustomerRow]">
                                                    <ui:GetRowItem.Value>
                                                      <OutArgument x:TypeArguments="x:String">[strBizType]</OutArgument>
                                                    </ui:GetRowItem.Value>
                                                  </ui:GetRowItem>
                                                  <ui:Break sap:VirtualizedContainerService.HintSize="354,24.8" sap2010:WorkflowViewState.IdRef="Break_8" />
                                                </Sequence>
                                              </If.Then>
                                              <If.Else>
                                                <Sequence DisplayName="Assign Blank Variables" sap:VirtualizedContainerService.HintSize="496,313.2" sap2010:WorkflowViewState.IdRef="Sequence_1124">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Assign DisplayName="Assign ZA Code as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_716">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[strZACode]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <Literal x:TypeArguments="x:String" Value="" />
                                                      </InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <Assign DisplayName="Assign Business Type as Blank" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_717">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[strBizType]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">
                                                        <Literal x:TypeArguments="x:String" Value="" />
                                                      </InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                </Sequence>
                                              </If.Else>
                                            </If>
                                          </ActivityAction>
                                        </ui:ForEachRow.Body>
                                      </ui:ForEachRow>
                                    </If.Then>
                                    <If.Else>
                                      <Sequence DisplayName="Add New Data to Customer Master List" sap:VirtualizedContainerService.HintSize="376,797" sap2010:WorkflowViewState.IdRef="Sequence_902">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:LogMessage DisplayName="Log Message - New AI-OCR Customer Name" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_222" Level="Warn" Message="[strQueueFile + &quot;: New form of Customer Name '&quot; + strCustomerName + &quot;'  has been found through AI-OCR.&quot;]" />
                                        <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{strCustomerName.ToUpper,&quot;&quot;,&quot;&quot;}]" DataTable="[dtCustomers]" DisplayName="Add New Data Row" sap:VirtualizedContainerService.HintSize="334,185" sap2010:WorkflowViewState.IdRef="AddDataRow_21" />
                                        <ui:ExcelWriteRange AddHeaders="False" DataTable="[dtCustomers]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_3" SheetName="Customers" StartingCell="A2" />
                                        <Assign DisplayName="Assign ZA Code as Blank" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_658">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[strZACode]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign DisplayName="Assign Business Type as Blank" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_677">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[strBizType]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">
                                              <Literal x:TypeArguments="x:String" Value="" />
                                            </InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <AddToCollection x:TypeArguments="x:String" Collection="[colNewCustomers]" DisplayName="Add To New Customer Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_181" Item="[strCustomerName]" />
                                      </Sequence>
                                    </If.Else>
                                  </If>
                                </If.Then>
                                <If.Else>
                                  <Sequence DisplayName="Assign Blank Variables" sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_1103">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign DisplayName="Assign ZA Code as Blank" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_671">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[strZACode]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign DisplayName="Assign Business Type as Blank" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_678">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[strBizType]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </Sequence>
                                </If.Else>
                              </If>
                            </Sequence>
                          </ActivityAction>
                        </ui:ExcelApplicationScope.Body>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ExcelApplicationScope>
                      <Assign DisplayName="Assign Row Information" sap:VirtualizedContainerService.HintSize="912.4,82.4" sap2010:WorkflowViewState.IdRef="Assign_637">
                        <Assign.To>
                          <OutArgument x:TypeArguments="s:Object[]">[arrRowItems]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="s:Object[]">[{strCustomerName, strPONo, strPOLineNumber, strPODate, strProduct, strGrade, strQtyKG, strReqDelDate, strIncoterms, strFinalDestination, strZACode, strQueueFile, strBizType.ToUpper}]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[arrRowItems]" DataTable="[dtPurchaseOrder]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="912.4,190" sap2010:WorkflowViewState.IdRef="AddDataRow_22" />
                      <ui:SetTransactionStatus ContinueOnError="{x:Null}" Reason="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Set Transaction Status" ErrorType="Business" FolderPath="[strOrchFolder]" sap:VirtualizedContainerService.HintSize="912.4,81.2" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_4" Status="Successful" TransactionItem="[qItem]">
                        <ui:SetTransactionStatus.Analytics>
                          <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                        </ui:SetTransactionStatus.Analytics>
                        <ui:SetTransactionStatus.Output>
                          <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                        </ui:SetTransactionStatus.Output>
                      </ui:SetTransactionStatus>
                      <Assign DisplayName="Assign Classification Folder" sap:VirtualizedContainerService.HintSize="912.4,82.4" sap2010:WorkflowViewState.IdRef="Assign_638">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Customer PO Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Classification Folder" sap:VirtualizedContainerService.HintSize="912.4,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_61" Path="[strClassificationFolder]" />
                      <If Condition="[IO.File.Exists(strClassificationFolder+ &quot;\&quot; + strQueueFile)]" DisplayName="If Queue File Has Been Moved" sap:VirtualizedContainerService.HintSize="912.4,322.4" sap2010:WorkflowViewState.IdRef="If_431">
                        <If.Else>
                          <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strClassificationFolder + &quot;\&quot; + strQueueFile]" DisplayName="Move File From Pending to Complete" sap:VirtualizedContainerService.HintSize="334,162" sap2010:WorkflowViewState.IdRef="MoveFile_78" Path="[strPendingFolder + &quot;\&quot; + strQueueFile]" />
                        </If.Else>
                      </If>
                      <ui:LogMessage DisplayName="Log message - Component Complete" sap:VirtualizedContainerService.HintSize="912.4,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_205" Level="Info" Message="[strComponentRunning + &quot; Complete.&quot;]" />
                      <ui:GetQueueItem ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Get next Transaction Item" DisplayName="Get Transaction Item" FolderPath="[strOrchFolder]" sap:VirtualizedContainerService.HintSize="912.4,56" sap2010:WorkflowViewState.IdRef="GetQueueItem_5" QueueType="[strQueuePODetails]" TransactionItem="[qItem]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:GetQueueItem>
                    </Sequence>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="978,22.8" sap2010:WorkflowViewState.IdRef="Catch`1_77">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Error Handling" sap:VirtualizedContainerService.HintSize="416,507.6" sap2010:WorkflowViewState.IdRef="Sequence_905">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log Message - Queue Error" sap:VirtualizedContainerService.HintSize="354,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_206" Level="Warn" Message="[&quot;Error extracting queue information: &quot; + qItem.Reference + &quot; &quot; + exception.Message]" />
                          <ui:SetTransactionStatus ContinueOnError="{x:Null}" ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="If there's an erorr, set queue item as Failed" DisplayName="Set Transaction Status" ErrorType="Application" FolderPath="[strOrchFolder]" sap:VirtualizedContainerService.HintSize="354,112.4" sap2010:WorkflowViewState.IdRef="SetTransactionStatus_5" Reason="[exception.Message]" Status="Failed" TransactionItem="[qItem]">
                            <ui:SetTransactionStatus.Analytics>
                              <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                            </ui:SetTransactionStatus.Analytics>
                            <ui:SetTransactionStatus.Output>
                              <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                            </ui:SetTransactionStatus.Output>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:SetTransactionStatus>
                          <AddToCollection x:TypeArguments="x:String" Collection="[colQueueErrors]" DisplayName="Add To Queue Error Collection" sap:VirtualizedContainerService.HintSize="354,24.8" sap2010:WorkflowViewState.IdRef="AddToCollection`1_182" Item="[qItem.Reference]" />
                          <ui:GetQueueItem ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Get next Transaction Item" DisplayName="Get Transaction Item" FolderPath="[strOrchFolder]" sap:VirtualizedContainerService.HintSize="354,56" sap2010:WorkflowViewState.IdRef="GetQueueItem_6" QueueType="[strQueuePODetails]" TransactionItem="[qItem]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:GetQueueItem>
                        </Sequence>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                </TryCatch>
              </ui:InterruptibleWhile.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:InterruptibleWhile>
          </Sequence>
          <ui:LogMessage DisplayName="Log message - Component Complete" sap:VirtualizedContainerService.HintSize="1375.2,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_162" Level="Info" Message="[&quot;Extract New File Data Complete.&quot;]" />
        </Sequence>
        <TryCatch DisplayName="Try Catch - Format Data" sap:VirtualizedContainerService.HintSize="1437.2,3675.2" sap2010:WorkflowViewState.IdRef="TryCatch_49">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <TryCatch.Try>
            <Sequence DisplayName="Format Data" sap:VirtualizedContainerService.HintSize="637.2,3444" sap2010:WorkflowViewState.IdRef="Sequence_80">
              <Sequence.Variables>
                <Variable x:TypeArguments="sd:DataTable" Name="dtMaster" />
                <Variable x:TypeArguments="x:String" Name="strSheetName" />
                <Variable x:TypeArguments="x:Int32" Name="intMaxRows" />
                <Variable x:TypeArguments="x:Int32" Name="intMaxColumns" />
                <Variable x:TypeArguments="x:String" Name="strLookupCustomer" />
                <Variable x:TypeArguments="x:Int32" Name="intTableIndex" />
                <Variable x:TypeArguments="x:Boolean" Name="bColMatch" />
                <Variable x:TypeArguments="scg:ICollection(sd:DataRow)" Default="[New List(Of DataRow)]" Name="colDataRowsMaster" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="575.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_99">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:String">
                    <mva:VisualBasicReference x:TypeArguments="x:String" ExpressionText="strComponentRunning" sap2010:WorkflowViewState.IdRef="VisualBasicReference`1_17" />
                  </OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:String">["Format Data"]</InArgument>
                </Assign.Value>
              </Assign>
              <ui:LogMessage DisplayName="Log Message - Component Started" sap:VirtualizedContainerService.HintSize="575,51" sap2010:WorkflowViewState.IdRef="LogMessage_65" Message="[StrComponentRunning + &quot; Started.&quot;]">
                <ui:LogMessage.Level>
                  <InArgument x:TypeArguments="ui:LogLevel">
                    <Literal x:TypeArguments="ui:LogLevel" sap2010:WorkflowViewState.IdRef="Literal`1_9" Value="Info" />
                  </InArgument>
                </ui:LogMessage.Level>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:LogMessage>
              <Assign DisplayName="Assign Master Data File Sheet" sap:VirtualizedContainerService.HintSize="575,60" sap2010:WorkflowViewState.IdRef="Assign_497">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:String">[strSheetName]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:String">MASTER DATA</InArgument>
                </Assign.Value>
              </Assign>
              <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Read Master Data File" sap:VirtualizedContainerService.HintSize="575,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_5" InstanceCachePeriod="3000" Visible="False" WorkbookPath="[strMasterDataFile]">
                <ui:ExcelApplicationScope.Body>
                  <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                    </ActivityAction.Argument>
                    <ui:ExcelReadRange AddHeaders="True" DataTable="[dtMaster]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_4" SheetName="[strSheetName]">
                      <ui:ExcelReadRange.Range>
                        <InArgument x:TypeArguments="x:String">
                          <Literal x:TypeArguments="x:String" Value="" />
                        </InArgument>
                      </ui:ExcelReadRange.Range>
                    </ui:ExcelReadRange>
                  </ActivityAction>
                </ui:ExcelApplicationScope.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:ExcelApplicationScope>
              <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Read Customer List" sap:VirtualizedContainerService.HintSize="575,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_10" InstanceCachePeriod="3000" Visible="False" WorkbookPath="[strCustomerList]">
                <ui:ExcelApplicationScope.Body>
                  <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                    </ActivityAction.Argument>
                    <ui:ExcelReadRange AddHeaders="True" DataTable="[dtCustomers]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_8" SheetName="Customers">
                      <ui:ExcelReadRange.Range>
                        <InArgument x:TypeArguments="x:String">
                          <Literal x:TypeArguments="x:String" Value="" />
                        </InArgument>
                      </ui:ExcelReadRange.Range>
                    </ui:ExcelReadRange>
                  </ActivityAction>
                </ui:ExcelApplicationScope.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:ExcelApplicationScope>
              <ui:MultipleAssign sap2010:Annotation.AnnotationText="Counts the number of Rows and Columns written to originally so that they can be replaced with empty values before having new data written to. This helps prevents duplicate rows of data should they occur." DisplayName="Multiple Assign - Max Rows and Columns" sap:VirtualizedContainerService.HintSize="575,183" sap2010:WorkflowViewState.IdRef="MultipleAssign_49">
                <ui:MultipleAssign.AssignOperations>
                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_246">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:Int32">[intMaxRows]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:Int32">[dtMaster.Rows.Count + 1]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_247">
                      <ui:AssignOperation.To>
                        <OutArgument x:TypeArguments="x:Int32">[intMaxColumns]</OutArgument>
                      </ui:AssignOperation.To>
                      <ui:AssignOperation.Value>
                        <InArgument x:TypeArguments="x:Int32">[dtMaster.Columns.Count - 1]</InArgument>
                      </ui:AssignOperation.Value>
                    </ui:AssignOperation>
                  </scg:List>
                </ui:MultipleAssign.AssignOperations>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:MultipleAssign>
              <Sequence DisplayName="Get Working File Data" sap:VirtualizedContainerService.HintSize="575,66" sap2010:WorkflowViewState.IdRef="Sequence_986">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:LogMessage DisplayName="Log Message - Working File Data" sap:VirtualizedContainerService.HintSize="334,93" sap2010:WorkflowViewState.IdRef="LogMessage_219" Level="Info" Message="[&quot;Obtaining Working File Data Started.&quot;]" />
                <ui:FilterDataTable DataTable="[dtMaster]" DisplayName="Filter Master Data Table by Blank PIC" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="334,52" sap2010:WorkflowViewState.IdRef="FilterDataTable_1" OutputDataTable="[dtMaster]" SelectColumnsMode="Keep">
                  <ui:FilterDataTable.Filters>
                    <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                      <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="EMPTY">
                        <ui:FilterOperationArgument.Column>
                          <InArgument x:TypeArguments="x:String">["PIC Name"]</InArgument>
                        </ui:FilterOperationArgument.Column>
                      </ui:FilterOperationArgument>
                    </scg:List>
                  </ui:FilterDataTable.Filters>
                  <ui:FilterDataTable.SelectColumns>
                    <scg:List x:TypeArguments="InArgument" Capacity="4">
                      <x:Null />
                    </scg:List>
                  </ui:FilterDataTable.SelectColumns>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:FilterDataTable>
                <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Working File" sap:VirtualizedContainerService.HintSize="334,52" sap2010:WorkflowViewState.IdRef="ForEach`1_110" Values="[arrWorkingFiles]">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="x:String">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="x:String" Name="workingFilePath" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Copy Data from Working Files" sap:VirtualizedContainerService.HintSize="539,954" sap2010:WorkflowViewState.IdRef="Sequence_512">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:String" Name="strWorkingFile" />
                          <Variable x:TypeArguments="x:String" Name="strPIC" />
                          <Variable x:TypeArguments="sd:DataTable" Name="dtWorkingFile" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Assign DisplayName="Assign Working File" sap:VirtualizedContainerService.HintSize="497,60" sap2010:WorkflowViewState.IdRef="Assign_478">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:String">[strWorkingFile]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Split(workingFilePath.Split("."c).First,"Working File").Last.ToString.Trim]</InArgument>
                          </Assign.Value>
                        </Assign>
                        <Switch x:TypeArguments="x:String" DisplayName="Switch - PIC Name" Expression="[strWorkingFile]" sap:VirtualizedContainerService.HintSize="497,182" sap2010:WorkflowViewState.IdRef="Switch`1_6">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign x:Key="Carine" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_479">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strPIC]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">Carine</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign x:Key="Sofie" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_480">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strPIC]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">Sofie</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign x:Key="Michele" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_481">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strPIC]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">Michele</InArgument>
                            </Assign.Value>
                          </Assign>
                        </Switch>
                        <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="497,168" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_6" InstanceCachePeriod="3000" Visible="False" WorkbookPath="[workingFilePath]">
                          <ui:ExcelApplicationScope.Body>
                            <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                              </ActivityAction.Argument>
                              <ui:ExcelReadRange AddHeaders="True" DataTable="[dtWorkingFile]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="ExcelReadRange_5" SheetName="[strSheetName]">
                                <ui:ExcelReadRange.Range>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" Value="" />
                                  </InArgument>
                                </ui:ExcelReadRange.Range>
                              </ui:ExcelReadRange>
                            </ActivityAction>
                          </ui:ExcelApplicationScope.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ExcelApplicationScope>
                        <ui:FilterDataTable DataTable="[dtWorkingFile]" DisplayName="Filter Working File Data Table by Blank PIC and relevant PIC" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="497,160" sap2010:WorkflowViewState.IdRef="FilterDataTable_2" OutputDataTable="[dtWorkingFile]" SelectColumnsMode="Keep">
                          <ui:FilterDataTable.Filters>
                            <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                              <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="EMPTY">
                                <ui:FilterOperationArgument.Column>
                                  <InArgument x:TypeArguments="x:String">["PIC name"]</InArgument>
                                </ui:FilterOperationArgument.Column>
                              </ui:FilterOperationArgument>
                              <ui:FilterOperationArgument BooleanOperator="Or" Operator="EQ">
                                <ui:FilterOperationArgument.Column>
                                  <InArgument x:TypeArguments="x:String">["PIC name"]</InArgument>
                                </ui:FilterOperationArgument.Column>
                                <ui:FilterOperationArgument.Operand>
                                  <InArgument x:TypeArguments="x:String">[strPIC]</InArgument>
                                </ui:FilterOperationArgument.Operand>
                              </ui:FilterOperationArgument>
                              <ui:FilterOperationArgument BooleanOperator="Or" Operator="EQ">
                                <ui:FilterOperationArgument.Column>
                                  <InArgument x:TypeArguments="x:String">["PIC name"]</InArgument>
                                </ui:FilterOperationArgument.Column>
                                <ui:FilterOperationArgument.Operand>
                                  <InArgument x:TypeArguments="x:String">[strPIC.ToUpper]</InArgument>
                                </ui:FilterOperationArgument.Operand>
                              </ui:FilterOperationArgument>
                              <ui:FilterOperationArgument BooleanOperator="Or" Operator="EQ">
                                <ui:FilterOperationArgument.Column>
                                  <InArgument x:TypeArguments="x:String">["PIC name"]</InArgument>
                                </ui:FilterOperationArgument.Column>
                                <ui:FilterOperationArgument.Operand>
                                  <InArgument x:TypeArguments="x:String">[strPIC.ToLower]</InArgument>
                                </ui:FilterOperationArgument.Operand>
                              </ui:FilterOperationArgument>
                            </scg:List>
                          </ui:FilterDataTable.Filters>
                          <ui:FilterDataTable.SelectColumns>
                            <scg:List x:TypeArguments="InArgument" Capacity="4">
                              <x:Null />
                            </scg:List>
                          </ui:FilterDataTable.SelectColumns>
                        </ui:FilterDataTable>
                        <ui:MergeDataTable Destination="[dtMaster]" DisplayName="Merge Working Files with Master File " sap:VirtualizedContainerService.HintSize="497,132" sap2010:WorkflowViewState.IdRef="MergeDataTable_2" MissingSchemaAction="Ignore" Source="[dtWorkingFile]">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:MergeDataTable>
                      </Sequence>
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
                <Assign DisplayName="Assign Case Sensititivty Off" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_669">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:Boolean">[dtMaster.CaseSensitive]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                  </Assign.Value>
                </Assign>
                <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Update to latest PIC Data" DataTable="[dtMaster]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="334,83" sap2010:WorkflowViewState.IdRef="ForEachRow_38">
                  <ui:ForEachRow.Body>
                    <ActivityAction x:TypeArguments="sd:DataRow">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                      </ActivityAction.Argument>
                      <If Condition="[Not MasterRow(&quot;PIC name&quot;).ToString.Trim = &quot;&quot;]" DisplayName="If PIC isn't nothing" sap:VirtualizedContainerService.HintSize="837,2290" sap2010:WorkflowViewState.IdRef="If_480">
                        <If.Then>
                          <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="801,2100" sap2010:WorkflowViewState.IdRef="ForEachRow_39">
                            <ui:ForEachRow.Body>
                              <ActivityAction x:TypeArguments="sd:DataRow">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterLoop" />
                                </ActivityAction.Argument>
                                <If Condition="[MasterLoop(&quot;PIC name&quot;).ToString.Trim = &quot;&quot;]" DisplayName="If PIC Is Nothing" sap:VirtualizedContainerService.HintSize="767,1984" sap2010:WorkflowViewState.IdRef="If_483">
                                  <If.Then>
                                    <Sequence DisplayName="Update Row Data with PIC Data" sap:VirtualizedContainerService.HintSize="731,1794" sap2010:WorkflowViewState.IdRef="Sequence_984">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Mapping Column" sap:VirtualizedContainerService.HintSize="689,1222" sap2010:WorkflowViewState.IdRef="ForEach`1_189" Values="[{&quot;Customer PO no.&quot;, &quot;Customer PO line number&quot;, &quot;BRUCP contract no.&quot;, &quot;BL number&quot;}]">
                                        <ui:ForEach.Body>
                                          <ActivityAction x:TypeArguments="x:String">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="x:String" Name="MappingColumn" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="Assign Column Matching" sap:VirtualizedContainerService.HintSize="653,1097" sap2010:WorkflowViewState.IdRef="Sequence_992">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Switch x:TypeArguments="x:String" DisplayName="Switch - Contract No" Expression="[MappingColumn]" sap:VirtualizedContainerService.HintSize="611,591" sap2010:WorkflowViewState.IdRef="Switch`1_9">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If x:Key="BRUCP contract no." Condition="[Not MasterRow(MappingColumn).ToString.ToUpper.Trim = &quot;&quot; AndAlso MasterLoop(MappingColumn).ToString.ToUpper.Trim = &quot;&quot;]" DisplayName="If Contract No. in Working File isn't Blank but is in Master Data File" sap:VirtualizedContainerService.HintSize="484,404" sap2010:WorkflowViewState.IdRef="If_492">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence DisplayName="Assign as True and Continue" sap:VirtualizedContainerService.HintSize="304,214" sap2010:WorkflowViewState.IdRef="Sequence_995">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign DisplayName="Assign Column Match as True" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_659">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">[bColMatch]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <ui:Continue sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="Continue_8" />
                                                    </Sequence>
                                                  </If.Then>
                                                </If>
                                              </Switch>
                                              <If Condition="[MasterRow(MappingColumn).ToString.ToUpper.Trim = MasterLoop(MappingColumn).ToString.ToUpper.Trim]" DisplayName="If Column Data Matches" sap:VirtualizedContainerService.HintSize="611,374" sap2010:WorkflowViewState.IdRef="If_481">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Assign DisplayName="Assign Column Match as True" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_656">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Boolean">[bColMatch]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                </If.Then>
                                                <If.Else>
                                                  <Sequence DisplayName="Assign Column Match as False and Break" sap:VirtualizedContainerService.HintSize="304,214" sap2010:WorkflowViewState.IdRef="Sequence_981">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Assign DisplayName="Assign Column Match as False" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_657">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Boolean">[bColMatch]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <ui:Break sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="Break_9" />
                                                  </Sequence>
                                                </If.Else>
                                              </If>
                                            </Sequence>
                                          </ActivityAction>
                                        </ui:ForEach.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ForEach>
                                      <If Condition="[bColMatch]" DisplayName="If all Mapping Columns Match" sap:VirtualizedContainerService.HintSize="689,440" sap2010:WorkflowViewState.IdRef="If_482">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <If Condition="[Not colDataRowsMaster.Contains(MasterLoop)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="484,250" sap2010:WorkflowViewState.IdRef="If_486">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_202" Item="[MasterLoop]" />
                                            </If.Then>
                                          </If>
                                        </If.Then>
                                      </If>
                                    </Sequence>
                                  </If.Then>
                                </If>
                              </ActivityAction>
                            </ui:ForEachRow.Body>
                          </ui:ForEachRow>
                        </If.Then>
                      </If>
                    </ActivityAction>
                  </ui:ForEachRow.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEachRow>
                <ui:ForEach x:TypeArguments="sd:DataRow" CurrentIndex="{x:Null}" DisplayName="For Each Row to Delete from Master" sap:VirtualizedContainerService.HintSize="334,52" sap2010:WorkflowViewState.IdRef="ForEach`1_191" Values="[colDataRowsMaster]">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="sd:DataRow">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="sd:DataRow" Name="rowDelete" />
                      </ActivityAction.Argument>
                      <ui:RemoveDataRow RowIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="Remove Data Row" sap:VirtualizedContainerService.HintSize="284,188" sap2010:WorkflowViewState.IdRef="RemoveDataRow_4" Row="[rowDelete]" />
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
                <ui:RemoveDuplicateRows DataTable="[dtMaster]" DisplayName="Remove Duplicate Rows" sap:VirtualizedContainerService.HintSize="334,80" sap2010:WorkflowViewState.IdRef="RemoveDuplicateRows_4" OutputDataTable="[dtMaster]">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:RemoveDuplicateRows>
                <ui:LogMessage DisplayName="Log Message - Working File Data" sap:VirtualizedContainerService.HintSize="334,93" sap2010:WorkflowViewState.IdRef="LogMessage_220" Level="Info" Message="[&quot;Obtaining Working File Data Complete.&quot;]" />
              </Sequence>
              <If sap2010:Annotation.AnnotationText="Data is sorted by Vessel name so that any rows without Vessel name (no BA info added) can be mapped to first" Condition="[dtMaster.Rows.Count &gt; 0]" DisplayName="Sort Data in Master DataTable" sap:VirtualizedContainerService.HintSize="575,138" sap2010:WorkflowViewState.IdRef="If_510">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <Assign DisplayName="Sort by Contract No. and Line Number" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_660">
                    <Assign.To>
                      <OutArgument x:TypeArguments="sd:DataTable">[dtMaster]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="sd:DataTable">[(From x in dtMaster.AsEnumerable() Order By Convert.ToString(x("Customer PO no.")) Descending,Convert.ToString(x("Vessel name")) Ascending Select x).CopyToDataTable]</InArgument>
                    </Assign.Value>
                  </Assign>
                </If.Then>
              </If>
              <Assign DisplayName="Sort Tables in Expected Order" sap:VirtualizedContainerService.HintSize="575,60" sap2010:WorkflowViewState.IdRef="Assign_609">
                <Assign.To>
                  <OutArgument x:TypeArguments="scg:ICollection(sd:DataTable)">[colTables]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="scg:List(sd:DataTable)">[colTables.OrderBy(Function(x) x.TableName).ToList]</InArgument>
                </Assign.Value>
              </Assign>
              <Assign DisplayName="Assign Table Index" sap:VirtualizedContainerService.HintSize="575,60" sap2010:WorkflowViewState.IdRef="Assign_610">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:Int32">[intTableIndex]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:Int32">0</InArgument>
                </Assign.Value>
              </Assign>
              <ui:InterruptibleWhile CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Loops through Data Tables that have been added to colTables. Appends Data from tables to Master Data Table if there is mapping available." Condition="[colTables.Count &gt; intTableIndex]" DisplayName="Add New Data to Master Data Table" sap:VirtualizedContainerService.HintSize="575,1454" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_6">
                <ui:InterruptibleWhile.Body>
                  <Sequence DisplayName="Merge Data with Master Data Table" sap:VirtualizedContainerService.HintSize="539,1247" sap2010:WorkflowViewState.IdRef="Sequence_621">
                    <Sequence.Variables>
                      <Variable x:TypeArguments="sd:DataTable" Name="dtCopy" />
                      <Variable x:TypeArguments="scg:ICollection(x:Int32)" Default="[New List(Of Integer)]" Name="colDataRows" />
                      <Variable x:TypeArguments="x:Int32" Name="intTableRow" />
                      <Variable x:TypeArguments="x:Int32" Name="intMaxTableRows" />
                      <Variable x:TypeArguments="sd:DataRow" Name="drowTable" />
                      <Variable x:TypeArguments="x:Double" Name="dblQtyKgMaster" />
                      <Variable x:TypeArguments="x:Double" Name="dblQtyKg" />
                      <Variable x:TypeArguments="sd:DataTable" Name="dtTable" />
                    </Sequence.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Assign DisplayName="Assign Table" sap:VirtualizedContainerService.HintSize="497,60" sap2010:WorkflowViewState.IdRef="Assign_611">
                      <Assign.To>
                        <OutArgument x:TypeArguments="sd:DataTable">[dtTable]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="sd:DataTable">[colTables(intTableIndex)]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:LogMessage DisplayName="LogMessage - Table Name" sap:VirtualizedContainerService.HintSize="497,91" sap2010:WorkflowViewState.IdRef="LogMessage_200" Level="Warn" Message="[&quot;Merging with &quot; + dtTable.TableName]" />
                    <ui:MultipleAssign DisplayName="Multiple Assign Data Table Handling Variables" sap:VirtualizedContainerService.HintSize="497,51" sap2010:WorkflowViewState.IdRef="MultipleAssign_65">
                      <ui:MultipleAssign.AssignOperations>
                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_291">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\" + dtTable.TableName.Split("-"c)(1) + " Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_288">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="scg:ICollection(x:Int32)">[colDataRows]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="scg:ICollection(x:Int32)">[New List(Of Integer)]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_289">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="scg:ICollection(sd:DataRow)">[colDataRowsMaster]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="scg:ICollection(sd:DataRow)">[New List(Of DataRow)]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_290">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="sd:DataTable">[dtCopy]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="sd:DataTable">[dtTable.Copy]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_292">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:Int32">[intTableRow]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:Int32">[dtCopy.Rows.Count - 1]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_345">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:Boolean">[dtCopy.CaseSensitive]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                        </scg:List>
                      </ui:MultipleAssign.AssignOperations>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:MultipleAssign>
                    <If Condition="[dtTable.TableName.Split(&quot;-&quot;c)(0) = &quot;3&quot;]" DisplayName="If BSD Table" sap:VirtualizedContainerService.HintSize="497,51" sap2010:WorkflowViewState.IdRef="If_394">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <Assign DisplayName="Assign Classification Folder for BSD" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_605">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:String">[strClassificationFolder]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:String">[strDesktopFolder + "\Business Support Treated\" + DaOpDate.ToString("yyyy") + "\" + DaOpDate.ToString("MMM")]</InArgument>
                          </Assign.Value>
                        </Assign>
                      </If.Then>
                    </If>
                    <Assign DisplayName="Assign Table Name" sap:VirtualizedContainerService.HintSize="497,60" sap2010:WorkflowViewState.IdRef="Assign_606">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">[dtTable.TableName]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">[dtTable.TableName.Split("-"c)(1)]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <Switch x:TypeArguments="x:String" DisplayName="Switch - Table Name" Expression="[dtTable.TableName]" sap:VirtualizedContainerService.HintSize="497,269" sap2010:WorkflowViewState.IdRef="Switch`1_7">
                      <Switch.Default>
                        <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Unknown Classification Table: &quot; + dtTable.TableName)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_104" />
                      </Switch.Default>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Sequence x:Key="Customer PO" DisplayName="Add Customer PO Data to Master" sap:VirtualizedContainerService.HintSize="604,940" sap2010:WorkflowViewState.IdRef="Sequence_1056">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InterruptibleWhile CurrentIndex="{x:Null}" Condition="[intTableRow &gt;= 0]" DisplayName="While - Loop through rows in new Data Table" sap:VirtualizedContainerService.HintSize="562,920" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_12">
                          <ui:InterruptibleWhile.Body>
                            <Sequence DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="526,723" sap2010:WorkflowViewState.IdRef="Sequence_1055">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign New Table Row reference" sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_661">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="sd:DataRow">[drowTable]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="sd:DataRow">[dtCopy.Rows(intTableRow)]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <If Condition="[drowTable(&quot;Qty/kg&quot;).ToString.Contains(&quot;/&quot;)]" DisplayName="If Qty/kg is Not in Correct Format" sap:VirtualizedContainerService.HintSize="484,431" sap2010:WorkflowViewState.IdRef="If_536">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Add to Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="376,245" sap2010:WorkflowViewState.IdRef="Sequence_1053">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_215" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for Purchase Order &quot; + drowTable(&quot;Customer PO no.&quot;).ToString + &quot; line &quot; + drowTable(&quot;Customer PO line number&quot;).ToString + &quot; contains an unrecognised Unit of Measure. Please convert to Qty/kg.&quot;]" />
                                    <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_227" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for Purchase Order &quot; + drowTable(&quot;Customer PO no.&quot;).ToString + &quot; line &quot; + drowTable(&quot;Customer PO line number&quot;).ToString + &quot; contains an unrecognised Unit of Measure. Please convert to Qty/kg.&quot;]" />
                                  </Sequence>
                                </If.Then>
                              </If>
                              <Assign DisplayName="Assign Row Index" sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_662">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[intTableRow]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[intTableRow - 1]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </ui:InterruptibleWhile.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InterruptibleWhile>
                      </Sequence>
                      <Sequence x:Key="Booking Advice" DisplayName="Add Booking Advice Data to Master" sap:VirtualizedContainerService.HintSize="995,5085" sap2010:WorkflowViewState.IdRef="Sequence_622">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:SortDataTable ColumnIndex="{x:Null}" DataColumn="{x:Null}" ColumnName="Date of Email" DataTable="[dtCopy]" DisplayName="Sort Data Table by Newest Emails" sap:VirtualizedContainerService.HintSize="953,238" sap2010:WorkflowViewState.IdRef="SortDataTable_1" Order="Decending" OutputDataTable="[dtCopy]" SortOrder="Descending" />
                        <ui:InterruptibleWhile CurrentIndex="{x:Null}" Condition="[intTableRow &gt;= 0]" DisplayName="While - Loop through rows in new Data Table" sap:VirtualizedContainerService.HintSize="953,4745" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_3">
                          <ui:InterruptibleWhile.Body>
                            <Sequence DisplayName="Append Row Data to New Data Table" sap:VirtualizedContainerService.HintSize="917,4580" sap2010:WorkflowViewState.IdRef="Sequence_645">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign New Table Row reference" sap:VirtualizedContainerService.HintSize="875,60" sap2010:WorkflowViewState.IdRef="Assign_563">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="sd:DataRow">[drowTable]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="sd:DataRow">[dtCopy.Rows(intTableRow)]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <If sap2010:Annotation.AnnotationText="Remove rows from booking advice table that aren't latest revision" Condition="[drowTable(&quot;Revision&quot;).ToString = &quot;YES&quot;]" DisplayName="If Booking Advice is Revision" sap:VirtualizedContainerService.HintSize="875,763" sap2010:WorkflowViewState.IdRef="If_320">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtCopy]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="554,546" sap2010:WorkflowViewState.IdRef="ForEachRow_23">
                                    <ui:ForEachRow.Body>
                                      <ActivityAction x:TypeArguments="sd:DataRow">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="sd:DataRow" Name="RowRevision" />
                                        </ActivityAction.Argument>
                                        <If Condition="[Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso RowRevision(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso DateTime.Parse(RowRevision(&quot;Date of Email&quot;).ToString) &lt; DateTime.Parse(drowTable(&quot;Date of Email&quot;).ToString)]" DisplayName="If Contract is same but older BA Info" sap:VirtualizedContainerService.HintSize="520,432" sap2010:WorkflowViewState.IdRef="If_322">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(RowRevision))]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="484,246" sap2010:WorkflowViewState.IdRef="If_321">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_132" Item="[dtCopy.Rows.IndexOf(RowRevision)]" />
                                              </If.Then>
                                            </If>
                                          </If.Then>
                                        </If>
                                      </ActivityAction>
                                    </ui:ForEachRow.Body>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:ForEachRow>
                                </If.Then>
                              </If>
                              <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="For Each Row in Master Data Table" sap:VirtualizedContainerService.HintSize="875,2464" sap2010:WorkflowViewState.IdRef="ForEachRow_20">
                                <ui:ForEachRow.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Map Data to Master Data File" sap:VirtualizedContainerService.HintSize="619,2350" sap2010:WorkflowViewState.IdRef="Sequence_689">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:IfElseIf DisplayName="Booking Advice Revision Mapping Conditions" sap:VirtualizedContainerService.HintSize="577,534" sap2010:WorkflowViewState.IdRef="IfElseIf_21">
                                        <ui:IfElseIf.ConditionBlocks>
                                          <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                            <ui:IfElseIfBlock BlockType="If" Condition="[Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso drowTable(&quot;Revision&quot;).ToString.Trim =&quot;YES&quot; AndAlso drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso drowTable(&quot;Customer PO no.&quot;).ToString.Trim = MasterRow(&quot;Customer PO no.&quot;).ToString.Trim]">
                                              <ui:IfElseIfBlock.Then>
                                                <If sap2010:Annotation.AnnotationText="Update row with revised data" Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,82" sap2010:WorkflowViewState.IdRef="If_324">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_134" Item="[MasterRow]" />
                                                  </If.Then>
                                                </If>
                                              </ui:IfElseIfBlock.Then>
                                            </ui:IfElseIfBlock>
                                            <ui:IfElseIfBlock BlockType="ElseIf" Condition="[Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso drowTable(&quot;Revision&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP Contract no.&quot;).ToString.Trim AndAlso MasterRow(&quot;Customer PO no.&quot;).ToString.Trim = drowTable(&quot;Customer PO no.&quot;).ToString.Trim AndAlso Not MasterRow(&quot;Vessel name&quot;).ToString.Trim = &quot;&quot; AndAlso Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]">
                                              <ui:IfElseIfBlock.Then>
                                                <Sequence sap2010:Annotation.AnnotationText="If the Booking Advice Email is not a revision but there is no available data to Map to, then add to Manual Investigation" DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="Sequence_672">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="484,87" sap2010:WorkflowViewState.IdRef="LogMessage_209" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and Purchase Order &quot; + drowTable(&quot;Customer PO no.&quot;).ToString + &quot; is already within the Master Data File. The file provided does not contain (Revise). Moving File to Investigation Folder.&quot;]" />
                                                  <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_136" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and Purchase Order &quot; + drowTable(&quot;Customer PO no.&quot;).ToString + &quot; is already within the Master Data File. The file provided does not contain (Revise).&quot;]" />
                                                  <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="484,229" sap2010:WorkflowViewState.IdRef="If_317">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_130" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                    </If.Then>
                                                  </If>
                                                  <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="484,80" sap2010:WorkflowViewState.IdRef="CreateDirectory_50" Path="[strInvestigationFolder]">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:CreateDirectory>
                                                  <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="484,329" sap2010:WorkflowViewState.IdRef="If_326">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File - Investigation" sap:VirtualizedContainerService.HintSize="434,160" sap2010:WorkflowViewState.IdRef="MoveFile_67" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                                    </If.Then>
                                                  </If>
                                                  <ui:Continue sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Continue_7" />
                                                </Sequence>
                                              </ui:IfElseIfBlock.Then>
                                            </ui:IfElseIfBlock>
                                          </sc:BindingList>
                                        </ui:IfElseIf.ConditionBlocks>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:IfElseIf>
                                      <ui:IfElseIf DisplayName="Map data to Master Data File Rows" sap:VirtualizedContainerService.HintSize="577,1684" sap2010:WorkflowViewState.IdRef="IfElseIf_19">
                                        <ui:IfElseIf.ConditionBlocks>
                                          <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                            <ui:IfElseIfBlock BlockType="If" Condition="[MasterRow(&quot;Customer PO no.&quot;).ToString.Trim = drowTable(&quot;Customer PO no.&quot;).ToString.Trim AndAlso drowTable(&quot;Customer PO line number&quot;).ToString.Trim = MasterRow(&quot;Customer PO line number&quot;).ToString.Trim AndAlso MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso MasterRow(&quot;Vessel name&quot;).ToString.Trim = &quot;&quot;]">
                                              <ui:IfElseIfBlock.Then>
                                                <Sequence sap2010:Annotation.AnnotationText="Append Row Data when there are Line Items on the BA and when BRUCP contract no. has been manually entered." DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="Sequence_1001">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="AddDataRow_30">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:AddDataRow>
                                                  <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="ForEach`1_192" Values="[dtMaster.Columns]">
                                                    <ui:ForEach.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataColumn">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                        </ActivityAction.Argument>
                                                        <If Condition="[Not dtTable.Columns.Contains(column.ColumnName)]" DisplayName="If Column not in New Data Table" sap:VirtualizedContainerService.HintSize="562,715" sap2010:WorkflowViewState.IdRef="If_494">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,546" sap2010:WorkflowViewState.IdRef="Sequence_998">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,52" sap2010:WorkflowViewState.IdRef="TryCatch_79">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <TryCatch.Try>
                                                                  <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_44" MaxLength="-1" Unique="False" />
                                                                </TryCatch.Try>
                                                                <TryCatch.Catches>
                                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_86">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                      </ActivityAction.Argument>
                                                                    </ActivityAction>
                                                                  </Catch>
                                                                </TryCatch.Catches>
                                                              </TryCatch>
                                                              <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,362" sap2010:WorkflowViewState.IdRef="If_493">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,193" sap2010:WorkflowViewState.IdRef="UpdateRowItem_57" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                                </If.Then>
                                                              </If>
                                                            </Sequence>
                                                          </If.Then>
                                                        </If>
                                                      </ActivityAction>
                                                    </ui:ForEach.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ForEach>
                                                  <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_495">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_206" Item="[MasterRow]" />
                                                    </If.Then>
                                                  </If>
                                                  <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_511">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_209" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                    </If.Then>
                                                  </If>
                                                </Sequence>
                                              </ui:IfElseIfBlock.Then>
                                            </ui:IfElseIfBlock>
                                            <ui:IfElseIfBlock BlockType="ElseIf" Condition="[MasterRow(&quot;Customer PO no.&quot;).ToString.Trim = drowTable(&quot;Customer PO no.&quot;).ToString.Trim AndAlso drowTable(&quot;Customer PO line number&quot;).ToString.Trim = MasterRow(&quot;Customer PO line number&quot;).ToString.Trim AndAlso MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;Vessel name&quot;).ToString.Trim = &quot;&quot;]">
                                              <ui:IfElseIfBlock.Then>
                                                <Sequence sap2010:Annotation.AnnotationText="Append Row Data when there are Line Items on the BA and when BRUCP contract no. has not been manually entered." DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="200,160" sap2010:WorkflowViewState.IdRef="Sequence_649">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="AddDataRow_31">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:AddDataRow>
                                                  <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="ForEach`1_137" Values="[dtMaster.Columns]">
                                                    <ui:ForEach.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataColumn">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                        </ActivityAction.Argument>
                                                        <If Condition="[Not dtTable.Columns.Contains(column.ColumnName)]" DisplayName="If Column not in New Data Table" sap:VirtualizedContainerService.HintSize="562,715" sap2010:WorkflowViewState.IdRef="If_308">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,546" sap2010:WorkflowViewState.IdRef="Sequence_647">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,52" sap2010:WorkflowViewState.IdRef="TryCatch_54">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <TryCatch.Try>
                                                                  <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_15" MaxLength="-1" Unique="False" />
                                                                </TryCatch.Try>
                                                                <TryCatch.Catches>
                                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_60">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                      </ActivityAction.Argument>
                                                                    </ActivityAction>
                                                                  </Catch>
                                                                </TryCatch.Catches>
                                                              </TryCatch>
                                                              <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,362" sap2010:WorkflowViewState.IdRef="If_307">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,193" sap2010:WorkflowViewState.IdRef="UpdateRowItem_24" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                                </If.Then>
                                                              </If>
                                                            </Sequence>
                                                          </If.Then>
                                                        </If>
                                                      </ActivityAction>
                                                    </ui:ForEach.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ForEach>
                                                  <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_323">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_133" Item="[MasterRow]" />
                                                    </If.Then>
                                                  </If>
                                                  <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_512">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_210" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                    </If.Then>
                                                  </If>
                                                </Sequence>
                                              </ui:IfElseIfBlock.Then>
                                            </ui:IfElseIfBlock>
                                            <ui:IfElseIfBlock BlockType="ElseIf" Condition="[MasterRow(&quot;Customer PO no.&quot;).ToString.Trim = drowTable(&quot;Customer PO no.&quot;).ToString.Trim AndAlso drowTable(&quot;Customer PO line number&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso MasterRow(&quot;Vessel name&quot;).ToString.Trim = &quot;&quot;]">
                                              <ui:IfElseIfBlock.Then>
                                                <Sequence sap2010:Annotation.AnnotationText="Append Row Data when there are no Line Items on the BA and when BRUCP contract no. has been manually entered." DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="200,160" sap2010:WorkflowViewState.IdRef="Sequence_1008">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="AddDataRow_29">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:AddDataRow>
                                                  <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="ForEach`1_193" Values="[dtMaster.Columns]">
                                                    <ui:ForEach.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataColumn">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                        </ActivityAction.Argument>
                                                        <If Condition="[Not dtTable.Columns.Contains(column.ColumnName) OrElse column.ColumnName = (&quot;Customer PO line number&quot;)]" DisplayName="If Column Not in New Data Table or if Line Item Column" sap:VirtualizedContainerService.HintSize="562,715" sap2010:WorkflowViewState.IdRef="If_497">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,546" sap2010:WorkflowViewState.IdRef="Sequence_1004">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,52" sap2010:WorkflowViewState.IdRef="TryCatch_80">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <TryCatch.Try>
                                                                  <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_45" MaxLength="-1" Unique="False" />
                                                                </TryCatch.Try>
                                                                <TryCatch.Catches>
                                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_87">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                      </ActivityAction.Argument>
                                                                    </ActivityAction>
                                                                  </Catch>
                                                                </TryCatch.Catches>
                                                              </TryCatch>
                                                              <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,362" sap2010:WorkflowViewState.IdRef="If_496">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,193" sap2010:WorkflowViewState.IdRef="UpdateRowItem_58" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                                </If.Then>
                                                              </If>
                                                            </Sequence>
                                                          </If.Then>
                                                        </If>
                                                      </ActivityAction>
                                                    </ui:ForEach.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ForEach>
                                                  <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_498">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_207" Item="[MasterRow]" />
                                                    </If.Then>
                                                  </If>
                                                  <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_499">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_208" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                    </If.Then>
                                                  </If>
                                                </Sequence>
                                              </ui:IfElseIfBlock.Then>
                                            </ui:IfElseIfBlock>
                                            <ui:IfElseIfBlock BlockType="ElseIf" Condition="[MasterRow(&quot;Customer PO no.&quot;).ToString.Trim = drowTable(&quot;Customer PO no.&quot;).ToString.Trim AndAlso drowTable(&quot;Customer PO line number&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;Vessel name&quot;).ToString.Trim = &quot;&quot;]">
                                              <ui:IfElseIfBlock.Then>
                                                <Sequence sap2010:Annotation.AnnotationText="Append Row Data when there are no Line Items on the BA and when BRUCP contract no. has not been manually entered." DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="200,160" sap2010:WorkflowViewState.IdRef="Sequence_651">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="AddDataRow_18">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:AddDataRow>
                                                  <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="ForEach`1_138" Values="[dtMaster.Columns]">
                                                    <ui:ForEach.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataColumn">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                        </ActivityAction.Argument>
                                                        <If Condition="[Not dtTable.Columns.Contains(column.ColumnName) OrElse column.ColumnName = (&quot;Customer PO line number&quot;)]" DisplayName="If Column Not in New Data Table or if Line Item Column" sap:VirtualizedContainerService.HintSize="562,715" sap2010:WorkflowViewState.IdRef="If_310">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,546" sap2010:WorkflowViewState.IdRef="Sequence_659">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,52" sap2010:WorkflowViewState.IdRef="TryCatch_55">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <TryCatch.Try>
                                                                  <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_16" MaxLength="-1" Unique="False" />
                                                                </TryCatch.Try>
                                                                <TryCatch.Catches>
                                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_61">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                      </ActivityAction.Argument>
                                                                    </ActivityAction>
                                                                  </Catch>
                                                                </TryCatch.Catches>
                                                              </TryCatch>
                                                              <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,362" sap2010:WorkflowViewState.IdRef="If_309">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,193" sap2010:WorkflowViewState.IdRef="UpdateRowItem_26" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                                </If.Then>
                                                              </If>
                                                            </Sequence>
                                                          </If.Then>
                                                        </If>
                                                      </ActivityAction>
                                                    </ui:ForEach.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ForEach>
                                                  <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_311">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_125" Item="[MasterRow]" />
                                                    </If.Then>
                                                  </If>
                                                  <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_312">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_127" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                    </If.Then>
                                                  </If>
                                                </Sequence>
                                              </ui:IfElseIfBlock.Then>
                                            </ui:IfElseIfBlock>
                                            <ui:IfElseIfBlock BlockType="ElseIf" Condition="[MasterRow(&quot;Customer PO no.&quot;).ToString.Trim = drowTable(&quot;Customer PO no.&quot;).ToString.Trim AndAlso drowTable(&quot;Customer PO line number&quot;).ToString.Trim = MasterRow(&quot;Customer PO Line number&quot;).ToString AndAlso MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = &quot;&quot; AndAlso drowTable(&quot;Revision&quot;).ToString.Trim.ToUpper = &quot;YES&quot;]">
                                              <ui:IfElseIfBlock.Then>
                                                <Sequence sap2010:Annotation.AnnotationText="Append Row Data when there is a BA Revision and where there is a Customer PO Line Item" DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="200,144" sap2010:WorkflowViewState.IdRef="Sequence_1097">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="AddDataRow_40">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:AddDataRow>
                                                  <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="ForEach`1_197" Values="[dtMaster.Columns]">
                                                    <ui:ForEach.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataColumn">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                        </ActivityAction.Argument>
                                                        <If Condition="[Not dtTable.Columns.Contains(column.ColumnName)]" DisplayName="If Column not in New Data Table" sap:VirtualizedContainerService.HintSize="562,715" sap2010:WorkflowViewState.IdRef="If_562">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,546" sap2010:WorkflowViewState.IdRef="Sequence_1093">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,52" sap2010:WorkflowViewState.IdRef="TryCatch_84">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <TryCatch.Try>
                                                                  <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_49" MaxLength="-1" Unique="False" />
                                                                </TryCatch.Try>
                                                                <TryCatch.Catches>
                                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_91">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                      </ActivityAction.Argument>
                                                                    </ActivityAction>
                                                                  </Catch>
                                                                </TryCatch.Catches>
                                                              </TryCatch>
                                                              <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,362" sap2010:WorkflowViewState.IdRef="If_561">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,193" sap2010:WorkflowViewState.IdRef="UpdateRowItem_62" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                                </If.Then>
                                                              </If>
                                                            </Sequence>
                                                          </If.Then>
                                                        </If>
                                                      </ActivityAction>
                                                    </ui:ForEach.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ForEach>
                                                  <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_563">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_242" Item="[MasterRow]" />
                                                    </If.Then>
                                                  </If>
                                                  <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_564">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_243" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                    </If.Then>
                                                  </If>
                                                </Sequence>
                                              </ui:IfElseIfBlock.Then>
                                            </ui:IfElseIfBlock>
                                            <ui:IfElseIfBlock BlockType="ElseIf" Condition="[MasterRow(&quot;Customer PO no.&quot;).ToString.Trim = drowTable(&quot;Customer PO no.&quot;).ToString.Trim AndAlso drowTable(&quot;Customer PO line number&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = &quot;&quot; AndAlso drowTable(&quot;Revision&quot;).ToString.Trim.ToUpper = &quot;YES&quot;]">
                                              <ui:IfElseIfBlock.Then>
                                                <Sequence sap2010:Annotation.AnnotationText="Append Row Data when there are no Line Items and the BA is revised" DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="200,128" sap2010:WorkflowViewState.IdRef="Sequence_1102">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="AddDataRow_41">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:AddDataRow>
                                                  <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="ForEach`1_198" Values="[dtMaster.Columns]">
                                                    <ui:ForEach.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataColumn">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                        </ActivityAction.Argument>
                                                        <If Condition="[Not dtTable.Columns.Contains(column.ColumnName) OrElse column.ColumnName = (&quot;Customer PO line number&quot;)]" DisplayName="If Column Not in New Data Table or if Line Item Column" sap:VirtualizedContainerService.HintSize="562,715" sap2010:WorkflowViewState.IdRef="If_568">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,546" sap2010:WorkflowViewState.IdRef="Sequence_1098">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,52" sap2010:WorkflowViewState.IdRef="TryCatch_86">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <TryCatch.Try>
                                                                  <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_50" MaxLength="-1" Unique="False" />
                                                                </TryCatch.Try>
                                                                <TryCatch.Catches>
                                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_93">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                      </ActivityAction.Argument>
                                                                    </ActivityAction>
                                                                  </Catch>
                                                                </TryCatch.Catches>
                                                              </TryCatch>
                                                              <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,362" sap2010:WorkflowViewState.IdRef="If_567">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,193" sap2010:WorkflowViewState.IdRef="UpdateRowItem_63" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                                </If.Then>
                                                              </If>
                                                            </Sequence>
                                                          </If.Then>
                                                        </If>
                                                      </ActivityAction>
                                                    </ui:ForEach.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ForEach>
                                                  <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_569">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_244" Item="[MasterRow]" />
                                                    </If.Then>
                                                  </If>
                                                  <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_570">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_245" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                    </If.Then>
                                                  </If>
                                                </Sequence>
                                              </ui:IfElseIfBlock.Then>
                                            </ui:IfElseIfBlock>
                                          </sc:BindingList>
                                        </ui:IfElseIf.ConditionBlocks>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:IfElseIf>
                                    </Sequence>
                                  </ActivityAction>
                                </ui:ForEachRow.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEachRow>
                              <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Data Not Mapped" sap:VirtualizedContainerService.HintSize="875,981" sap2010:WorkflowViewState.IdRef="If_514">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="839,802" sap2010:WorkflowViewState.IdRef="Sequence_1030">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If Condition="[drowTable(&quot;Customer PO line number&quot;).ToString = &quot;&quot;]" DisplayName="If No Line items" sap:VirtualizedContainerService.HintSize="797,406" sap2010:WorkflowViewState.IdRef="If_517">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence DisplayName="No Line Items Investigation" sap:VirtualizedContainerService.HintSize="376,247" sap2010:WorkflowViewState.IdRef="Sequence_1039">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="334,93" sap2010:WorkflowViewState.IdRef="LogMessage_207" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and Purchase Order &quot; + drowTable(&quot;Customer PO no.&quot;).ToString + &quot; could not be mapped to the Master Data File. Moving File to Investigation Folder.&quot;]" />
                                          <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_214" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and Purchase Order &quot; + drowTable(&quot;Customer PO no.&quot;).ToString + &quot; could not be mapped to the Master Data File.&quot;]" />
                                        </Sequence>
                                      </If.Then>
                                      <If.Else>
                                        <Sequence DisplayName="Line Items Investigation" sap:VirtualizedContainerService.HintSize="376,247" sap2010:WorkflowViewState.IdRef="Sequence_1040">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="334,93" sap2010:WorkflowViewState.IdRef="LogMessage_210" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and Purchase Order &quot; + drowTable(&quot;Customer PO no.&quot;).ToString + &quot; line &quot; + drowTable(&quot;Customer PO line number&quot;).ToString + &quot; could not be mapped to the Master Data File. Moving File to Investigation Folder.&quot;]" />
                                          <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_212" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and Purchase Order &quot; + drowTable(&quot;Customer PO no.&quot;).ToString + &quot; line &quot; + drowTable(&quot;Customer PO line number&quot;).ToString + &quot; could not be mapped to the Master Data File.&quot;]" />
                                        </Sequence>
                                      </If.Else>
                                    </If>
                                    <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="797,52" sap2010:WorkflowViewState.IdRef="If_515">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_213" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                      </If.Then>
                                    </If>
                                    <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="797,80" sap2010:WorkflowViewState.IdRef="CreateDirectory_63" Path="[strInvestigationFolder]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:CreateDirectory>
                                    <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="797,52" sap2010:WorkflowViewState.IdRef="If_516">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File - Investigation" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="MoveFile_80" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                      </If.Then>
                                    </If>
                                  </Sequence>
                                </If.Then>
                              </If>
                              <Assign DisplayName="Assign Row Index" sap:VirtualizedContainerService.HintSize="875,60" sap2010:WorkflowViewState.IdRef="Assign_562">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[intTableRow]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[intTableRow - 1]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </ui:InterruptibleWhile.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InterruptibleWhile>
                      </Sequence>
                      <Sequence x:Key="Shipping Advice" DisplayName="Add Shipping Advice Data to Master" sap:VirtualizedContainerService.HintSize="604,66" sap2010:WorkflowViewState.IdRef="Sequence_1144">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:SortDataTable ColumnIndex="{x:Null}" DataColumn="{x:Null}" ColumnName="Date of Email" DataTable="[dtCopy]" DisplayName="Sort Data Table by Newest Emails" sap:VirtualizedContainerService.HintSize="562,51" sap2010:WorkflowViewState.IdRef="SortDataTable_4" Order="Decending" OutputDataTable="[dtCopy]" SortOrder="Descending">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:SortDataTable>
                        <ui:InterruptibleWhile CurrentIndex="{x:Null}" Condition="[intTableRow &gt;= 0]" DisplayName="While - Loop through rows in new Data Table" sap:VirtualizedContainerService.HintSize="562,862" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_16">
                          <ui:InterruptibleWhile.Body>
                            <Sequence DisplayName="Append Row Data to New Data Table" sap:VirtualizedContainerService.HintSize="526,697" sap2010:WorkflowViewState.IdRef="Sequence_1143">
                              <Sequence.Variables>
                                <Variable x:TypeArguments="x:Double" Name="dblContractQty" />
                              </Sequence.Variables>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign New Table Row reference" sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_726">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="sd:DataRow">[drowTable]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="sd:DataRow">[dtCopy.Rows(intTableRow)]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <If Condition="[CInt(drowTable(&quot;Shipment Count&quot;).ToString) &gt; 1]" DisplayName="If Multiple Contracts in SA" sap:VirtualizedContainerService.HintSize="484,223" sap2010:WorkflowViewState.IdRef="If_609">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Multiple Contract Handling" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1134">
                                    <Sequence.Variables>
                                      <Variable x:TypeArguments="scg:ICollection(x:String)" Default="[New List(Of String)]" Name="colContracts" />
                                      <Variable x:TypeArguments="scg:ICollection(x:String)" Default="[New List(Of String)]" Name="colQtyNum" />
                                    </Sequence.Variables>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign DisplayName="Assign QtyKg of Master File" sap:VirtualizedContainerService.HintSize="800,60" sap2010:WorkflowViewState.IdRef="Assign_727">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Double">[dblQtyKgMaster]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Double">0</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <If Condition="[dtMaster.AsEnumerable().Any(Function(x) x(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim)]" DisplayName="If Contract in Master Data Table" sap:VirtualizedContainerService.HintSize="800,51" sap2010:WorkflowViewState.IdRef="If_601">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="485,652" sap2010:WorkflowViewState.IdRef="ForEachRow_45">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                                              </ActivityAction.Argument>
                                              <ui:IfElseIf DisplayName="Else If PO Info is available" sap:VirtualizedContainerService.HintSize="451,538" sap2010:WorkflowViewState.IdRef="IfElseIf_38">
                                                <ui:IfElseIf.ConditionBlocks>
                                                  <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                    <ui:IfElseIfBlock BlockType="If" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso Not MasterRow(&quot;Qty/kg&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = &quot;&quot;]">
                                                      <ui:IfElseIfBlock.Then>
                                                        <Assign DisplayName="Assign Qty/kg Calculation" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_728">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:Double">[dblQtyKgMaster]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:Double">[dblQtyKgMaster + CDbl(MasterRow("Qty/kg").ToString.Trim)]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </ui:IfElseIfBlock.Then>
                                                    </ui:IfElseIfBlock>
                                                    <ui:IfElseIfBlock BlockType="ElseIf" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso Not MasterRow(&quot;Qty/kg&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = &quot;&quot; AndAlso Not IsNumeric(MasterRow(&quot;Qty/kg&quot;).ToString)]">
                                                      <ui:IfElseIfBlock.Then>
                                                        <AddToCollection x:TypeArguments="x:String" Collection="[colQtyNum]" DisplayName="Add To Contract Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_261" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The quantity on the Master Data File '&quot; + MasterRow(&quot;Qty/kg&quot;).ToString + &quot;' was not in numeric format so the Shipping Advice could not be mapped. Please amend and then resubmit the relevant files.&quot;]" />
                                                      </ui:IfElseIfBlock.Then>
                                                    </ui:IfElseIfBlock>
                                                    <ui:IfElseIfBlock BlockType="ElseIf" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso MasterRow(&quot;Qty/kg&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = &quot;&quot;]">
                                                      <ui:IfElseIfBlock.Then>
                                                        <AddToCollection x:TypeArguments="x:String" Collection="[colContracts]" DisplayName="Add To Contract Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_262" Item="[drowTable(&quot;BRUCP contract no.&quot;).ToString]" />
                                                      </ui:IfElseIfBlock.Then>
                                                    </ui:IfElseIfBlock>
                                                  </sc:BindingList>
                                                </ui:IfElseIf.ConditionBlocks>
                                              </ui:IfElseIf>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                        </ui:ForEachRow>
                                      </If.Then>
                                      <If.Else>
                                        <AddToCollection x:TypeArguments="x:String" Collection="[colContracts]" DisplayName="Add To Contract Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_263" Item="[drowTable(&quot;BRUCP contract no.&quot;).ToString]" />
                                      </If.Else>
                                    </If>
                                    <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtTable]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="800,1109" sap2010:WorkflowViewState.IdRef="ForEachRow_47">
                                      <ui:ForEachRow.Body>
                                        <ActivityAction x:TypeArguments="sd:DataRow">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="sd:DataRow" Name="ShippingRow" />
                                          </ActivityAction.Argument>
                                          <If Condition="[drowTable(&quot;File Name&quot;).ToString.Trim = ShippingRow(&quot;File Name&quot;).ToString.Trim AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = ShippingRow(&quot;BRUCP contract no.&quot;).ToString.Trim]" DisplayName="Find other Contracts within same Shipping Advice" sap:VirtualizedContainerService.HintSize="766,995" sap2010:WorkflowViewState.IdRef="If_603">
                                            <If.Then>
                                              <If Condition="[dtMaster.AsEnumerable().Any(Function(x) x(&quot;BRUCP contract no.&quot;).ToString.Trim = ShippingRow(&quot;BRUCP contract no.&quot;).ToString.Trim)]" DisplayName="If Contract No's are within Master Data Table" sap:VirtualizedContainerService.HintSize="730,809" sap2010:WorkflowViewState.IdRef="If_602">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="485,652" sap2010:WorkflowViewState.IdRef="ForEachRow_46">
                                                    <ui:ForEachRow.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataRow">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                                                        </ActivityAction.Argument>
                                                        <ui:IfElseIf DisplayName="Else If PO Info is available" sap:VirtualizedContainerService.HintSize="451,538" sap2010:WorkflowViewState.IdRef="IfElseIf_39">
                                                          <ui:IfElseIf.ConditionBlocks>
                                                            <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                              <ui:IfElseIfBlock BlockType="If" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = ShippingRow(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso Not ShippingRow(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso Not MasterRow(&quot;Qty/kg&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = &quot;&quot; AndAlso IsNumeric(MasterRow(&quot;Qty/kg&quot;).ToString)]">
                                                                <ui:IfElseIfBlock.Then>
                                                                  <Assign DisplayName="Assign Qty/kg Calculation" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_729">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Double">[dblQtyKgMaster]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Double">[dblQtyKgMaster + CDbl(MasterRow("Qty/kg").ToString.Trim)]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                </ui:IfElseIfBlock.Then>
                                                              </ui:IfElseIfBlock>
                                                              <ui:IfElseIfBlock BlockType="ElseIf" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = ShippingRow(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso Not ShippingRow(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso Not MasterRow(&quot;Qty/kg&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = &quot;&quot; AndAlso Not IsNumeric(MasterRow(&quot;Qty/kg&quot;).ToString)]">
                                                                <ui:IfElseIfBlock.Then>
                                                                  <AddToCollection x:TypeArguments="x:String" Collection="[colQtyNum]" DisplayName="Add To Contract Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_264" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The quantity on the Master Data File '&quot; + MasterRow(&quot;Qty/kg&quot;).ToString + &quot;' was not in numeric format so the Shipping Advice could not be mapped. Please amend and then resubmit the relevant files.&quot;]" />
                                                                </ui:IfElseIfBlock.Then>
                                                              </ui:IfElseIfBlock>
                                                              <ui:IfElseIfBlock BlockType="ElseIf" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = ShippingRow(&quot;BRUCP contract no.&quot;).ToString.Trim  AndAlso Not ShippingRow(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso MasterRow(&quot;Qty/kg&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = &quot;&quot;]">
                                                                <ui:IfElseIfBlock.Then>
                                                                  <AddToCollection x:TypeArguments="x:String" Collection="[colContracts]" DisplayName="Add To Contract Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_265" Item="[ShippingRow(&quot;BRUCP contract no.&quot;).ToString]" />
                                                                </ui:IfElseIfBlock.Then>
                                                              </ui:IfElseIfBlock>
                                                            </sc:BindingList>
                                                          </ui:IfElseIf.ConditionBlocks>
                                                        </ui:IfElseIf>
                                                      </ActivityAction>
                                                    </ui:ForEachRow.Body>
                                                  </ui:ForEachRow>
                                                </If.Then>
                                                <If.Else>
                                                  <AddToCollection x:TypeArguments="x:String" Collection="[colContracts]" DisplayName="Add To Contract Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_266" Item="[ShippingRow(&quot;BRUCP contract no.&quot;).ToString]" />
                                                </If.Else>
                                              </If>
                                            </If.Then>
                                          </If>
                                        </ActivityAction>
                                      </ui:ForEachRow.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:ForEachRow>
                                    <If Condition="[colContracts.Count = 0 AndAlso dblQtyKgMaster = CDbl(drowTable(&quot;Qty/kg&quot;).ToString.Trim)]" DisplayName="If any Contracts in SA not in Master Data Table" sap:VirtualizedContainerService.HintSize="800,51" sap2010:WorkflowViewState.IdRef="If_607">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Else>
                                        <Sequence DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1133">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If Condition="[colQtyNum.Count &gt; 0]" DisplayName="If there are non-numeric qties" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="If_604">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence DisplayName="If Qties are not Numeric" sap:VirtualizedContainerService.HintSize="476,406" sap2010:WorkflowViewState.IdRef="Sequence_1131">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="434,91" sap2010:WorkflowViewState.IdRef="LogMessage_230" Level="Warn" Message="[drowTable(&quot;BRUCP Contract no.&quot;).ToString + &quot;: There were quantites that were not in numerical form which require manual adjustment.&quot;]" />
                                                <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Non-numeric qty" sap:VirtualizedContainerService.HintSize="434,183" sap2010:WorkflowViewState.IdRef="ForEach`1_205" Values="[colQtyNum]">
                                                  <ui:ForEach.Body>
                                                    <ActivityAction x:TypeArguments="x:String">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:String" Name="strQtyError" />
                                                      </ActivityAction.Argument>
                                                      <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_267" Item="[strQtyError]" />
                                                    </ActivityAction>
                                                  </ui:ForEach.Body>
                                                </ui:ForEach>
                                              </Sequence>
                                            </If.Then>
                                            <If.Else>
                                              <Sequence DisplayName="Contracts could not be mapped - mismatched quantities" sap:VirtualizedContainerService.HintSize="376,245" sap2010:WorkflowViewState.IdRef="Sequence_1132">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_231" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for one or more Contracts could not be fully mapped to the Master Data File. Quantities require manual adjustment. Moving File to Investigation Folder.&quot;]" />
                                                <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_268" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for one or more Contracts could not be fully mapped to the Master Data File. Quantities require manual adjustment.&quot;]" />
                                              </Sequence>
                                            </If.Else>
                                          </If>
                                          <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="484,79" sap2010:WorkflowViewState.IdRef="CreateDirectory_75" Path="[strInvestigationFolder]" />
                                          <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="484,343" sap2010:WorkflowViewState.IdRef="If_605">
                                            <If.Then>
                                              <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="MoveFile_90" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                            </If.Then>
                                          </If>
                                          <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row Index Not in Collection" sap:VirtualizedContainerService.HintSize="484,246" sap2010:WorkflowViewState.IdRef="If_606">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_269" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                            </If.Then>
                                          </If>
                                          <Assign DisplayName="Assign Row Index" sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_730">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Int32">[intTableRow]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Int32">[intTableRow - 1]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <ui:Continue sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Continue_9" />
                                        </Sequence>
                                      </If.Else>
                                    </If>
                                  </Sequence>
                                </If.Then>
                                <If.Else>
                                  <Sequence DisplayName="One Contract in SA" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1135">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign DisplayName="Assign Contract Qty as 0" sap:VirtualizedContainerService.HintSize="518,60" sap2010:WorkflowViewState.IdRef="Assign_731">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Double">[dblQtyKgMaster]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Double">0</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="This section checks for instances of the same contract on multiple lines on the Master Data File. All quantities will then be totaled for quantity mapping to the SA." DataTable="[dtMaster]" DisplayName="For Each Row in Master Data Table" sap:VirtualizedContainerService.HintSize="518,402" sap2010:WorkflowViewState.IdRef="ForEachRow_48">
                                      <ui:ForEachRow.Body>
                                        <ActivityAction x:TypeArguments="sd:DataRow">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="sd:DataRow" Name="rowContractCheck" />
                                          </ActivityAction.Argument>
                                          <If Condition="[rowContractCheck(&quot;BL number&quot;).ToString.Trim = &quot;&quot; AndAlso rowContractCheck(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso rowContractCheck(&quot;Vessel name&quot;).ToString.Trim = drowTable(&quot;Vessel name&quot;).ToString.Trim AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso Not rowContractCheck(&quot;Qty/Kg&quot;).ToString.Trim = &quot;&quot;]" DisplayName="If Correct Row of Master File" sap:VirtualizedContainerService.HintSize="484,246" sap2010:WorkflowViewState.IdRef="If_608">
                                            <If.Then>
                                              <Assign DisplayName="Assign Contract Qty" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_732">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Double">[dblQtyKgMaster]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Double">[dblQtyKgMaster + CDbl(rowContractCheck("Qty/kg").ToString)]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </If.Then>
                                          </If>
                                        </ActivityAction>
                                      </ui:ForEachRow.Body>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:ForEachRow>
                                  </Sequence>
                                </If.Else>
                              </If>
                              <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="For Each Row in Master Data Table" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="ForEachRow_49">
                                <ui:ForEachRow.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                                    </ActivityAction.Argument>
                                    <ui:IfElseIf DisplayName="Map Data to Master Data File Rows" sap:VirtualizedContainerService.HintSize="748,2563" sap2010:WorkflowViewState.IdRef="IfElseIf_41">
                                      <ui:IfElseIf.ConditionBlocks>
                                        <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                          <ui:IfElseIfBlock BlockType="If" Condition="[MasterRow(&quot;BL number&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso MasterRow(&quot;Vessel name&quot;).ToString.Trim = drowTable(&quot;Vessel name&quot;).ToString.Trim AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot; AndAlso Not MasterRow(&quot;Qty/Kg&quot;).ToString.Trim = &quot;&quot;]">
                                            <ui:IfElseIfBlock.Then>
                                              <Sequence sap2010:Annotation.AnnotationText="Append Row Data when the BA information matches the SA information." DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="619,2369" sap2010:WorkflowViewState.IdRef="Sequence_1141">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="577,51" sap2010:WorkflowViewState.IdRef="AddDataRow_44">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AddDataRow>
                                                <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="577,51" sap2010:WorkflowViewState.IdRef="ForEach`1_206" Values="[dtMaster.Columns]">
                                                  <ui:ForEach.Body>
                                                    <ActivityAction x:TypeArguments="sd:DataColumn">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                      </ActivityAction.Argument>
                                                      <If Condition="[Not dtTable.Columns.Contains(column.ColumnName)]" DisplayName="If Column Not in New Data Table" sap:VirtualizedContainerService.HintSize="562,1066" sap2010:WorkflowViewState.IdRef="If_611">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,900" sap2010:WorkflowViewState.IdRef="Sequence_1136">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,412" sap2010:WorkflowViewState.IdRef="TryCatch_87">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch.Try>
                                                                <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,185" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_52" MaxLength="-1" Unique="False" />
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_94">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,356" sap2010:WorkflowViewState.IdRef="If_610">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,190" sap2010:WorkflowViewState.IdRef="UpdateRowItem_66" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </ActivityAction>
                                                  </ui:ForEach.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ForEach>
                                                <ui:IfElseIf DisplayName="Else If - Qty Mapping" sap:VirtualizedContainerService.HintSize="577,1798" sap2010:WorkflowViewState.IdRef="IfElseIf_40">
                                                  <ui:IfElseIf.ConditionBlocks>
                                                    <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                                      <ui:IfElseIfBlock BlockType="If" Condition="[Not IsNumeric(MasterRow(&quot;Qty/kg&quot;).ToString)]">
                                                        <ui:IfElseIfBlock.Then>
                                                          <Sequence sap2010:Annotation.AnnotationText="Move SA to Manual Investigation if Qty on Master Data Table is non-numeric" DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="200,123" sap2010:WorkflowViewState.IdRef="Sequence_1137">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="484,91" sap2010:WorkflowViewState.IdRef="LogMessage_232" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; quantity for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; exceeded that on the Master Data File for the same Contract and requires manual adjustment. Moving File to Investigation Folder.&quot;]" />
                                                            <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_270" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The quantity on the Master Data File '&quot; + MasterRow(&quot;Qty/kg&quot;).ToString + &quot;' was not in numeric format so the Shipping Advice could not be mapped. Please amend and then resubmit the relevant files.&quot;]" />
                                                            <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(dtCopy.Rows(dtCopy.Rows.Count - 1)))]" DisplayName="If New Row index not in collection" sap:VirtualizedContainerService.HintSize="484,247" sap2010:WorkflowViewState.IdRef="If_612">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_271" Item="[dtCopy.Rows.IndexOf(dtCopy.Rows(dtCopy.Rows.Count - 1))]" />
                                                              </If.Then>
                                                            </If>
                                                            <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="484,79" sap2010:WorkflowViewState.IdRef="CreateDirectory_76" Path="[strInvestigationFolder]" />
                                                            <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="484,344" sap2010:WorkflowViewState.IdRef="If_613">
                                                              <If.Then>
                                                                <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="MoveFile_91" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </ui:IfElseIfBlock.Then>
                                                      </ui:IfElseIfBlock>
                                                      <ui:IfElseIfBlock BlockType="ElseIf" Condition="[dblQtyKgMaster = CDbl(drowTable(&quot;Qty/kg&quot;).ToString.Trim)]">
                                                        <ui:IfElseIfBlock.Then>
                                                          <Sequence DisplayName="Update to Master Data File Qty" sap:VirtualizedContainerService.HintSize="526,579" sap2010:WorkflowViewState.IdRef="Sequence_1138">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="Qty/kg" DisplayName="Update Qty/kg Balance" sap:VirtualizedContainerService.HintSize="484,190" sap2010:WorkflowViewState.IdRef="UpdateRowItem_67" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(&quot;Qty/kg&quot;).ToString.Trim]">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:UpdateRowItem>
                                                            <If sap2010:Annotation.AnnotationText="If Quantities are equal then remove row from Master Data Table." Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="484,257" sap2010:WorkflowViewState.IdRef="If_614">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_272" Item="[MasterRow]" />
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </ui:IfElseIfBlock.Then>
                                                      </ui:IfElseIfBlock>
                                                      <ui:IfElseIfBlock BlockType="ElseIf" Condition="[dblQtyKgMaster &gt; CDbl(drowTable(&quot;Qty/kg&quot;).ToString.Trim)]">
                                                        <ui:IfElseIfBlock.Then>
                                                          <Sequence sap2010:Annotation.AnnotationText="Add Balance Line when Quantity on Master Data File is larger than on the SA." DisplayName="Update Balance Line" sap:VirtualizedContainerService.HintSize="476,404" sap2010:WorkflowViewState.IdRef="Sequence_1139">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="Qty/kg" DisplayName="Update Qty/kg Balance" sap:VirtualizedContainerService.HintSize="434,190" sap2010:WorkflowViewState.IdRef="UpdateRowItem_68" Row="[MasterRow]" Value="[dblQtyKgMaster - CDbl(drowTable(&quot;Qty/kg&quot;).ToString.Trim)]">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:UpdateRowItem>
                                                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Column in BA" sap:VirtualizedContainerService.HintSize="434,51" sap2010:WorkflowViewState.IdRef="ForEach`1_207" Values="[{&quot;ETD&quot;, &quot;ETA&quot;, &quot;Vessel Name&quot;, &quot;Port Destination&quot;}]">
                                                              <ui:ForEach.Body>
                                                                <ActivityAction x:TypeArguments="x:String">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:String" Name="ColumnName" />
                                                                  </ActivityAction.Argument>
                                                                  <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[ColumnName]" DisplayName="Update Qty/kg Balance" sap:VirtualizedContainerService.HintSize="434,190" sap2010:WorkflowViewState.IdRef="UpdateRowItem_69" Row="[MasterRow]" Value="[&quot;&quot;]" />
                                                                </ActivityAction>
                                                              </ui:ForEach.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:ForEach>
                                                          </Sequence>
                                                        </ui:IfElseIfBlock.Then>
                                                      </ui:IfElseIfBlock>
                                                      <ui:IfElseIfBlock BlockType="ElseIf" Condition="[dblQtyKgMaster &lt; CDbl(drowTable(&quot;Qty/kg&quot;).ToString.Trim)]">
                                                        <ui:IfElseIfBlock.Then>
                                                          <Sequence sap2010:Annotation.AnnotationText="Move SA to Manual Investigation if Quantity on the SA is larger than on the Master Data File." DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="Sequence_1140">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="484,87" sap2010:WorkflowViewState.IdRef="LogMessage_233" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; quantity for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; exceeded that on the Master Data File for the same Contract and requires manual adjustment. Moving File to Investigation Folder.&quot;]" />
                                                            <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_273" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; quantity for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; exceeded that on the Master Data File for the same Contract and requires manual adjustment.&quot;]" />
                                                            <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(dtCopy.Rows(dtCopy.Rows.Count - 1)))]" DisplayName="If New Row index not in collection" sap:VirtualizedContainerService.HintSize="484,226" sap2010:WorkflowViewState.IdRef="If_615">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_274" Item="[dtCopy.Rows.IndexOf(dtCopy.Rows(dtCopy.Rows.Count - 1))]" />
                                                              </If.Then>
                                                            </If>
                                                            <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="484,79" sap2010:WorkflowViewState.IdRef="CreateDirectory_77" Path="[strInvestigationFolder]" />
                                                            <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="484,323" sap2010:WorkflowViewState.IdRef="If_616">
                                                              <If.Then>
                                                                <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="MoveFile_92" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </ui:IfElseIfBlock.Then>
                                                      </ui:IfElseIfBlock>
                                                    </sc:BindingList>
                                                  </ui:IfElseIf.ConditionBlocks>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:IfElseIf>
                                                <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="577,226" sap2010:WorkflowViewState.IdRef="If_617">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_275" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ui:IfElseIfBlock.Then>
                                          </ui:IfElseIfBlock>
                                        </sc:BindingList>
                                      </ui:IfElseIf.ConditionBlocks>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:IfElseIf>
                                  </ActivityAction>
                                </ui:ForEachRow.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEachRow>
                              <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Data Not Mapped" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="If_620">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="526,1033" sap2010:WorkflowViewState.IdRef="Sequence_1142">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="484,91" sap2010:WorkflowViewState.IdRef="LogMessage_234" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File. Moving File to Investigation Folder.&quot;]" />
                                    <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_276" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File.&quot;]" />
                                    <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row Index Not in Collection" sap:VirtualizedContainerService.HintSize="484,246" sap2010:WorkflowViewState.IdRef="If_618">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_277" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                      </If.Then>
                                    </If>
                                    <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="484,79" sap2010:WorkflowViewState.IdRef="CreateDirectory_78" Path="[strInvestigationFolder]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:CreateDirectory>
                                    <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="484,343" sap2010:WorkflowViewState.IdRef="If_619">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File - Investigation" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="MoveFile_93" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                      </If.Then>
                                    </If>
                                  </Sequence>
                                </If.Then>
                              </If>
                              <Assign DisplayName="Assign Row Index" sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_733">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[intTableRow]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[intTableRow - 1]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </ui:InterruptibleWhile.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InterruptibleWhile>
                      </Sequence>
                      <Sequence x:Key="Payment WF" DisplayName="Add Payment WF Data to Master" sap:VirtualizedContainerService.HintSize="1054,3636" sap2010:WorkflowViewState.IdRef="Sequence_852">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InterruptibleWhile CurrentIndex="{x:Null}" Condition="[intTableRow &gt;= 0]" DisplayName="While - Loop through rows in new Data Table" sap:VirtualizedContainerService.HintSize="1012,3624" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_7">
                          <ui:InterruptibleWhile.Body>
                            <Sequence DisplayName="Append Row Data to New Data Table" sap:VirtualizedContainerService.HintSize="976,3459" sap2010:WorkflowViewState.IdRef="Sequence_851">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign New Table Row reference" sap:VirtualizedContainerService.HintSize="934,60" sap2010:WorkflowViewState.IdRef="Assign_613">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="sd:DataRow">[drowTable]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="sd:DataRow">[dtCopy.Rows(intTableRow)]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="For Each Row in Master Data Table" sap:VirtualizedContainerService.HintSize="934,1893" sap2010:WorkflowViewState.IdRef="ForEachRow_31">
                                <ui:ForEachRow.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                                    </ActivityAction.Argument>
                                    <ui:IfElseIf DisplayName="Map data to Master Data File Rows" sap:VirtualizedContainerService.HintSize="691,1779" sap2010:WorkflowViewState.IdRef="IfElseIf_27">
                                      <ui:IfElseIf.ConditionBlocks>
                                        <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                          <ui:IfElseIfBlock BlockType="If" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = drowTable(&quot;BL number&quot;).ToString.Trim AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot;]">
                                            <ui:IfElseIfBlock.Then>
                                              <Sequence sap2010:Annotation.AnnotationText="Append Row Data when SA information exists." DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="640,1585" sap2010:WorkflowViewState.IdRef="Sequence_856">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="598,51" sap2010:WorkflowViewState.IdRef="AddDataRow_35">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AddDataRow>
                                                <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="598,1189" sap2010:WorkflowViewState.IdRef="ForEach`1_160" Values="[dtMaster.Columns]">
                                                  <ui:ForEach.Body>
                                                    <ActivityAction x:TypeArguments="sd:DataColumn">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                      </ActivityAction.Argument>
                                                      <If Condition="[Not dtTable.Columns.Contains(column.ColumnName)]" DisplayName="If Column not in New Data Table" sap:VirtualizedContainerService.HintSize="562,1066" sap2010:WorkflowViewState.IdRef="If_400">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,900" sap2010:WorkflowViewState.IdRef="Sequence_853">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,412" sap2010:WorkflowViewState.IdRef="TryCatch_63">
                                                              <TryCatch.Try>
                                                                <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,185" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_25" MaxLength="-1" Unique="False" />
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_69">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,356" sap2010:WorkflowViewState.IdRef="If_399">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,190" sap2010:WorkflowViewState.IdRef="UpdateRowItem_42" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </ActivityAction>
                                                  </ui:ForEach.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ForEach>
                                                <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="598,51" sap2010:WorkflowViewState.IdRef="If_401">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_172" Item="[MasterRow]" />
                                                  </If.Then>
                                                </If>
                                                <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="598,51" sap2010:WorkflowViewState.IdRef="If_525">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_221" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ui:IfElseIfBlock.Then>
                                          </ui:IfElseIfBlock>
                                        </sc:BindingList>
                                      </ui:IfElseIf.ConditionBlocks>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:IfElseIf>
                                  </ActivityAction>
                                </ui:ForEachRow.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEachRow>
                              <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Data Not Mapped" sap:VirtualizedContainerService.HintSize="934,1234" sap2010:WorkflowViewState.IdRef="If_528">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="526,1033" sap2010:WorkflowViewState.IdRef="Sequence_1044">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="484,91" sap2010:WorkflowViewState.IdRef="LogMessage_213" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File. Moving File to Investigation Folder.&quot;]" />
                                    <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_222" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File.&quot;]" />
                                    <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="484,246" sap2010:WorkflowViewState.IdRef="If_526">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_223" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                      </If.Then>
                                    </If>
                                    <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="484,79" sap2010:WorkflowViewState.IdRef="CreateDirectory_65" Path="[strInvestigationFolder]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:CreateDirectory>
                                    <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="484,343" sap2010:WorkflowViewState.IdRef="If_527">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File - Investigation" sap:VirtualizedContainerService.HintSize="434,157" sap2010:WorkflowViewState.IdRef="MoveFile_82" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                      </If.Then>
                                    </If>
                                  </Sequence>
                                </If.Then>
                              </If>
                              <Assign DisplayName="Assign Row Index" sap:VirtualizedContainerService.HintSize="934,60" sap2010:WorkflowViewState.IdRef="Assign_614">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[intTableRow]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[intTableRow - 1]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </ui:InterruptibleWhile.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InterruptibleWhile>
                      </Sequence>
                      <Sequence x:Key="Purchase WF" DisplayName="Add Purchase WF Data to Master" sap:VirtualizedContainerService.HintSize="940,651" sap2010:WorkflowViewState.IdRef="Sequence_867">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InterruptibleWhile CurrentIndex="{x:Null}" Condition="[intTableRow &gt;= 0]" DisplayName="While - Loop through rows in new Data Table" sap:VirtualizedContainerService.HintSize="898,599" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_13">
                          <ui:InterruptibleWhile.Body>
                            <Sequence DisplayName="Append Row Data to New Data Table" sap:VirtualizedContainerService.HintSize="304,434" sap2010:WorkflowViewState.IdRef="Sequence_1067">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign New Table Row reference" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_663">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="sd:DataRow">[drowTable]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="sd:DataRow">[dtCopy.Rows(intTableRow)]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="For Each Row in Master Data Table" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="ForEachRow_40">
                                <ui:ForEachRow.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                                    </ActivityAction.Argument>
                                    <ui:IfElseIf DisplayName="Map data to Master Data File Rows" sap:VirtualizedContainerService.HintSize="786,660" sap2010:WorkflowViewState.IdRef="IfElseIf_33">
                                      <ui:IfElseIf.ConditionBlocks>
                                        <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                          <ui:IfElseIfBlock BlockType="If" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = drowTable(&quot;BL number&quot;).ToString.Trim AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot;]">
                                            <ui:IfElseIfBlock.Then>
                                              <Sequence sap2010:Annotation.AnnotationText="Append Row Data when SA information exists." DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="242,464" sap2010:WorkflowViewState.IdRef="Sequence_1062">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="AddDataRow_37">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AddDataRow>
                                                <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="ForEach`1_194" Values="[dtMaster.Columns]">
                                                  <ui:ForEach.Body>
                                                    <ActivityAction x:TypeArguments="sd:DataColumn">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                      </ActivityAction.Argument>
                                                      <If Condition="[Not dtTable.Columns.Contains(column.ColumnName)]" DisplayName="If Column not in New Data Table" sap:VirtualizedContainerService.HintSize="562,1083" sap2010:WorkflowViewState.IdRef="If_538">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,914" sap2010:WorkflowViewState.IdRef="Sequence_1058">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,420" sap2010:WorkflowViewState.IdRef="TryCatch_81">
                                                              <TryCatch.Try>
                                                                <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_46" MaxLength="-1" Unique="False" />
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_88">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,362" sap2010:WorkflowViewState.IdRef="If_537">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,193" sap2010:WorkflowViewState.IdRef="UpdateRowItem_59" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </ActivityAction>
                                                  </ui:ForEach.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ForEach>
                                                <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_539">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_229" Item="[MasterRow]" />
                                                  </If.Then>
                                                </If>
                                                <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_540">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_230" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ui:IfElseIfBlock.Then>
                                          </ui:IfElseIfBlock>
                                        </sc:BindingList>
                                      </ui:IfElseIf.ConditionBlocks>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:IfElseIf>
                                  </ActivityAction>
                                </ui:ForEachRow.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEachRow>
                              <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Data Not Mapped" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="If_543">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="526,1045" sap2010:WorkflowViewState.IdRef="Sequence_1065">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="484,93" sap2010:WorkflowViewState.IdRef="LogMessage_216" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File. Moving File to Investigation Folder.&quot;]" />
                                    <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_231" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File.&quot;]" />
                                    <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="484,249" sap2010:WorkflowViewState.IdRef="If_541">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_232" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                      </If.Then>
                                    </If>
                                    <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="484,80" sap2010:WorkflowViewState.IdRef="CreateDirectory_68" Path="[strInvestigationFolder]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:CreateDirectory>
                                    <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="484,349" sap2010:WorkflowViewState.IdRef="If_542">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File - Investigation" sap:VirtualizedContainerService.HintSize="434,160" sap2010:WorkflowViewState.IdRef="MoveFile_85" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                      </If.Then>
                                    </If>
                                  </Sequence>
                                </If.Then>
                              </If>
                              <Assign DisplayName="Assign Row Index" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_664">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[intTableRow]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[intTableRow - 1]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </ui:InterruptibleWhile.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InterruptibleWhile>
                      </Sequence>
                      <Sequence x:Key="IDI" DisplayName="Add IDI Data to Master" sap:VirtualizedContainerService.HintSize="940,651" sap2010:WorkflowViewState.IdRef="Sequence_874">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InterruptibleWhile CurrentIndex="{x:Null}" Condition="[intTableRow &gt;= 0]" DisplayName="While - Loop through rows in new Data Table" sap:VirtualizedContainerService.HintSize="898,599" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_14">
                          <ui:InterruptibleWhile.Body>
                            <Sequence DisplayName="Append Row Data to New Data Table" sap:VirtualizedContainerService.HintSize="304,434" sap2010:WorkflowViewState.IdRef="Sequence_1077">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign New Table Row reference" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_665">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="sd:DataRow">[drowTable]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="sd:DataRow">[dtCopy.Rows(intTableRow)]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="For Each Row in Master Data Table" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="ForEachRow_41">
                                <ui:ForEachRow.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                                    </ActivityAction.Argument>
                                    <ui:IfElseIf DisplayName="Map data to Master Data File Rows" sap:VirtualizedContainerService.HintSize="786,308" sap2010:WorkflowViewState.IdRef="IfElseIf_34">
                                      <ui:IfElseIf.ConditionBlocks>
                                        <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                          <ui:IfElseIfBlock BlockType="If" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString.Trim = drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim AndAlso MasterRow(&quot;BL number&quot;).ToString.Trim = drowTable(&quot;BL number&quot;).ToString.Trim AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString.Trim = &quot;TBA&quot;]">
                                            <ui:IfElseIfBlock.Then>
                                              <Sequence sap2010:Annotation.AnnotationText="Append Row Data when SA information exists." DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="200,112" sap2010:WorkflowViewState.IdRef="Sequence_1072">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="AddDataRow_38">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AddDataRow>
                                                <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="ForEach`1_195" Values="[dtMaster.Columns]">
                                                  <ui:ForEach.Body>
                                                    <ActivityAction x:TypeArguments="sd:DataColumn">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                      </ActivityAction.Argument>
                                                      <If Condition="[Not dtTable.Columns.Contains(column.ColumnName)]" DisplayName="If Column not in New Data Table" sap:VirtualizedContainerService.HintSize="562,1083" sap2010:WorkflowViewState.IdRef="If_545">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,914" sap2010:WorkflowViewState.IdRef="Sequence_1068">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <TryCatch DisplayName="Try Catch - Add Data Column" sap:VirtualizedContainerService.HintSize="484,420" sap2010:WorkflowViewState.IdRef="TryCatch_82">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch.Try>
                                                                <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_47" MaxLength="-1" Unique="False" />
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_89">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,362" sap2010:WorkflowViewState.IdRef="If_544">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,193" sap2010:WorkflowViewState.IdRef="UpdateRowItem_60" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </ActivityAction>
                                                  </ui:ForEach.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ForEach>
                                                <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_546">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_233" Item="[MasterRow]" />
                                                  </If.Then>
                                                </If>
                                                <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_547">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_234" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ui:IfElseIfBlock.Then>
                                          </ui:IfElseIfBlock>
                                        </sc:BindingList>
                                      </ui:IfElseIf.ConditionBlocks>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:IfElseIf>
                                  </ActivityAction>
                                </ui:ForEachRow.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEachRow>
                              <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Data Not Mapped" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="If_550">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="526,848" sap2010:WorkflowViewState.IdRef="Sequence_1075">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="484,93" sap2010:WorkflowViewState.IdRef="LogMessage_217" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File. Moving File to Investigation Folder.&quot;]" />
                                    <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_235" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File.&quot;]" />
                                    <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="484,52" sap2010:WorkflowViewState.IdRef="If_548">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_236" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                      </If.Then>
                                    </If>
                                    <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="484,80" sap2010:WorkflowViewState.IdRef="CreateDirectory_69" Path="[strInvestigationFolder]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:CreateDirectory>
                                    <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="484,349" sap2010:WorkflowViewState.IdRef="If_549">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File - Investigation" sap:VirtualizedContainerService.HintSize="434,160" sap2010:WorkflowViewState.IdRef="MoveFile_86" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                      </If.Then>
                                    </If>
                                  </Sequence>
                                </If.Then>
                              </If>
                              <Assign DisplayName="Assign Row Index" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_666">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[intTableRow]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[intTableRow - 1]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </ui:InterruptibleWhile.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InterruptibleWhile>
                      </Sequence>
                      <Sequence x:Key="Invoice" DisplayName="Add Invoice Data to Master" sap:VirtualizedContainerService.HintSize="845,1366" sap2010:WorkflowViewState.IdRef="Sequence_885">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InterruptibleWhile CurrentIndex="{x:Null}" Condition="[intTableRow &gt;= 0]" DisplayName="While - Loop through rows in new Data Table" sap:VirtualizedContainerService.HintSize="803,1314" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_15">
                          <ui:InterruptibleWhile.Body>
                            <Sequence DisplayName="Append Row Data to New Data Table" sap:VirtualizedContainerService.HintSize="527,1149" sap2010:WorkflowViewState.IdRef="Sequence_1087">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign New Table Row reference" sap:VirtualizedContainerService.HintSize="485,60" sap2010:WorkflowViewState.IdRef="Assign_667">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="sd:DataRow">[drowTable]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="sd:DataRow">[dtCopy.Rows(intTableRow)]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="For Each Row in Master Data Table" sap:VirtualizedContainerService.HintSize="485,766" sap2010:WorkflowViewState.IdRef="ForEachRow_42">
                                <ui:ForEachRow.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                                    </ActivityAction.Argument>
                                    <ui:IfElseIf DisplayName="Map data to Master Data File Rows" sap:VirtualizedContainerService.HintSize="451,652" sap2010:WorkflowViewState.IdRef="IfElseIf_35">
                                      <ui:IfElseIf.ConditionBlocks>
                                        <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                                          <ui:IfElseIfBlock BlockType="If" Condition="[MasterRow(&quot;BRUCP contract no.&quot;).ToString = drowTable(&quot;BRUCP contract no.&quot;).ToString AndAlso (MasterRow(&quot;BL number&quot;).ToString = drowTable(&quot;BL number&quot;).ToString OrElse MasterRow(&quot;Business Type&quot;).ToString.ToUpper = &quot;STOCK&quot;) AndAlso Not drowTable(&quot;BRUCP contract no.&quot;).ToString = &quot;TBA&quot;]">
                                            <ui:IfElseIfBlock.Then>
                                              <Sequence sap2010:Annotation.AnnotationText="Append Row Data when SA information exists." DisplayName="Append Row Data" sap:VirtualizedContainerService.HintSize="242,458" sap2010:WorkflowViewState.IdRef="Sequence_1082">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[drowTable.ItemArray]" DataTable="[dtCopy]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AddDataRow_39">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AddDataRow>
                                                <ui:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" DisplayName="For Each Column in Master Data Table" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_196" Values="[dtMaster.Columns]">
                                                  <ui:ForEach.Body>
                                                    <ActivityAction x:TypeArguments="sd:DataColumn">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                                      </ActivityAction.Argument>
                                                      <If Condition="[Not dtTable.Columns.Contains(column.ColumnName)]" DisplayName="If Column not in New Data Table" sap:VirtualizedContainerService.HintSize="562,1083" sap2010:WorkflowViewState.IdRef="If_552">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="Add Column to Data Table Copy" sap:VirtualizedContainerService.HintSize="526,914" sap2010:WorkflowViewState.IdRef="Sequence_1078">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="484,420" sap2010:WorkflowViewState.IdRef="TryCatch_83">
                                                              <TryCatch.Try>
                                                                <ui:AddDataColumn x:TypeArguments="x:String" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" AllowDBNull="True" ColumnName="[column.ColumnName.ToString]" DataTable="[dtCopy]" DisplayName="Add Data Column" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_48" MaxLength="-1" Unique="False" />
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_90">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <If Condition="[Not MasterRow(column.ColumnName).ToString.Trim = &quot;&quot;]" DisplayName="If Master Data Table Data is not Nothing" sap:VirtualizedContainerService.HintSize="484,362" sap2010:WorkflowViewState.IdRef="If_551">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <ui:UpdateRowItem ColumnIndex="{x:Null}" ColumnName="[column.ColumnName.ToString]" DisplayName="Update Row Item" sap:VirtualizedContainerService.HintSize="434,193" sap2010:WorkflowViewState.IdRef="UpdateRowItem_61" Row="[dtCopy.Rows(dtCopy.Rows.Count - 1)]" Value="[MasterRow(column.columnName).ToString.Trim]" />
                                                              </If.Then>
                                                            </If>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </ActivityAction>
                                                  </ui:ForEach.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:ForEach>
                                                <If Condition="[Not colDataRowsMaster.Contains(MasterRow)]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_553">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="sd:DataRow" Collection="[colDataRowsMaster]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_237" Item="[MasterRow]" />
                                                  </If.Then>
                                                </If>
                                                <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row index not in collection" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_554">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_238" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ui:IfElseIfBlock.Then>
                                          </ui:IfElseIfBlock>
                                        </sc:BindingList>
                                      </ui:IfElseIf.ConditionBlocks>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:IfElseIf>
                                  </ActivityAction>
                                </ui:ForEachRow.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEachRow>
                              <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Data Not Mapped" sap:VirtualizedContainerService.HintSize="485,51" sap2010:WorkflowViewState.IdRef="If_557">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="Move File to Manual Investigation Folder" sap:VirtualizedContainerService.HintSize="526,1045" sap2010:WorkflowViewState.IdRef="Sequence_1085">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:LogMessage DisplayName="Log Message - Investigation Required" sap:VirtualizedContainerService.HintSize="484,93" sap2010:WorkflowViewState.IdRef="LogMessage_218" Level="Warn" Message="[drowTable(&quot;File Name&quot;).ToString + &quot;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File. Moving File to Investigation Folder.&quot;]" />
                                    <AddToCollection x:TypeArguments="x:String" Collection="[colBRUCPErrors]" DisplayName="Add To Manual Investigation Collection" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_239" Item="[&quot;&lt;b&gt;&quot; + drowTable(&quot;File Name&quot;).ToString + &quot;&lt;/b&gt;: The &quot; + dtTable.TableName + &quot; for Contract &quot; + drowTable(&quot;BRUCP contract no.&quot;).ToString + &quot; and BL Number &quot; + drowTable(&quot;BL number&quot;).ToString + &quot; could not be mapped to the Master Data File.&quot;]" />
                                    <If Condition="[Not colDataRows.Contains(dtCopy.Rows.IndexOf(drowTable))]" DisplayName="If Row Not in Collection" sap:VirtualizedContainerService.HintSize="484,249" sap2010:WorkflowViewState.IdRef="If_555">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <AddToCollection x:TypeArguments="x:Int32" Collection="[colDataRows]" DisplayName="Add To Collection to Delete" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_240" Item="[dtCopy.Rows.IndexOf(drowTable)]" />
                                      </If.Then>
                                    </If>
                                    <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Investigation Folder" sap:VirtualizedContainerService.HintSize="484,80" sap2010:WorkflowViewState.IdRef="CreateDirectory_70" Path="[strInvestigationFolder]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:CreateDirectory>
                                    <If Condition="[IO.File.Exists(strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString)]" DisplayName="If File Still in Classification Folder" sap:VirtualizedContainerService.HintSize="484,349" sap2010:WorkflowViewState.IdRef="If_556">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strInvestigationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" DisplayName="Move File - Investigation" sap:VirtualizedContainerService.HintSize="434,160" sap2010:WorkflowViewState.IdRef="MoveFile_87" Path="[strClassificationFolder + &quot;\&quot; + drowTable(&quot;File Name&quot;).ToString]" />
                                      </If.Then>
                                    </If>
                                  </Sequence>
                                </If.Then>
                              </If>
                              <Assign DisplayName="Assign Row Index" sap:VirtualizedContainerService.HintSize="485,60" sap2010:WorkflowViewState.IdRef="Assign_668">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[intTableRow]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[intTableRow - 1]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </ui:InterruptibleWhile.Body>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InterruptibleWhile>
                      </Sequence>
                    </Switch>
                    <ui:ForEach x:TypeArguments="sd:DataRow" CurrentIndex="{x:Null}" DisplayName="For Each Row to Delete from Master" sap:VirtualizedContainerService.HintSize="497,51" sap2010:WorkflowViewState.IdRef="ForEach`1_136" Values="[colDataRowsMaster]">
                      <ui:ForEach.Body>
                        <ActivityAction x:TypeArguments="sd:DataRow">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="sd:DataRow" Name="rowDelete" />
                          </ActivityAction.Argument>
                          <ui:RemoveDataRow RowIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="Remove Data Row" sap:VirtualizedContainerService.HintSize="284,188" sap2010:WorkflowViewState.IdRef="RemoveDataRow_1" Row="[rowDelete]" />
                        </ActivityAction>
                      </ui:ForEach.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ForEach>
                    <ui:ForEach x:TypeArguments="x:Int32" CurrentIndex="{x:Null}" DisplayName="For Each Row to Delete from New Data Table" sap:VirtualizedContainerService.HintSize="497,51" sap2010:WorkflowViewState.IdRef="ForEach`1_141" Values="[colDataRows.OrderByDescending(Function(x) x)]">
                      <ui:ForEach.Body>
                        <ActivityAction x:TypeArguments="x:Int32">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="x:Int32" Name="rowDelete" />
                          </ActivityAction.Argument>
                          <ui:RemoveDataRow Row="{x:Null}" DataTable="[dtCopy]" DisplayName="Remove Data Row" sap:VirtualizedContainerService.HintSize="299,188" sap2010:WorkflowViewState.IdRef="RemoveDataRow_3" RowIndex="[rowDelete]" />
                        </ActivityAction>
                      </ui:ForEach.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ForEach>
                    <ui:MergeDataTable Destination="[dtMaster]" DisplayName="Merge Data Table with Master Data Table" sap:VirtualizedContainerService.HintSize="497,51" sap2010:WorkflowViewState.IdRef="MergeDataTable_3" MissingSchemaAction="Ignore" Source="[dtCopy]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:MergeDataTable>
                    <Assign DisplayName="Assign Table Index" sap:VirtualizedContainerService.HintSize="497,60" sap2010:WorkflowViewState.IdRef="Assign_612">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Int32">[intTableIndex]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Int32">[intTableIndex + 1]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </Sequence>
                </ui:InterruptibleWhile.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:InterruptibleWhile>
              <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtMaster]" DisplayName="Update Customer Names ZA Codes and Business Types" sap:VirtualizedContainerService.HintSize="575,51" sap2010:WorkflowViewState.IdRef="ForEachRow_37">
                <ui:ForEachRow.Body>
                  <ActivityAction x:TypeArguments="sd:DataRow">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="MasterRow" />
                    </ActivityAction.Argument>
                    <Sequence DisplayName="Customer Names ZA Codes and Business Types" sap:VirtualizedContainerService.HintSize="242,236" sap2010:WorkflowViewState.IdRef="Sequence_1105">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If Condition="[Not MasterRow(&quot;Customer name&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;ZA Code&quot;).ToString.Trim = &quot;&quot;]" DisplayName="If Customer Name Exists and ZA Code doesn't" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_434">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <Sequence DisplayName="Lookup Customer info" sap:VirtualizedContainerService.HintSize="526,1536" sap2010:WorkflowViewState.IdRef="Sequence_909">
                            <Sequence.Variables>
                              <Variable x:TypeArguments="x:String" Name="strLookupZA" />
                            </Sequence.Variables>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="484,528" sap2010:WorkflowViewState.IdRef="TryCatch_78">
                              <TryCatch.Try>
                                <ui:LookupDataTable LookupColumnIndex="{x:Null}" LookupDataColumn="{x:Null}" RowIndex="{x:Null}" TargetColumnIndex="{x:Null}" TargetDataColumn="{x:Null}" DataTable="[dtCustomers]" DisplayName="Lookup Data Table - Customer Name" sap:VirtualizedContainerService.HintSize="334,296" sap2010:WorkflowViewState.IdRef="LookupDataTable_2" LookupColumnName="Extracted Customer Name" LookupValue="[MasterRow(&quot;Customer name&quot;).ToString]" TargetColumnName="Customer Name">
                                  <ui:LookupDataTable.CellValue>
                                    <OutArgument x:TypeArguments="x:String">[strLookupCustomer]</OutArgument>
                                  </ui:LookupDataTable.CellValue>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:LookupDataTable>
                              </TryCatch.Try>
                              <TryCatch.Catches>
                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_85">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ActivityAction x:TypeArguments="s:Exception">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                    </ActivityAction.Argument>
                                  </ActivityAction>
                                </Catch>
                              </TryCatch.Catches>
                            </TryCatch>
                            <If Condition="[Not Trim(strLookupCustomer) = &quot;&quot;]" DisplayName="If Customer Found in Lookup" sap:VirtualizedContainerService.HintSize="484,250" sap2010:WorkflowViewState.IdRef="If_432">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If.Then>
                                <Assign DisplayName="Assign (overwrite cust name)" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_639">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:Object">[MasterRow("Customer Name")]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String">[strLookupCustomer.Trim]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </If.Then>
                            </If>
                            <ui:LookupDataTable LookupColumnIndex="{x:Null}" LookupDataColumn="{x:Null}" RowIndex="{x:Null}" TargetColumnIndex="{x:Null}" TargetDataColumn="{x:Null}" DataTable="[dtCustomers]" DisplayName="Lookup Data Table - ZA Code" sap:VirtualizedContainerService.HintSize="484,296" sap2010:WorkflowViewState.IdRef="LookupDataTable_3" LookupColumnName="Customer Name" LookupValue="[MasterRow(&quot;Customer name&quot;).ToString]" TargetColumnName="ZA Code">
                              <ui:LookupDataTable.CellValue>
                                <OutArgument x:TypeArguments="x:String">[strLookupZA]</OutArgument>
                              </ui:LookupDataTable.CellValue>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:LookupDataTable>
                            <If Condition="[Not Trim(strLookupZA) = &quot;&quot;]" DisplayName="If ZA Code Found in Lookup" sap:VirtualizedContainerService.HintSize="484,250" sap2010:WorkflowViewState.IdRef="If_433">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If.Then>
                                <Assign DisplayName="Assign (Update ZA Code)" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_640">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:Object">[MasterRow("ZA Code")]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:Object">[strLookupZA.Trim]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </If.Then>
                            </If>
                          </Sequence>
                        </If.Then>
                      </If>
                      <If Condition="[Not MasterRow(&quot;Customer name&quot;).ToString.Trim = &quot;&quot; AndAlso Not MasterRow(&quot;ZA Code&quot;).ToString.Trim = &quot;&quot; AndAlso MasterRow(&quot;Business Type&quot;).ToString.Trim = &quot;&quot;]" DisplayName="If Customer Name and ZA code Exists and Business Type doesn't" sap:VirtualizedContainerService.HintSize="200,52" sap2010:WorkflowViewState.IdRef="If_573">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <Sequence DisplayName="Lookup Customer info" sap:VirtualizedContainerService.HintSize="526,678" sap2010:WorkflowViewState.IdRef="Sequence_1104">
                            <Sequence.Variables>
                              <Variable x:TypeArguments="x:String" Name="strLookupZA" />
                              <Variable x:TypeArguments="x:String" Name="strBusinessType" />
                            </Sequence.Variables>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:LookupDataTable LookupColumnIndex="{x:Null}" LookupDataColumn="{x:Null}" RowIndex="{x:Null}" TargetColumnIndex="{x:Null}" TargetDataColumn="{x:Null}" DataTable="[dtCustomers]" DisplayName="Lookup Data Table - Business Type" sap:VirtualizedContainerService.HintSize="484,296" sap2010:WorkflowViewState.IdRef="LookupDataTable_5" LookupColumnName="Customer Name" LookupValue="[MasterRow(&quot;Customer name&quot;).ToString]" TargetColumnName="Business Type">
                              <ui:LookupDataTable.CellValue>
                                <OutArgument x:TypeArguments="x:String">[strBusinessType]</OutArgument>
                              </ui:LookupDataTable.CellValue>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:LookupDataTable>
                            <If Condition="[Not Trim(strBusinessType) = &quot;&quot;]" DisplayName="If Business Type Found in Lookup" sap:VirtualizedContainerService.HintSize="484,250" sap2010:WorkflowViewState.IdRef="If_572">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If.Then>
                                <Assign DisplayName="Assign (Update Business Type)" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_680">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:Object">[MasterRow("Business Type")]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:Object">[strBusinessType.ToUpper.Trim]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </If.Then>
                            </If>
                          </Sequence>
                        </If.Then>
                      </If>
                    </Sequence>
                  </ActivityAction>
                </ui:ForEachRow.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:ForEachRow>
              <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="Remove Unexpected Columns" sap:VirtualizedContainerService.HintSize="575,51" sap2010:WorkflowViewState.IdRef="ForEach`1_121" Values="[(From dc In dtMaster.Columns.Cast(Of DataColumn) Select dc.ColumnName).Reverse.ToArray()]">
                <ui:ForEach.Body>
                  <ActivityAction x:TypeArguments="x:String">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="x:String" Name="columnName" />
                    </ActivityAction.Argument>
                    <If Condition="[columnName.ToString.ToUpper.Contains(&quot;COLUMN&quot;)]" DisplayName="If Unexpected Column Exists" sap:VirtualizedContainerService.HintSize="512,1102" sap2010:WorkflowViewState.IdRef="If_279">
                      <If.Then>
                        <Sequence DisplayName="Remove Unexpected Columns" sap:VirtualizedContainerService.HintSize="476,912" sap2010:WorkflowViewState.IdRef="Sequence_576">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,93" sap2010:WorkflowViewState.IdRef="LogMessage_179" Level="Warn" Message="[&quot;Unidentified Column found: &quot; + columnName.ToString + &quot;. Deleting Column.&quot;]" />
                          <ui:RemoveDataColumn Column="{x:Null}" ColumnIndex="{x:Null}" ColumnName="[columnName]" DataTable="[dtMaster]" DisplayName="Remove Data Column" sap:VirtualizedContainerService.HintSize="434,188" sap2010:WorkflowViewState.IdRef="RemoveDataColumn_2" />
                          <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel Application Scope" sap:VirtualizedContainerService.HintSize="434,297" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_9" InstanceCachePeriod="3000" Visible="False" WorkbookPath="[strMasterDataFile]">
                            <ui:ExcelApplicationScope.Body>
                              <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                </ActivityAction.Argument>
                                <ui:ExcelInsertDeleteColumns DisplayName="Delete Column From Master Data File" sap:VirtualizedContainerService.HintSize="284,188" sap2010:WorkflowViewState.IdRef="ExcelInsertDeleteColumns_1" Mode="Remove" NoColumns="1" Position="[intMaxColumns + 1]" SheetName="[strSheetName]" />
                              </ActivityAction>
                            </ui:ExcelApplicationScope.Body>
                          </ui:ExcelApplicationScope>
                          <Assign DisplayName="Re-Assign intMaxColumns" sap:VirtualizedContainerService.HintSize="434,60" sap2010:WorkflowViewState.IdRef="Assign_505">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Int32">[intMaxColumns]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Int32">[intMaxColumns - 1]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <AddToCollection x:TypeArguments="x:String" Collection="[colColumnErrors]" DisplayName="Add To Column Collection" sap:VirtualizedContainerService.HintSize="434,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_118" Item="[columnName]" />
                        </Sequence>
                      </If.Then>
                    </If>
                  </ActivityAction>
                </ui:ForEach.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:ForEach>
              <If Condition="[dtMaster.Rows.Count &gt; 0]" DisplayName="Sort Data in Master DataTable" sap:VirtualizedContainerService.HintSize="575,51" sap2010:WorkflowViewState.IdRef="If_274">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="438,292" sap2010:WorkflowViewState.IdRef="TryCatch_85">
                    <TryCatch.Try>
                      <Assign DisplayName="Sort by Contract No. and Line Number" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_498">
                        <Assign.To>
                          <OutArgument x:TypeArguments="sd:DataTable">[dtMaster]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="sd:DataTable">[(From x in dtMaster.AsEnumerable() Order By Convert.ToString(x("Customer PO no.")),CInt(x("Customer PO line number")) Select x).CopyToDataTable]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </TryCatch.Try>
                    <TryCatch.Catches>
                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_92">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ActivityAction x:TypeArguments="s:Exception">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                          </ActivityAction.Argument>
                          <Assign DisplayName="Sort by Contract No. and Line Number" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_676">
                            <Assign.To>
                              <OutArgument x:TypeArguments="sd:DataTable">[dtMaster]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="sd:DataTable">[(From x in dtMaster.AsEnumerable() Order By Convert.ToString(x("Customer PO no.")),Convert.ToString(x("Customer PO line number")) Select x).CopyToDataTable]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </ActivityAction>
                      </Catch>
                    </TryCatch.Catches>
                  </TryCatch>
                </If.Then>
              </If>
              <ui:RemoveDuplicateRows DataTable="[dtMaster]" DisplayName="Remove Duplicate Rows" sap:VirtualizedContainerService.HintSize="575,51" sap2010:WorkflowViewState.IdRef="RemoveDuplicateRows_3" OutputDataTable="[dtMaster]">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:RemoveDuplicateRows>
              <ui:ExcelApplicationScope Password="{x:Null}" CreateNewFile="False" DisplayName="Excel Application Scope - Update Master File" sap:VirtualizedContainerService.HintSize="575,51" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_12" InstanceCachePeriod="5000" Visible="False" WorkbookPath="[strMasterDataFile]">
                <ui:ExcelApplicationScope.Body>
                  <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                    </ActivityAction.Argument>
                    <Sequence DisplayName="Write Master File Data to Excel" sap:VirtualizedContainerService.HintSize="604,2619" sap2010:WorkflowViewState.IdRef="Sequence_917">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:String" Name="strMaxColumn" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If Condition="[intMaxRows &gt; 1]" DisplayName="If at least 1 row of data originally" sap:VirtualizedContainerService.HintSize="562,427" sap2010:WorkflowViewState.IdRef="If_435">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <Sequence DisplayName="Clear Master Data File" sap:VirtualizedContainerService.HintSize="376,241" sap2010:WorkflowViewState.IdRef="Sequence_911">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <l2:Convert_to_Column_Letter_Reference StrColumnName="{x:Null}" DisplayName="Convert to Column Letter Reference - Max Column" DtTable="[dtMaster]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Convert_to_Column_Letter_Reference_5" StrColumnIndex="[intMaxColumns.ToString]" StrColumnLetter="[strMaxColumn]" />
                            <ui:ExcelWriteCell Cell="[&quot;A2:&quot; + strMaxColumn + intMaxRows.ToString]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_3" SheetName="[strSheetName]">
                              <ui:ExcelWriteCell.Text>
                                <InArgument x:TypeArguments="x:String">
                                  <Literal x:TypeArguments="x:String" Value="" />
                                </InArgument>
                              </ui:ExcelWriteCell.Text>
                            </ui:ExcelWriteCell>
                          </Sequence>
                        </If.Then>
                      </If>
                      <ui:ExcelWriteRange AddHeaders="True" DataTable="[dtMaster]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="562,51" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_4" SheetName="[strSheetName]" StartingCell="A1">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ExcelWriteRange>
                      <If Condition="[dtMaster.RowCount &gt; 0]" DisplayName="If at least 1 row of data" sap:VirtualizedContainerService.HintSize="562,1969" sap2010:WorkflowViewState.IdRef="If_437">
                        <If.Then>
                          <Sequence DisplayName="Insert formulas" sap:VirtualizedContainerService.HintSize="526,1783" sap2010:WorkflowViewState.IdRef="Sequence_915">
                            <Sequence.Variables>
                              <Variable x:TypeArguments="x:String" Name="strColLetterPercent" />
                              <Variable x:TypeArguments="x:String" Name="strColLetterSalesTotal" />
                              <Variable x:TypeArguments="x:String" Name="strColLetterPurchaseTotal" />
                              <Variable x:TypeArguments="x:String" Name="strColLetterQty" />
                              <Variable x:TypeArguments="x:String" Name="strColLetterPurchaseUnit" />
                              <Variable x:TypeArguments="x:String" Name="strColLetterSalesUnit" />
                              <Variable x:TypeArguments="x:String" Name="strColLetterCurrency" />
                            </Sequence.Variables>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <l2:Convert_to_Column_Letter_Reference StrColumnIndex="{x:Null}" DisplayName="Convert to Column Letter Reference (Qty/kg)" DtTable="[dtMaster]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Convert_to_Column_Letter_Reference_6" StrColumnLetter="[strColLetterQty]" StrColumnName="Qty/kg">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </l2:Convert_to_Column_Letter_Reference>
                            <l2:Convert_to_Column_Letter_Reference StrColumnIndex="{x:Null}" DisplayName="Convert to Column Letter Reference (Purchase Unit Price)" DtTable="[dtMaster]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Convert_to_Column_Letter_Reference_7" StrColumnLetter="[strColLetterPurchaseUnit]" StrColumnName="Purchase unit price">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </l2:Convert_to_Column_Letter_Reference>
                            <l2:Convert_to_Column_Letter_Reference StrColumnIndex="{x:Null}" DisplayName="Convert to Column Letter Reference (Total Purchase Amount)" DtTable="[dtMaster]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Convert_to_Column_Letter_Reference_8" StrColumnLetter="[strColLetterPurchaseTotal]" StrColumnName="Total purchase amount" />
                            <l2:Convert_to_Column_Letter_Reference StrColumnIndex="{x:Null}" DisplayName="Convert to Column Letter Reference (Currency)" DtTable="[dtMaster]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Convert_to_Column_Letter_Reference_9" StrColumnLetter="[strColLetterCurrency]" StrColumnName="Currency" />
                            <l2:Convert_to_Column_Letter_Reference StrColumnIndex="{x:Null}" DisplayName="Convert to Column Letter Reference (Sales Unit Price)" DtTable="[dtMaster]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Convert_to_Column_Letter_Reference_10" StrColumnLetter="[strColLetterSalesUnit]" StrColumnName="Sales unit price" />
                            <l2:Convert_to_Column_Letter_Reference StrColumnIndex="{x:Null}" DisplayName="Convert to Column Letter Reference (Total Sales Amount)" DtTable="[dtMaster]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Convert_to_Column_Letter_Reference_11" StrColumnLetter="[strColLetterSalesTotal]" StrColumnName="Total sales amount" />
                            <l2:Convert_to_Column_Letter_Reference StrColumnIndex="{x:Null}" DisplayName="Convert to Column Letter Reference (%)" DtTable="[dtMaster]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Convert_to_Column_Letter_Reference_12" StrColumnLetter="[strColLetterPercent]" StrColumnName="%" />
                            <ui:ExcelWriteCell Cell="[strColLetterPurchaseTotal + &quot;2&quot;]" DisplayName="Write Cell Formula - Total Purchase Amount" sap:VirtualizedContainerService.HintSize="484,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_4" SheetName="[strSheetName]" Text="[&quot;=IF(AND(ISNUMBER($&quot; + strColLetterPurchaseUnit + &quot;2),ISNUMBER($&quot;+strColLetterQty + &quot;2)),($&quot; + strColLetterPurchaseUnit + &quot;2*$&quot; + strColLetterQty + &quot;2)/1000,&quot;&quot;&quot;&quot;)&quot;]" />
                            <ui:ExcelWriteCell Cell="[strColLetterCurrency + &quot;2&quot;]" DisplayName="Write Cell - Currency" sap:VirtualizedContainerService.HintSize="484,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_5" SheetName="[strSheetName]" Text="EUR" />
                            <ui:ExcelWriteCell Cell="[strColLetterSalesTotal + &quot;2&quot;]" DisplayName="Write Cell Formula - Total Sales Amount" sap:VirtualizedContainerService.HintSize="484,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_6" SheetName="[strSheetName]" Text="[&quot;=IF(AND(ISNUMBER($&quot; + strColLetterSalesUnit + &quot;2),ISNUMBER($&quot;+strColLetterQty + &quot;2)),($&quot; + strColLetterSalesUnit + &quot;2*$&quot; + strColLetterQty + &quot;2)/1000,&quot;&quot;&quot;&quot;)&quot;]" />
                            <ui:ExcelWriteCell Cell="[strColLetterPercent + &quot;2&quot;]" DisplayName="Write Cell Formula - %" sap:VirtualizedContainerService.HintSize="484,87" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_7" SheetName="[strSheetName]" Text="[&quot;=IFERROR(SUM(+($&quot; + strColLetterSalesTotal + &quot;2-$&quot; + strColLetterPurchaseTotal + &quot;2)/$&quot; + strColLetterSalesTotal + &quot;2*100), &quot;&quot;&quot;&quot;)&quot;]" />
                            <If Condition="[dtMaster.RowCount &gt; 1]" DisplayName="If more than 1 row" sap:VirtualizedContainerService.HintSize="484,749" sap2010:WorkflowViewState.IdRef="If_436">
                              <If.Then>
                                <Sequence DisplayName="FillDown Formulas" sap:VirtualizedContainerService.HintSize="376,560" sap2010:WorkflowViewState.IdRef="Sequence_913">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:ExcelAutoFillRange DisplayName="Auto Fill Range - Purchase Total" FillRange="[strColLetterPurchaseTotal + &quot;2:&quot; + strColLetterPurchaseTotal + (dtMaster.Rows.Count +1).ToString]" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelAutoFillRange_2" SheetName="[strSheetName]" SourceRange="[strColLetterPurchaseTotal + &quot;2&quot;]" />
                                  <ui:ExcelAutoFillRange DisplayName="Auto Fill Range - Currency" FillRange="[strColLetterCurrency + &quot;2:&quot; + strColLetterCurrency + (dtMaster.Rows.Count +1).ToString]" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelAutoFillRange_3" SheetName="[strSheetName]" SourceRange="[strColLetterCurrency+ &quot;2&quot;]" />
                                  <ui:ExcelAutoFillRange DisplayName="Auto Fill Range - Sales Total" FillRange="[strColLetterSalesTotal + &quot;2:&quot; + strColLetterSalesTotal + (dtMaster.Rows.Count +1).ToString]" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelAutoFillRange_4" SheetName="[strSheetName]" SourceRange="[strColLetterSalesTotal + &quot;2&quot;]" />
                                  <ui:ExcelAutoFillRange DisplayName="Auto Fill Range - %" FillRange="[strColLetterPercent + &quot;2:&quot; + strColLetterPercent + (dtMaster.Rows.Count +1).ToString]" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="ExcelAutoFillRange_5" SheetName="[strSheetName]" SourceRange="[strColLetterPercent + &quot;2&quot;]" />
                                </Sequence>
                              </If.Then>
                            </If>
                          </Sequence>
                        </If.Then>
                      </If>
                    </Sequence>
                  </ActivityAction>
                </ui:ExcelApplicationScope.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:ExcelApplicationScope>
              <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each - Copy to Working Files" sap:VirtualizedContainerService.HintSize="575,51" sap2010:WorkflowViewState.IdRef="ForEach`1_107" Values="[arrWorkingFiles]">
                <ui:ForEach.Body>
                  <ActivityAction x:TypeArguments="x:String">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="x:String" Name="workingFile" />
                    </ActivityAction.Argument>
                    <ui:CopyFile ContinueOnError="{x:Null}" Destination="[workingFile]" DisplayName="Copy File" sap:VirtualizedContainerService.HintSize="434,160" sap2010:WorkflowViewState.IdRef="CopyFile_1" Overwrite="True" Path="[strMasterDataFile]" />
                  </ActivityAction>
                </ui:ForEach.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </ui:ForEach>
              <ui:LogMessage DisplayName="Log Message - Component Complete" sap:VirtualizedContainerService.HintSize="575,91" sap2010:WorkflowViewState.IdRef="LogMessage_66" Level="Info" Message="[StrComponentRunning + &quot; Complete.&quot;]" />
            </Sequence>
          </TryCatch.Try>
          <TryCatch.Catches>
            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="621,21" sap2010:WorkflowViewState.IdRef="Catch`1_54">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ActivityAction x:TypeArguments="s:Exception">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                </ActivityAction.Argument>
                <Throw DisplayName="Throw BRE" Exception="[New BusinessRuleException(&quot;Error occurred after starting to format data.&lt;br&gt;&lt;br&gt;Failure Reason: &quot; + exception.message)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_100" />
              </ActivityAction>
            </Catch>
          </TryCatch.Catches>
        </TryCatch>
        <TryCatch DisplayName="Try Catch - Multiple Jobs" sap:VirtualizedContainerService.HintSize="913.6,1824" sap2010:WorkflowViewState.IdRef="TryCatch_9">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <TryCatch.Try>
            <Flowchart DisplayName="Check Only One Job is Running" sap:VirtualizedContainerService.HintSize="914,636.8" sap2010:WorkflowViewState.IdRef="Flowchart_2">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <av:Point x:Key="ShapeLocation">320,2.5</av:Point>
                  <av:Size x:Key="ShapeSize">60,75.2</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">350,77.7 350,107.7 319,107.7 319,120</av:PointCollection>
                  <x:Double x:Key="Width">880</x:Double>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart.StartNode>
                <x:Reference>__ReferenceID22</x:Reference>
              </Flowchart.StartNode>
              <FlowStep x:Name="__ReferenceID22">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">219,120</av:Point>
                    <av:Size x:Key="ShapeSize">200,53.2</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">219,146.6 0,146.6 0,273.2 239,273.2 239,216.6 209,216.6</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign sap:VirtualizedContainerService.HintSize="200,53.2" sap2010:WorkflowViewState.IdRef="Assign_138">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:Int32">[intCount]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:Int32">0</InArgument>
                  </Assign.Value>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </Assign>
                <FlowStep.Next>
                  <FlowStep x:Name="__ReferenceID16">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">9,190</av:Point>
                        <av:Size x:Key="ShapeSize">200,53.2</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">109,243.2 109,273.2 140,273.2 140,274.5</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="200,53.2" sap2010:WorkflowViewState.IdRef="Assign_139">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">Check for Multiple Jobs</InArgument>
                      </Assign.Value>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </Assign>
                    <FlowStep.Next>
                      <FlowStep x:Name="__ReferenceID17">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">40,274.5</av:Point>
                            <av:Size x:Key="ShapeSize">200,53.2</av:Size>
                            <av:PointCollection x:Key="ConnectorLocation">240,301.1 270,301.1 270,256.5 325.5,256.5 325.5,286.5</av:PointCollection>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Check for Multiple Jobs" sap:VirtualizedContainerService.HintSize="200,53.2" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" UnSafe="False" WorkflowFileName="Check for Multiple Jobs.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <OutArgument x:TypeArguments="x:String" x:Key="StrFailureReason">[strFailureReason]</OutArgument>
                            <OutArgument x:TypeArguments="x:Boolean" x:Key="BComplete">[bComplete]</OutArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="StrComponentRunning">[strComponentRunning]</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="StrProcessName">[strProcessName]</InArgument>
                            <OutArgument x:TypeArguments="x:Boolean" x:Key="BRunning">[bRunning]</OutArgument>
                            <InArgument x:TypeArguments="x:Boolean" x:Key="BErrorHandling">False</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="StrOrchFolder">[strOrchFolder]</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:InvokeWorkflowFile>
                        <FlowStep.Next>
                          <FlowDecision x:Name="__ReferenceID18" Condition="[bComplete]" DisplayName="bComplete" sap:VirtualizedContainerService.HintSize="70,87.2" sap2010:WorkflowViewState.IdRef="FlowDecision_4">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <av:Point x:Key="ShapeLocation">290.5,286.5</av:Point>
                                <av:Size x:Key="ShapeSize">70,87.2</av:Size>
                                <av:PointCollection x:Key="FalseConnector">360.5,330.1 390.5,330.1 390.5,326.6 439,326.6</av:PointCollection>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <FlowDecision.False>
                              <FlowStep x:Name="__ReferenceID19">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">439,300</av:Point>
                                    <av:Size x:Key="ShapeSize">200,53.2</av:Size>
                                    <av:PointCollection x:Key="ConnectorLocation">539,300 539,270 570,270 570,263.7</av:PointCollection>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Assign sap:VirtualizedContainerService.HintSize="200,53.2" sap2010:WorkflowViewState.IdRef="Assign_140">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:Int32">[intCount]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:Int32">[intCount + 1]</InArgument>
                                  </Assign.Value>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </Assign>
                                <FlowStep.Next>
                                  <FlowDecision x:Name="__ReferenceID20" Condition="[intCount &lt; 4]" DisplayName="intCount &lt;4" sap:VirtualizedContainerService.HintSize="70,87.2" sap2010:WorkflowViewState.IdRef="FlowDecision_3" True="{x:Reference __ReferenceID16}">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <av:Point x:Key="ShapeLocation">535,176.5</av:Point>
                                        <av:Size x:Key="ShapeSize">70,87.2</av:Size>
                                        <av:PointCollection x:Key="TrueConnector">535,220.1 505,220.1 505,100 109,100 109,190</av:PointCollection>
                                        <av:PointCollection x:Key="FalseConnector">605,220.1 635,220.1 635,221.4 680,221.4</av:PointCollection>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <FlowDecision.False>
                                      <FlowStep x:Name="__ReferenceID21">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <av:Point x:Key="ShapeLocation">680,209</av:Point>
                                            <av:Size x:Key="ShapeSize">200,24.8</av:Size>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Throw Exception="[New System.Exception(strFailureReason)]" sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Throw_10">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </Throw>
                                      </FlowStep>
                                    </FlowDecision.False>
                                  </FlowDecision>
                                </FlowStep.Next>
                              </FlowStep>
                            </FlowDecision.False>
                          </FlowDecision>
                        </FlowStep.Next>
                      </FlowStep>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowStep.Next>
              </FlowStep>
              <x:Reference>__ReferenceID16</x:Reference>
              <x:Reference>__ReferenceID17</x:Reference>
              <x:Reference>__ReferenceID18</x:Reference>
              <x:Reference>__ReferenceID19</x:Reference>
              <x:Reference>__ReferenceID20</x:Reference>
              <x:Reference>__ReferenceID21</x:Reference>
            </Flowchart>
          </TryCatch.Try>
          <TryCatch.Catches>
            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="879.6,1657.6" sap2010:WorkflowViewState.IdRef="Catch`1_10">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ActivityAction x:TypeArguments="s:Exception">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                </ActivityAction.Argument>
                <If Condition="[not bRunning]" DisplayName="Error Handling" sap:VirtualizedContainerService.HintSize="873.6,1587.2" sap2010:WorkflowViewState.IdRef="If_87">
                  <If.Then>
                    <Rethrow sap:VirtualizedContainerService.HintSize="200,24.8" sap2010:WorkflowViewState.IdRef="Rethrow_4" />
                  </If.Then>
                  <If.Else>
                    <Sequence DisplayName="Multiple Jobs Error Handling" sap:VirtualizedContainerService.HintSize="629.2,1425.6" sap2010:WorkflowViewState.IdRef="Sequence_171">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:LogMessage DisplayName="Log Message - Ending Existing Job" sap:VirtualizedContainerService.HintSize="567.2,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_72" Level="Warn" Message="[&quot;Multiple jobs running. Terminating Current Job.&quot;]" />
                      <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each Folder" sap:VirtualizedContainerService.HintSize="567.2,645.6" sap2010:WorkflowViewState.IdRef="ForEach`1_63" Values="[IO.Directory.GetDirectories(strDesktopFolder)]">
                        <ui:ForEach.Body>
                          <ActivityAction x:TypeArguments="x:String">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="x:String" Name="subFolder" />
                            </ActivityAction.Argument>
                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="531.6,519.2" sap2010:WorkflowViewState.IdRef="ForEach`1_64" Values="[IO.Directory.GetFiles(subFolder,&quot;*.*&quot;,SearchOption.AllDirectories)]">
                              <ui:ForEach.Body>
                                <ActivityAction x:TypeArguments="x:String">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="x:String" Name="processedFile" />
                                  </ActivityAction.Argument>
                                  <Sequence DisplayName="Move Files back to &quot;New Files&quot; Folder" sap:VirtualizedContainerService.HintSize="496,392.8" sap2010:WorkflowViewState.IdRef="Sequence_205">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign DisplayName="Assign Processed File Name" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_165">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[strProcessedFileName]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">[processedFile.Split("\"c).Last]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strNewFolder + &quot;\&quot; + strProcessedFileName]" DisplayName="Move Files to New_Files Folder" sap:VirtualizedContainerService.HintSize="434,162" sap2010:WorkflowViewState.IdRef="MoveFile_11" Path="[processedFile]" />
                                  </Sequence>
                                </ActivityAction>
                              </ui:ForEach.Body>
                            </ui:ForEach>
                          </ActivityAction>
                        </ui:ForEach.Body>
                      </ui:ForEach>
                      <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Error Folder" sap:VirtualizedContainerService.HintSize="567.2,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_43" Path="[strErrorFolder]" />
                      <lf:Move_Folder StrComponentRunning="{x:Null}" sap2010:Annotation.AnnotationText="Moves strNewFolder to the Error Folder so that any changes made to the Master Data File &amp; Working File are not saved" DisplayName="Move Folder (Move_Folder)" sap:VirtualizedContainerService.HintSize="567.2,135.6" sap2010:WorkflowViewState.IdRef="Move_Folder_2" StrFinalFolder="Sdfgbnvm" StrStartFolder="jhgsdraefw" />
                      <ui:Delete ResourceFile="{x:Null}" ContinueOnError="True" DisplayName="Delete Desktop Folder" sap:VirtualizedContainerService.HintSize="567.2,135.6" sap2010:WorkflowViewState.IdRef="Delete_1" Path="[strDesktopFolder]" />
                      <TerminateWorkflow DisplayName="Terminate Workflow" Exception="[exception]" sap:VirtualizedContainerService.HintSize="567.2,24.8" sap2010:WorkflowViewState.IdRef="TerminateWorkflow_1" />
                    </Sequence>
                  </If.Else>
                </If>
              </ActivityAction>
            </Catch>
          </TryCatch.Catches>
        </TryCatch>
        <Sequence DisplayName="Upload Files to SPO" sap:VirtualizedContainerService.HintSize="1437.2,885.2" sap2010:WorkflowViewState.IdRef="Sequence_173">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="612.4,82.4" sap2010:WorkflowViewState.IdRef="Assign_199">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">["Upload Files to SPO"]</InArgument>
            </Assign.Value>
          </Assign>
          <ui:LogMessage DisplayName="Log Message - Component Started" sap:VirtualizedContainerService.HintSize="612.4,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_87" Level="Info" Message="[strComponentRunning + &quot; Started.&quot;]" />
          <If sap2010:Annotation.AnnotationText="Upload Folder to SPO split for testing due to complexity of manipulating strings" Condition="[BTest]" DisplayName="If Test" sap:VirtualizedContainerService.HintSize="612.4,382.8" sap2010:WorkflowViewState.IdRef="If_559">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <If.Then>
              <l1:Upload_Folder BDeleteFolder="{x:Null}" StrDocLibURLName="{x:Null}" StrNewFolderName="{x:Null}" StrSubFolder="{x:Null}" DisplayName="Upload Folder (Test) ()" sap:VirtualizedContainerService.HintSize="284,190" sap2010:WorkflowViewState.IdRef="Upload_Folder_1" StrDocLibraryName="[strPendingFolder]" StrLocalFolder="[strNewFolder]" StrOrchFolder="/" StrSPOSiteURL="[StrTestAddress]" />
            </If.Then>
            <If.Else>
              <l1:Upload_Folder BDeleteFolder="{x:Null}" StrDocLibURLName="{x:Null}" StrNewFolderName="{x:Null}" StrSubFolder="{x:Null}" DisplayName="Upload Folder (Live) ()" sap:VirtualizedContainerService.HintSize="284,190" sap2010:WorkflowViewState.IdRef="Upload_Folder_2" StrDocLibraryName="[strDocLib]" StrLocalFolder="[strSubFolder]" StrOrchFolder="/" StrSPOSiteURL="[StrTestAddress]" />
            </If.Else>
          </If>
          <ui:LogMessage DisplayName="Log Message - Component Complete" sap:VirtualizedContainerService.HintSize="612.4,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_88" Level="Info" Message="[strComponentRunning + &quot; Complete.&quot;]" />
        </Sequence>
        <Sequence DisplayName="Send Investigation Emails" sap:VirtualizedContainerService.HintSize="1437.2,4568" sap2010:WorkflowViewState.IdRef="Sequence_531">
          <Sequence.Variables>
            <Variable x:TypeArguments="x:String" Name="strEmailLink" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Assign DisplayName="Assign Email Link" sap:VirtualizedContainerService.HintSize="546.8,82.4" sap2010:WorkflowViewState.IdRef="Assign_458">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[strEmailLink]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[(strSPOSiteURL + "/" + strDocLib + "/" + strSubFolder + "/" + strSPOFolder + "/Manual Investigation Required").Replace(" ","%20")]</InArgument>
            </Assign.Value>
          </Assign>
          <ui:IfElseIf DisplayName="Else If BRUCP Investigation Required" sap:VirtualizedContainerService.HintSize="546.8,2147.2" sap2010:WorkflowViewState.IdRef="IfElseIf_16">
            <ui:IfElseIf.ConditionBlocks>
              <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                <ui:IfElseIfBlock BlockType="If" Condition="[colBRUCPErrors.Count &gt; 0 AndAlso colNewCustomers.Count &gt; 0]">
                  <ui:IfElseIfBlock.Then>
                    <Sequence DisplayName="Send Manual Investigation Email to BRUCP (Files &amp; Customers)" sap:VirtualizedContainerService.HintSize="496,568" sap2010:WorkflowViewState.IdRef="Sequence_244">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_200">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["Send Manual Investigation Email to BRUCP"]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:LogMessage DisplayName="Log Message - Component Started" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_89" Level="Info" Message="[strComponentRunning + &quot; Started.&quot;]" />
                      <lm:Send_SMTP_Mail_With_Embedded_Images BTest="{x:Null}" EnuAttachments="{x:Null}" StrCC="{x:Null}" StrRobotImg="{x:Null}" StrSubject="{x:Null}" StrTestAddress="{x:Null}" StrTo="{x:Null}" BDefaultSignature="True" DisplayName="Send SMTP Mail With Embedded Images (Send_SMTP_Mail_With_Embedded_Images)" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="Send_SMTP_Mail_With_Embedded_Images_1" StrBCC="ldpti@dg.mitsui.com" StrBody="askdbfg" StrFromEmail="Tech&amp;InnovationLDPTI@dg.mitsui.com" StrFromName="LDPTI Bot" StrOrchFolder="/" />
                      <ui:LogMessage DisplayName="Log Message - Component Complete" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_90" Level="Info" Message="[strComponentRunning + &quot; Complete.&quot;]" />
                    </Sequence>
                  </ui:IfElseIfBlock.Then>
                </ui:IfElseIfBlock>
                <ui:IfElseIfBlock BlockType="ElseIf" Condition="[colBRUCPErrors.Count &gt; 0]">
                  <ui:IfElseIfBlock.Then>
                    <Sequence DisplayName="Send Manual Investigation Email to BRUCP (Files)" sap:VirtualizedContainerService.HintSize="496,568" sap2010:WorkflowViewState.IdRef="Sequence_566">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_503">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["Send Manual Investigation Email to BRUCP"]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:LogMessage DisplayName="Log Message - Component Started" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_175" Level="Info" Message="[strComponentRunning + &quot; Started.&quot;]" />
                      <lm:Send_SMTP_Mail_With_Embedded_Images BTest="{x:Null}" EnuAttachments="{x:Null}" StrCC="{x:Null}" StrRobotImg="{x:Null}" StrSubject="{x:Null}" StrTestAddress="{x:Null}" StrTo="{x:Null}" BDefaultSignature="True" DisplayName="Send SMTP Mail With Embedded Images (Send_SMTP_Mail_With_Embedded_Images)" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="Send_SMTP_Mail_With_Embedded_Images_2" StrBCC="ldpti@dg.mitsui.com" StrBody="sadxcvb;knm" StrFromEmail="Tech&amp;InnovationLDPTI@dg.mitsui.com" StrFromName="LDPTI Bot" StrOrchFolder="/" />
                      <ui:LogMessage DisplayName="Log Message - Component Complete" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_176" Level="Info" Message="[strComponentRunning + &quot; Complete.&quot;]" />
                    </Sequence>
                  </ui:IfElseIfBlock.Then>
                </ui:IfElseIfBlock>
                <ui:IfElseIfBlock BlockType="ElseIf" Condition="[colNewCustomers.Count &gt; 0]">
                  <ui:IfElseIfBlock.Then>
                    <Sequence DisplayName="Send Manual Investigation Email to BRUCP (Customers)" sap:VirtualizedContainerService.HintSize="496,568" sap2010:WorkflowViewState.IdRef="Sequence_565">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign DisplayName="Assign Component" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_501">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["Send Manual Investigation Email to BRUCP"]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:LogMessage DisplayName="Log Message - Component Started" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_173" Level="Info" Message="[strComponentRunning + &quot; Started.&quot;]" />
                      <lm:Send_SMTP_Mail_With_Embedded_Images BTest="{x:Null}" EnuAttachments="{x:Null}" StrCC="{x:Null}" StrRobotImg="{x:Null}" StrSubject="{x:Null}" StrTestAddress="{x:Null}" StrTo="{x:Null}" BDefaultSignature="True" DisplayName="Send SMTP Mail With Embedded Images (Send_SMTP_Mail_With_Embedded_Images)" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="Send_SMTP_Mail_With_Embedded_Images_3" StrBCC="ldpti@dg.mitsui.com" StrBody="ASDfgh" StrFromEmail="Tech&amp;InnovationLDPTI@dg.mitsui.com" StrFromName="LDPTI Bot" StrOrchFolder="/" />
                      <ui:LogMessage DisplayName="Log Message - Component Complete" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_174" Level="Info" Message="[strComponentRunning + &quot; Complete.&quot;]" />
                    </Sequence>
                  </ui:IfElseIfBlock.Then>
                </ui:IfElseIfBlock>
              </sc:BindingList>
            </ui:IfElseIf.ConditionBlocks>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:IfElseIf>
          <ui:IfElseIf DisplayName="Else If LDPTI Investigation Required" sap:VirtualizedContainerService.HintSize="546.8,2147.2" sap2010:WorkflowViewState.IdRef="IfElseIf_17">
            <ui:IfElseIf.ConditionBlocks>
              <sc:BindingList x:TypeArguments="ui:IfElseIfBlock" AllowEdit="True" AllowNew="True" AllowRemove="True" RaiseListChangedEvents="True">
                <ui:IfElseIfBlock BlockType="If" Condition="[colQueueErrors.Count &gt; 0 AndAlso colColumnErrors.Count &gt; 0]">
                  <ui:IfElseIfBlock.Then>
                    <Sequence DisplayName="Send Column and Queue Error Email to LDPTI" sap:VirtualizedContainerService.HintSize="496,568" sap2010:WorkflowViewState.IdRef="Sequence_578">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_506">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["Send Manual Investigation Email to LDPTI"]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_180" Level="Info" Message="[strComponentRunning + &quot; Started.&quot;]" />
                      <lm:Send_SMTP_Mail_With_Embedded_Images BTest="{x:Null}" EnuAttachments="{x:Null}" StrCC="{x:Null}" StrRobotImg="{x:Null}" StrSubject="{x:Null}" StrTestAddress="{x:Null}" StrTo="{x:Null}" BDefaultSignature="True" DisplayName="Send SMTP Mail With Embedded Images (Send_SMTP_Mail_With_Embedded_Images)" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="Send_SMTP_Mail_With_Embedded_Images_4" StrBCC="ldpti@dg.mitsui.com" StrBody="ASdfgbnvm" StrFromEmail="Tech&amp;InnovationLDPTI@dg.mitsui.com" StrFromName="LDPTI Bot" StrOrchFolder="/" />
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_181" Level="Info" Message="[strComponentRunning + &quot; Complete.&quot;]" />
                    </Sequence>
                  </ui:IfElseIfBlock.Then>
                </ui:IfElseIfBlock>
                <ui:IfElseIfBlock BlockType="ElseIf" Condition="[colQueueErrors.Count &gt; 0]">
                  <ui:IfElseIfBlock.Then>
                    <Sequence DisplayName="Send Queue Error Email to LDPTI" sap:VirtualizedContainerService.HintSize="496,568" sap2010:WorkflowViewState.IdRef="Sequence_541">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_491">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["Send Manual Investigation Email to LDPTI"]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_167" Level="Info" Message="[strComponentRunning + &quot; Started.&quot;]" />
                      <lm:Send_SMTP_Mail_With_Embedded_Images BTest="{x:Null}" EnuAttachments="{x:Null}" StrCC="{x:Null}" StrRobotImg="{x:Null}" StrSubject="{x:Null}" StrTestAddress="{x:Null}" StrTo="{x:Null}" BDefaultSignature="True" DisplayName="Send SMTP Mail With Embedded Images (Send_SMTP_Mail_With_Embedded_Images)" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="Send_SMTP_Mail_With_Embedded_Images_5" StrBCC="ldpti@dg.mitsui.com" StrBody="Asdfgxhcvj" StrFromEmail="Tech&amp;InnovationLDPTI@dg.mitsui.com" StrFromName="LDPTI Bot" StrOrchFolder="/" />
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_168" Level="Info" Message="[strComponentRunning + &quot; Complete.&quot;]" />
                    </Sequence>
                  </ui:IfElseIfBlock.Then>
                </ui:IfElseIfBlock>
                <ui:IfElseIfBlock BlockType="ElseIf" Condition="[colColumnErrors.Count &gt; 0]">
                  <ui:IfElseIfBlock.Then>
                    <Sequence DisplayName="Send Column Error Email to LDPTI" sap:VirtualizedContainerService.HintSize="496,568" sap2010:WorkflowViewState.IdRef="Sequence_579">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_507">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strComponentRunning]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["Send Manual Investigation Email to LDPTI"]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_182" Level="Info" Message="[strComponentRunning + &quot; Started.&quot;]" />
                      <lm:Send_SMTP_Mail_With_Embedded_Images BTest="{x:Null}" EnuAttachments="{x:Null}" StrCC="{x:Null}" StrRobotImg="{x:Null}" StrSubject="{x:Null}" StrTestAddress="{x:Null}" StrTo="{x:Null}" BDefaultSignature="True" DisplayName="Send SMTP Mail With Embedded Images (Send_SMTP_Mail_With_Embedded_Images)" sap:VirtualizedContainerService.HintSize="434,81.2" sap2010:WorkflowViewState.IdRef="Send_SMTP_Mail_With_Embedded_Images_6" StrBCC="ldpti@dg.mitsui.com" StrBody="SAdfghj" StrFromEmail="Tech&amp;InnovationLDPTI@dg.mitsui.com" StrFromName="LDPTI Bot" StrOrchFolder="/" />
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="434,88" sap2010:WorkflowViewState.IdRef="LogMessage_183" Level="Info" Message="[strComponentRunning + &quot; Complete.&quot;]" />
                    </Sequence>
                  </ui:IfElseIfBlock.Then>
                </ui:IfElseIfBlock>
              </sc:BindingList>
            </ui:IfElseIf.ConditionBlocks>
          </ui:IfElseIf>
        </Sequence>
        <l:Kill_Processes DisplayName="Kill Processes" sap:VirtualizedContainerService.HintSize="1437.2,53.2" sap2010:WorkflowViewState.IdRef="Kill_Processes_8" ProcessesToKill="[processesToKill]">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </l:Kill_Processes>
      </Sequence>
    </TryCatch.Try>
    <TryCatch.Catches>
      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1502.8,22.8" sap2010:WorkflowViewState.IdRef="Catch`1_1">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ActivityAction x:TypeArguments="s:Exception">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Error Handling" sap:VirtualizedContainerService.HintSize="629.2,1928.4" sap2010:WorkflowViewState.IdRef="Sequence_5">
            <Sequence.Variables>
              <Variable x:TypeArguments="ui:Image" Name="imgError" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Assign DisplayName="Assign - Failure Reason" sap:VirtualizedContainerService.HintSize="567.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_31">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strFailureReason]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[exception.Message]</InArgument>
              </Assign.Value>
            </Assign>
            <ui:LogMessage DisplayName="Log Message - Failure Reason" sap:VirtualizedContainerService.HintSize="567.2,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_6" Level="Error" Message="[strFailureReason]">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:LogMessage>
            <TryCatch DisplayName="Try Catch - Error Screenshot" sap:VirtualizedContainerService.HintSize="567.2,53.2" sap2010:WorkflowViewState.IdRef="TryCatch_2">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <TryCatch.Try>
                <Sequence DisplayName="Save Error Screenshot" sap:VirtualizedContainerService.HintSize="526,734" sap2010:WorkflowViewState.IdRef="Sequence_24">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="x:String" Name="strScreenshotFolder" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="Exceptions_Screenshots_Folder" CacheStrategy="None" DisplayName="Get Asset - Screenshot folder" FolderPath="Shared/Zeon" sap:VirtualizedContainerService.HintSize="484,52" sap2010:WorkflowViewState.IdRef="GetRobotAsset_3">
                    <ui:GetRobotAsset.Value>
                      <OutArgument x:TypeArguments="x:String">[strScreenshotFolder]</OutArgument>
                    </ui:GetRobotAsset.Value>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:GetRobotAsset>
                  <If Condition="[BTest]" DisplayName="If Test" sap:VirtualizedContainerService.HintSize="484,250" sap2010:WorkflowViewState.IdRef="If_23">
                    <If.Then>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_48">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strScreenshotFolder]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strScreenshotFolder + "\Test"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Then>
                  </If>
                  <ui:TakeScreenshot WaitBefore="{x:Null}" ContinueOnError="False" DisplayName="Take screenshot" sap:VirtualizedContainerService.HintSize="484,86" sap2010:WorkflowViewState.IdRef="TakeScreenshot_1" Screenshot="[imgError]">
                    <ui:TakeScreenshot.Target>
                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="3a0772aa-9511-431d-96bf-22b9005f0e05" WaitForReady="NONE">
                        <ui:Target.TimeoutMS>
                          <InArgument x:TypeArguments="x:Int32" />
                        </ui:Target.TimeoutMS>
                      </ui:Target>
                    </ui:TakeScreenshot.Target>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:TakeScreenshot>
                  <ui:SaveImage ContinueOnError="False" DisplayName="Save image" FileName="[strScreenshotFolder + &quot;\&quot;+strProcessName+&quot;_&quot;+Now.ToString(&quot;ddMMyy_HHmmss&quot;)+&quot;.png&quot;]" sap:VirtualizedContainerService.HintSize="484,134" sap2010:WorkflowViewState.IdRef="SaveImage_1" Image="[imgError]" />
                </Sequence>
              </TryCatch.Try>
              <TryCatch.Catches>
                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="530,22" sap2010:WorkflowViewState.IdRef="Catch`1_3">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ActivityAction x:TypeArguments="s:Exception">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                    </ActivityAction.Argument>
                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,93" sap2010:WorkflowViewState.IdRef="LogMessage_34" Level="Error" Message="[&quot;Unable to save error screenshot. Message: &quot; + exception.Message]" />
                  </ActivityAction>
                </Catch>
              </TryCatch.Catches>
            </TryCatch>
            <lm:Send_SMTP_Mail_With_Embedded_Images BTest="{x:Null}" EnuAttachments="{x:Null}" StrCC="{x:Null}" StrRobotImg="{x:Null}" StrSubject="{x:Null}" StrTestAddress="{x:Null}" StrTo="{x:Null}" BDefaultSignature="True" DisplayName="Send SMTP Mail With Embedded Images (Send_SMTP_Mail_With_Embedded_Images)" sap:VirtualizedContainerService.HintSize="567.2,81.2" sap2010:WorkflowViewState.IdRef="Send_SMTP_Mail_With_Embedded_Images_7" StrBCC="ldpti@dg.mitsui.com" StrBody="sadfgh" StrFromEmail="Tech&amp;InnovationLDPTI@dg.mitsui.com" StrFromName="LDPTI Bot" StrOrchFolder="/" />
            <l:Kill_Processes DisplayName="Kill Processes" sap:VirtualizedContainerService.HintSize="567.2,81.2" sap2010:WorkflowViewState.IdRef="Kill_Processes_3" ProcessesToKill="[processesToKill]" />
            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Move files back to 'New_Files' folder so that data can be extracted on next run and entered into the Master Data File" DisplayName="For Each Folder" sap:VirtualizedContainerService.HintSize="567.2,690.4" sap2010:WorkflowViewState.IdRef="ForEach`1_67" Values="[IO.Directory.GetDirectories(strDesktopFolder)]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="x:String">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:String" Name="subFolder" />
                  </ActivityAction.Argument>
                  <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each File" sap:VirtualizedContainerService.HintSize="531.6,519.2" sap2010:WorkflowViewState.IdRef="ForEach`1_66" Values="[IO.Directory.GetFiles(subFolder,&quot;*.*&quot;,SearchOption.AllDirectories)]">
                    <ui:ForEach.Body>
                      <ActivityAction x:TypeArguments="x:String">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="x:String" Name="processedFile" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Move Files back to &quot;New Files&quot; Folder" sap:VirtualizedContainerService.HintSize="496,392.8" sap2010:WorkflowViewState.IdRef="Sequence_209">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign DisplayName="Assign Processed File Name" sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_166">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strProcessedFileName]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[processedFile.Split("\"c).Last.ToString]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strNewFolder + &quot;\&quot; + strProcessedFileName.Replace(&quot;_&quot;,&quot; &quot;)]" DisplayName="Move Files to New_Files Folder" sap:VirtualizedContainerService.HintSize="434,162" sap2010:WorkflowViewState.IdRef="MoveFile_12" Overwrite="True" Path="[processedFile]" />
                        </Sequence>
                      </ActivityAction>
                    </ui:ForEach.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ForEach>
                </ActivityAction>
              </ui:ForEach.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:ForEach>
            <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Error Folder" sap:VirtualizedContainerService.HintSize="567.2,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_41" Path="[strErrorFolder]" />
            <lf:Move_Folder StrComponentRunning="{x:Null}" sap2010:Annotation.AnnotationText="Moves strNewFolder to the Error Folder so that any changes made to the Master Data File &amp; Working File are not saved" DisplayName="Move Folder (Move_Folder)" sap:VirtualizedContainerService.HintSize="567.2,135.6" sap2010:WorkflowViewState.IdRef="Move_Folder_3" StrFinalFolder="ASdfgb" StrStartFolder="asdfgh">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </lf:Move_Folder>
            <ui:Delete ResourceFile="{x:Null}" ContinueOnError="True" DisplayName="Delete Desktop Folder" sap:VirtualizedContainerService.HintSize="567.2,135.6" sap2010:WorkflowViewState.IdRef="Delete_25" Path="[strDesktopFolder]" />
            <Rethrow sap:VirtualizedContainerService.HintSize="567.2,24.8" sap2010:WorkflowViewState.IdRef="Rethrow_1" />
          </Sequence>
        </ActivityAction>
      </Catch>
      <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="1502.8,22.8" sap2010:WorkflowViewState.IdRef="Catch`1_2">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ActivityAction x:TypeArguments="ui:BusinessRuleException">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Business Error Handling" sap:VirtualizedContainerService.HintSize="629.2,1782" sap2010:WorkflowViewState.IdRef="Sequence_20">
            <Sequence.Variables>
              <Variable x:TypeArguments="x:String" Name="strBREFolder" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Assign DisplayName="Assign - Failure Reason" sap:VirtualizedContainerService.HintSize="567.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_39">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strFailureReason]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[exception.Message]</InArgument>
              </Assign.Value>
            </Assign>
            <ui:LogMessage DisplayName="Log Message - Failure Reason" sap:VirtualizedContainerService.HintSize="567.2,94.4" sap2010:WorkflowViewState.IdRef="LogMessage_25" Level="Error" Message="[strFailureReason]">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:LogMessage>
            <lm:Send_SMTP_Mail_With_Embedded_Images BTest="{x:Null}" EnuAttachments="{x:Null}" StrCC="{x:Null}" StrRobotImg="{x:Null}" StrSubject="{x:Null}" StrTestAddress="{x:Null}" StrTo="{x:Null}" BDefaultSignature="True" DisplayName="Send SMTP Mail With Embedded Images (Send_SMTP_Mail_With_Embedded_Images)" sap:VirtualizedContainerService.HintSize="567.2,81.2" sap2010:WorkflowViewState.IdRef="Send_SMTP_Mail_With_Embedded_Images_8" StrBCC="ldpti@dg.mitsui.com" StrBody="sDFZgxcv" StrFromEmail="Tech&amp;InnovationLDPTI@dg.mitsui.com" StrFromName="LDPTI Bot" StrOrchFolder="/" />
            <l:Kill_Processes DisplayName="Kill Processes" sap:VirtualizedContainerService.HintSize="567.2,81.2" sap2010:WorkflowViewState.IdRef="Kill_Processes_4" ProcessesToKill="[processesToKill]" />
            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Move files back to 'New_Files' folder so that data can be extracted on next run and entered into the Master Data File" DisplayName="For Each Folder" sap:VirtualizedContainerService.HintSize="567.2,690.4" sap2010:WorkflowViewState.IdRef="ForEach`1_73" Values="[IO.Directory.GetDirectories(strDesktopFolder)]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="x:String">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:String" Name="subFolder" />
                  </ActivityAction.Argument>
                  <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each File" sap:VirtualizedContainerService.HintSize="531.6,519.2" sap2010:WorkflowViewState.IdRef="ForEach`1_72" Values="[IO.Directory.GetFiles(subFolder,&quot;*.*&quot;,SearchOption.AllDirectories)]">
                    <ui:ForEach.Body>
                      <ActivityAction x:TypeArguments="x:String">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="x:String" Name="processedFile" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Move Files back to &quot;New Files&quot; Folder" sap:VirtualizedContainerService.HintSize="496,392.8" sap2010:WorkflowViewState.IdRef="Sequence_225">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign sap:VirtualizedContainerService.HintSize="434,82.4" sap2010:WorkflowViewState.IdRef="Assign_176">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strProcessedFileName]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[processedFile.Split("\"c).Last.ToString]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[strNewFolder + &quot;\&quot; + strProcessedFileName]" DisplayName="Move Files to New_Files Folder" sap:VirtualizedContainerService.HintSize="434,162" sap2010:WorkflowViewState.IdRef="MoveFile_15" Path="[processedFile]" />
                        </Sequence>
                      </ActivityAction>
                    </ui:ForEach.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ForEach>
                </ActivityAction>
              </ui:ForEach.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:ForEach>
            <Assign DisplayName="Assign BRE Folder" sap:VirtualizedContainerService.HintSize="567.2,82.4" sap2010:WorkflowViewState.IdRef="Assign_457">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strBREFolder]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[strErrorFolder.Replace(strProcessName.Replace(" ","_"), "BRE\" + strProcessName.Replace(" ","_"))]</InArgument>
              </Assign.Value>
            </Assign>
            <ui:CreateDirectory Output="{x:Null}" ContinueOnError="True" DisplayName="Create Desktop Folder" sap:VirtualizedContainerService.HintSize="567.2,81.2" sap2010:WorkflowViewState.IdRef="CreateDirectory_42" Path="[strBREFolder]" />
            <lf:Move_Folder StrComponentRunning="{x:Null}" DisplayName="Move Folder (Move_Folder)" sap:VirtualizedContainerService.HintSize="567.2,135.6" sap2010:WorkflowViewState.IdRef="Move_Folder_4" StrFinalFolder="asdfgh" StrStartFolder="ertyhjg" />
            <Rethrow sap:VirtualizedContainerService.HintSize="567.2,24.8" sap2010:WorkflowViewState.IdRef="Rethrow_2" />
          </Sequence>
        </ActivityAction>
      </Catch>
    </TryCatch.Catches>
  </TryCatch>
</Activity>